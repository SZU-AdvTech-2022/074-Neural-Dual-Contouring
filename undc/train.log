[2022-11-10 16:29:02,325][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-10 16:29:02,332][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-10 16:29:02,333][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-10 16:29:02,396][__main__][INFO] - Instantiating datamodule <src.datamodules.mnist_datamodule.MNISTDataModule>
[2022-11-10 16:29:02,402][__main__][INFO] - Instantiating model <src.models.mnist_module.MNISTLitModule>
[2022-11-10 16:29:02,415][__main__][INFO] - Instantiating callbacks...
[2022-11-10 16:29:02,416][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-10 16:29:02,420][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-10 16:29:02,422][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-10 16:29:02,423][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-10 16:29:02,423][__main__][INFO] - Instantiating loggers...
[2022-11-10 16:29:02,424][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-10 16:29:02,424][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-10 16:29:42,906][__main__][INFO] - Starting training!
[2022-11-10 16:30:38,708][__main__][INFO] - Starting testing!
[2022-11-10 16:30:56,203][__main__][INFO] - Best ckpt path: /home/fubao/dev/my-ndc/logs/train/runs/2022-11-10_16-29-02/checkpoints/epoch_007.ckpt
[2022-11-10 16:30:56,209][src.utils.utils][INFO] - Closing loggers...
[2022-11-10 16:30:56,210][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-11-10_16-29-02
[2022-11-10 16:30:56,211][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-11-10 17:17:56,027][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-10 17:17:56,033][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-10 17:17:56,034][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-10 17:17:56,097][__main__][INFO] - Instantiating datamodule <src.datamodules.mnist_datamodule.MNISTDataModule>
[2022-11-10 17:17:56,100][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
TypeError: __init__() got an unexpected keyword argument 'grid_size'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 69, in train
    datamodule: LightningDataModule = hydra.utils.instantiate(cfg.datamodule)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 339, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.datamodules.mnist_datamodule.MNISTDataModule':
TypeError("__init__() got an unexpected keyword argument 'grid_size'")
full_key: datamodule
[2022-11-10 17:17:56,102][src.utils.utils][INFO] - Closing loggers...
[2022-11-10 17:18:44,369][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-10 17:18:44,376][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-10 17:18:44,376][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-10 17:18:44,442][__main__][INFO] - Instantiating datamodule <src.datamodules.ndc_datamodule.NDCDataModule>
[2022-11-10 17:18:44,475][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/utils.py", line 639, in _locate
    obj = getattr(obj, part)
AttributeError: module 'src.datamodules' has no attribute 'ndc_datamodule'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/utils.py", line 645, in _locate
    obj = import_module(mod)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1014, in _gcd_import
  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 975, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 671, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/home/fubao/dev/my-ndc/src/datamodules/ndc_datamodule.py", line 9, in <module>
    from src.datamodules.components.ndc_dataset import ABC_grid_hdf5
  File "/home/fubao/dev/my-ndc/src/datamodules/components/ndc_dataset.py", line 8, in <module>
    from utils import read_data,read_and_augment_data_ndc,read_and_augment_data_undc,read_data_input_only, read_sdf_file_as_3d_array,read_binvox_file_as_3d_array
ImportError: cannot import name 'read_data' from 'utils' (/home/fubao/dev/my-ndc/src/utils/__init__.py)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/utils.py", line 653, in _locate
    raise ImportError(
ImportError: Error loading 'src.datamodules.ndc_datamodule.NDCDataModule':
ImportError("cannot import name 'read_data' from 'utils' (/home/fubao/dev/my-ndc/src/utils/__init__.py)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 69, in train
    datamodule: LightningDataModule = hydra.utils.instantiate(cfg.datamodule)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 325, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'src.datamodules.ndc_datamodule.NDCDataModule', see chained exception above.
full_key: datamodule
[2022-11-10 17:18:44,477][src.utils.utils][INFO] - Closing loggers...
[2022-11-10 17:20:19,480][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-10 17:20:19,490][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-10 17:20:19,490][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-10 17:20:19,568][__main__][INFO] - Instantiating datamodule <src.datamodules.ndc_datamodule.NDCDataModule>
[2022-11-10 17:20:19,608][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/utils.py", line 639, in _locate
    obj = getattr(obj, part)
AttributeError: module 'src.datamodules' has no attribute 'ndc_datamodule'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/utils.py", line 645, in _locate
    obj = import_module(mod)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1014, in _gcd_import
  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 975, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 671, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/home/fubao/dev/my-ndc/src/datamodules/ndc_datamodule.py", line 9, in <module>
    from src.datamodules.components.ndc_dataset import ABC_grid_hdf5
  File "/home/fubao/dev/my-ndc/src/datamodules/components/ndc_dataset.py", line 8, in <module>
    from utils import read_data,read_and_augment_data_ndc,read_and_augment_data_undc,read_data_input_only, read_sdf_file_as_3d_array,read_binvox_file_as_3d_array
ImportError: cannot import name 'read_data' from 'utils' (/home/fubao/dev/my-ndc/src/utils/__init__.py)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/utils.py", line 653, in _locate
    raise ImportError(
ImportError: Error loading 'src.datamodules.ndc_datamodule.NDCDataModule':
ImportError("cannot import name 'read_data' from 'utils' (/home/fubao/dev/my-ndc/src/utils/__init__.py)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 69, in train
    datamodule: LightningDataModule = hydra.utils.instantiate(cfg.datamodule)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 325, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'src.datamodules.ndc_datamodule.NDCDataModule', see chained exception above.
full_key: datamodule
[2022-11-10 17:20:19,610][src.utils.utils][INFO] - Closing loggers...
[2022-11-10 17:22:02,074][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-10 17:22:02,081][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-10 17:22:02,081][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-10 17:22:02,144][__main__][INFO] - Instantiating datamodule <src.datamodules.ndc_datamodule.NDCDataModule>
[2022-11-10 17:22:02,184][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
TypeError: __init__() got an unexpected keyword argument 'grid_size'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 69, in train
    datamodule: LightningDataModule = hydra.utils.instantiate(cfg.datamodule)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 339, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.datamodules.ndc_datamodule.NDCDataModule':
TypeError("__init__() got an unexpected keyword argument 'grid_size'")
full_key: datamodule
[2022-11-10 17:22:02,186][src.utils.utils][INFO] - Closing loggers...
[2022-11-10 17:32:08,025][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-10 17:32:08,032][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-10 17:32:08,032][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-10 17:32:08,099][__main__][INFO] - Instantiating datamodule <src.datamodules.ndc_datamodule.NDCDataModule>
[2022-11-10 17:32:08,135][__main__][INFO] - Instantiating model <src.models.ndc_module.NDCLitModule>
[2022-11-10 17:32:08,147][__main__][INFO] - Instantiating callbacks...
[2022-11-10 17:32:08,147][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-10 17:32:08,151][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-10 17:32:08,152][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-10 17:32:08,153][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-10 17:32:08,154][__main__][INFO] - Instantiating loggers...
[2022-11-10 17:32:08,154][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-10 17:32:08,154][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-10 17:32:32,734][__main__][INFO] - Starting training!
[2022-11-10 17:32:32,742][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 98, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1107, in _run
    self._call_setup_hook()  # allow user to setup lightning_module in accelerator environment
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1449, in _call_setup_hook
    self._call_lightning_datamodule_hook("setup", stage=fn)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1571, in _call_lightning_datamodule_hook
    return fn(*args, **kwargs)
  File "/home/fubao/dev/my-ndc/src/datamodules/ndc_datamodule.py", line 48, in setup
    self.data_train = ABC_grid_hdf5(self.hparams.data_dir, self.hparams.grid_size, self.hparams.receptive_padding, self.hparams.input_type, train=True, out_bool=self.hparams.net_bool, out_float=self.hparams.net_float, is_undc=False)
  File "/home/fubao/dev/my-ndc/src/datamodules/components/ndc_dataset.py", line 30, in __init__
    fin = open("abc_obj_list.txt", 'r')
FileNotFoundError: [Errno 2] No such file or directory: 'abc_obj_list.txt'
[2022-11-10 17:32:32,745][src.utils.utils][INFO] - Closing loggers...
[2022-11-10 17:48:21,143][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-10 17:48:21,150][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-10 17:48:21,151][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-10 17:48:21,214][__main__][INFO] - Instantiating datamodule <src.datamodules.ndc_datamodule.NDCDataModule>
[2022-11-10 17:48:21,247][__main__][INFO] - Instantiating model <src.models.ndc_module.NDCLitModule>
[2022-11-10 17:48:21,258][__main__][INFO] - Instantiating callbacks...
[2022-11-10 17:48:21,258][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-10 17:48:21,262][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-10 17:48:21,263][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-10 17:48:21,264][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-10 17:48:21,265][__main__][INFO] - Instantiating loggers...
[2022-11-10 17:48:21,265][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-10 17:48:21,265][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-10 17:48:45,340][__main__][INFO] - Starting training!
[2022-11-10 17:48:45,403][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 98, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_train
    self._run_sanity_check()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1345, in _run_sanity_check
    val_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 155, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 127, in advance
    batch = next(data_fetcher)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 185, in __next__
    return self.fetching_function()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 264, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 278, in _fetch_next_batch
    batch = next(iterator)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 681, in __next__
    data = self._next_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 721, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/fubao/dev/my-ndc/src/datamodules/components/ndc_dataset.py", line 90, in __getitem__
    gt_output_bool_,gt_output_float_,gt_input_ = read_data(hdf5_dir,grid_size,self.input_type,self.out_bool,self.out_float,self.is_undc)
  File "/home/fubao/dev/my-ndc/src/utils/ndc_utils.py", line 78, in read_data
    hdf5_file = h5py.File(hdf5_dir, 'r')
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/h5py/_hl/files.py", line 533, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, fcpl, swmr=swmr)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/h5py/_hl/files.py", line 226, in make_fid
    fid = h5f.open(name, flags, fapl=fapl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 106, in h5py.h5f.open
FileNotFoundError: [Errno 2] Unable to open file (unable to open file: name = '/home/fubao/dev/my-ndc/data//00007904.hdf5', errno = 2, error message = 'No such file or directory', flags = 0, o_flags = 0)
[2022-11-10 17:48:45,408][src.utils.utils][INFO] - Closing loggers...
[2022-11-10 17:49:50,652][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-10 17:49:50,659][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-10 17:49:50,659][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-10 17:49:50,723][__main__][INFO] - Instantiating datamodule <src.datamodules.ndc_datamodule.NDCDataModule>
[2022-11-10 17:49:50,752][__main__][INFO] - Instantiating model <src.models.ndc_module.NDCLitModule>
[2022-11-10 17:49:50,762][__main__][INFO] - Instantiating callbacks...
[2022-11-10 17:49:50,763][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-10 17:49:50,766][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-10 17:49:50,768][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-10 17:49:50,769][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-10 17:49:50,769][__main__][INFO] - Instantiating loggers...
[2022-11-10 17:49:50,770][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-10 17:49:50,770][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-10 17:50:15,164][__main__][INFO] - Starting training!
[2022-11-10 18:23:45,714][__main__][INFO] - Starting testing!
[2022-11-10 18:23:45,715][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2022-11-10 18:23:46,992][__main__][INFO] - Best ckpt path: None
[2022-11-10 18:23:46,997][src.utils.utils][INFO] - Closing loggers...
[2022-11-10 18:23:46,999][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-11-10_17-49-50
[2022-11-10 18:23:46,999][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-11-10 18:24:00,930][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-10 18:24:00,937][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-10 18:24:00,937][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-10 18:24:01,000][__main__][INFO] - Instantiating datamodule <src.datamodules.ndc_datamodule.NDCDataModule>
[2022-11-10 18:24:01,037][__main__][INFO] - Instantiating model <src.models.ndc_module.NDCLitModule>
[2022-11-10 18:24:01,050][__main__][INFO] - Instantiating callbacks...
[2022-11-10 18:24:01,051][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-10 18:24:01,055][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-10 18:24:01,056][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-10 18:24:01,057][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-10 18:24:01,058][__main__][INFO] - Instantiating loggers...
[2022-11-10 18:24:01,058][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-10 18:24:01,058][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-10 18:24:41,662][__main__][INFO] - Starting training!
[2022-11-10 18:26:55,664][__main__][INFO] - Starting testing!
[2022-11-10 18:26:55,665][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2022-11-10 18:26:56,786][__main__][INFO] - Best ckpt path: None
[2022-11-10 18:26:56,792][src.utils.utils][INFO] - Closing loggers...
[2022-11-10 18:26:56,794][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-11-10_18-24-00
[2022-11-10 18:26:56,795][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-11-10 20:16:58,026][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-10 20:16:58,034][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-10 20:16:58,035][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-10 20:16:58,108][__main__][INFO] - Instantiating datamodule <src.datamodules.ndc_datamodule.NDCDataModule>
[2022-11-10 20:16:58,152][__main__][INFO] - Instantiating model <src.models.ndc_module.NDCLitModule>
[2022-11-10 20:16:58,168][__main__][INFO] - Instantiating callbacks...
[2022-11-10 20:16:58,169][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-10 20:16:58,174][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-10 20:16:58,176][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-10 20:16:58,177][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-10 20:16:58,177][__main__][INFO] - Instantiating loggers...
[2022-11-10 20:16:58,178][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-10 20:16:58,178][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-10 20:16:59,228][__main__][INFO] - Starting training!
[2022-11-10 20:17:08,772][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 98, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 648, in _call_and_handle_interrupt
    return self.strategy.launcher.launch(trainer_fn, *args, trainer=self, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 103, in launch
    mp.start_processes(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 198, in start_processes
    while not context.join():
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 160, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 1 terminated with the following error:
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 69, in _wrap
    fn(i, *args)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 129, in _wrapping_function
    results = function(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_train
    self._run_sanity_check()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1345, in _run_sanity_check
    val_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 155, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 143, in advance
    output = self._evaluation_step(**kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 240, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1706, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/ddp_spawn.py", line 291, in validation_step
    return self.model(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1008, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 969, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/overrides/base.py", line 90, in forward
    return self.module.validation_step(*inputs, **kwargs)
  File "/home/fubao/dev/my-ndc/src/models/ndc_module.py", line 83, in validation_step
    loss, acc, pred_output_bool = self.step(batch)
  File "/home/fubao/dev/my-ndc/src/models/ndc_module.py", line 55, in step
    gt_input, gt_output_bool, gt_output_bool_mask = batch
ValueError: too many values to unpack (expected 3)

[2022-11-10 20:17:08,779][src.utils.utils][INFO] - Closing loggers...
[2022-11-10 20:22:59,997][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-10 20:23:00,005][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-10 20:23:00,005][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-10 20:23:00,076][__main__][INFO] - Instantiating datamodule <src.datamodules.ndc_datamodule.NDCDataModule>
[2022-11-10 20:23:00,113][__main__][INFO] - Instantiating model <src.models.ndc_module.NDCLitModule>
[2022-11-10 20:23:00,126][__main__][INFO] - Instantiating callbacks...
[2022-11-10 20:23:00,127][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-10 20:23:00,131][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-10 20:23:00,133][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-10 20:23:00,134][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-10 20:23:00,134][__main__][INFO] - Instantiating loggers...
[2022-11-10 20:23:00,135][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-10 20:23:00,135][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-10 20:23:01,218][__main__][INFO] - Starting training!
[2022-11-10 20:23:14,490][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 98, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 648, in _call_and_handle_interrupt
    return self.strategy.launcher.launch(trainer_fn, *args, trainer=self, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 103, in launch
    mp.start_processes(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 198, in start_processes
    while not context.join():
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 160, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 1 terminated with the following error:
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 69, in _wrap
    fn(i, *args)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 129, in _wrapping_function
    results = function(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_train
    self._run_sanity_check()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1345, in _run_sanity_check
    val_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 155, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 143, in advance
    output = self._evaluation_step(**kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 240, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1706, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/ddp_spawn.py", line 291, in validation_step
    return self.model(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1008, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 969, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/overrides/base.py", line 90, in forward
    return self.module.validation_step(*inputs, **kwargs)
  File "/home/fubao/dev/my-ndc/src/models/ndc_module.py", line 102, in validation_step
    write_obj_triangle(f"{self.hparams.out_dir}/val_{self.epoch_count}_{batch_idx}.obj", vertices, triangles)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1207, in __getattr__
    raise AttributeError("'{}' object has no attribute '{}'".format(
AttributeError: 'NDCLitModule' object has no attribute 'epoch_count'

[2022-11-10 20:23:14,497][src.utils.utils][INFO] - Closing loggers...
[2022-11-10 20:23:43,880][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-10 20:23:43,888][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-10 20:23:43,888][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-10 20:23:43,963][__main__][INFO] - Instantiating datamodule <src.datamodules.ndc_datamodule.NDCDataModule>
[2022-11-10 20:23:43,999][__main__][INFO] - Instantiating model <src.models.ndc_module.NDCLitModule>
[2022-11-10 20:23:44,014][__main__][INFO] - Instantiating callbacks...
[2022-11-10 20:23:44,014][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-10 20:23:44,019][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-10 20:23:44,021][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-10 20:23:44,022][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-10 20:23:44,022][__main__][INFO] - Instantiating loggers...
[2022-11-10 20:23:44,023][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-10 20:23:44,023][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-10 20:23:45,093][__main__][INFO] - Starting training!
[2022-11-10 20:24:00,956][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 98, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 648, in _call_and_handle_interrupt
    return self.strategy.launcher.launch(trainer_fn, *args, trainer=self, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 103, in launch
    mp.start_processes(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 198, in start_processes
    while not context.join():
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 160, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 2 terminated with the following error:
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 69, in _wrap
    fn(i, *args)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 129, in _wrapping_function
    results = function(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1285, in _run_train
    self.fit_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/fit_loop.py", line 270, in advance
    self._outputs = self.epoch_loop.run(self._data_fetcher)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 174, in advance
    batch = next(data_fetcher)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 185, in __next__
    return self.fetching_function()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 264, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 278, in _fetch_next_batch
    batch = next(iterator)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/supporters.py", line 558, in __next__
    return self.request_next_batch(self.loader_iters)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/supporters.py", line 570, in request_next_batch
    return apply_to_collection(loader_iters, Iterator, next)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/apply_func.py", line 100, in apply_to_collection
    return function(data, *args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 681, in __next__
    data = self._next_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 721, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    return self.collate_fn(data)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/collate.py", line 175, in default_collate
    return [default_collate(samples) for samples in transposed]  # Backwards compatibility.
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/collate.py", line 175, in <listcomp>
    return [default_collate(samples) for samples in transposed]  # Backwards compatibility.
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/collate.py", line 183, in default_collate
    raise TypeError(default_collate_err_msg_format.format(elem_type))
TypeError: default_collate: batch must contain tensors, numpy arrays, numbers, dicts or lists; found <class 'NoneType'>

[2022-11-10 20:24:00,963][src.utils.utils][INFO] - Closing loggers...
[2022-11-10 20:24:22,181][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-10 20:24:22,188][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-10 20:24:22,189][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-10 20:24:22,258][__main__][INFO] - Instantiating datamodule <src.datamodules.ndc_datamodule.NDCDataModule>
[2022-11-10 20:24:22,289][__main__][INFO] - Instantiating model <src.models.ndc_module.NDCLitModule>
[2022-11-10 20:24:22,301][__main__][INFO] - Instantiating callbacks...
[2022-11-10 20:24:22,301][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-10 20:24:22,306][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-10 20:24:22,307][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-10 20:24:22,308][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-10 20:24:22,308][__main__][INFO] - Instantiating loggers...
[2022-11-10 20:24:22,309][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-10 20:24:22,309][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-10 20:24:22,957][__main__][INFO] - Starting training!
[2022-11-10 20:24:28,085][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 98, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1285, in _run_train
    self.fit_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/fit_loop.py", line 270, in advance
    self._outputs = self.epoch_loop.run(self._data_fetcher)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 174, in advance
    batch = next(data_fetcher)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 185, in __next__
    return self.fetching_function()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 264, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 278, in _fetch_next_batch
    batch = next(iterator)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/supporters.py", line 558, in __next__
    return self.request_next_batch(self.loader_iters)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/supporters.py", line 570, in request_next_batch
    return apply_to_collection(loader_iters, Iterator, next)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/apply_func.py", line 100, in apply_to_collection
    return function(data, *args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 681, in __next__
    data = self._next_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 721, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    return self.collate_fn(data)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/collate.py", line 175, in default_collate
    return [default_collate(samples) for samples in transposed]  # Backwards compatibility.
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/collate.py", line 175, in <listcomp>
    return [default_collate(samples) for samples in transposed]  # Backwards compatibility.
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/collate.py", line 183, in default_collate
    raise TypeError(default_collate_err_msg_format.format(elem_type))
TypeError: default_collate: batch must contain tensors, numpy arrays, numbers, dicts or lists; found <class 'NoneType'>
[2022-11-10 20:24:28,089][src.utils.utils][INFO] - Closing loggers...
[2022-11-10 20:27:40,361][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-10 20:27:40,392][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-10 20:27:40,393][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-10 20:27:40,682][__main__][INFO] - Instantiating datamodule <src.datamodules.ndc_datamodule.NDCDataModule>
[2022-11-10 20:27:40,738][__main__][INFO] - Instantiating model <src.models.ndc_module.NDCLitModule>
[2022-11-10 20:27:40,767][__main__][INFO] - Instantiating callbacks...
[2022-11-10 20:27:40,768][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-10 20:27:40,782][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-10 20:27:40,788][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-10 20:27:40,790][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-10 20:27:40,792][__main__][INFO] - Instantiating loggers...
[2022-11-10 20:27:40,793][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-10 20:27:40,794][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-10 20:27:43,223][__main__][INFO] - Starting training!
[2022-11-10 20:32:30,294][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/fubao/dev/my-ndc/src/train.py", line 98, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1285, in _run_train
    self.fit_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/fit_loop.py", line 270, in advance
    self._outputs = self.epoch_loop.run(self._data_fetcher)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 174, in advance
    batch = next(data_fetcher)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 185, in __next__
    return self.fetching_function()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 264, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 278, in _fetch_next_batch
    batch = next(iterator)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/supporters.py", line 558, in __next__
    return self.request_next_batch(self.loader_iters)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/supporters.py", line 570, in request_next_batch
    return apply_to_collection(loader_iters, Iterator, next)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/apply_func.py", line 100, in apply_to_collection
    return function(data, *args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 681, in __next__
    data = self._next_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 721, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    return self.collate_fn(data)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/collate.py", line 175, in default_collate
    return [default_collate(samples) for samples in transposed]  # Backwards compatibility.
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/collate.py", line 175, in <listcomp>
    return [default_collate(samples) for samples in transposed]  # Backwards compatibility.
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/collate.py", line 183, in default_collate
    raise TypeError(default_collate_err_msg_format.format(elem_type))
TypeError: default_collate: batch must contain tensors, numpy arrays, numbers, dicts or lists; found <class 'NoneType'>
[2022-11-10 20:32:30,310][src.utils.utils][INFO] - Closing loggers...
[2022-11-10 20:34:16,873][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-10 20:34:16,902][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-10 20:34:16,903][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-10 20:34:17,189][__main__][INFO] - Instantiating datamodule <src.datamodules.ndc_datamodule.NDCDataModule>
[2022-11-10 20:34:17,243][__main__][INFO] - Instantiating model <src.models.ndc_module.NDCLitModule>
[2022-11-10 20:34:17,272][__main__][INFO] - Instantiating callbacks...
[2022-11-10 20:34:17,273][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-10 20:34:17,286][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-10 20:34:17,292][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-10 20:34:17,294][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-10 20:34:17,296][__main__][INFO] - Instantiating loggers...
[2022-11-10 20:34:17,296][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-10 20:34:17,297][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-10 20:34:19,835][__main__][INFO] - Starting training!
[2022-11-10 20:35:30,336][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-10 20:35:30,365][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-10 20:35:30,366][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-10 20:35:30,657][__main__][INFO] - Instantiating datamodule <src.datamodules.ndc_datamodule.NDCDataModule>
[2022-11-10 20:35:30,711][__main__][INFO] - Instantiating model <src.models.ndc_module.NDCLitModule>
[2022-11-10 20:35:30,740][__main__][INFO] - Instantiating callbacks...
[2022-11-10 20:35:30,741][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-10 20:35:30,754][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-10 20:35:30,760][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-10 20:35:30,762][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-10 20:35:30,764][__main__][INFO] - Instantiating loggers...
[2022-11-10 20:35:30,764][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-10 20:35:30,765][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-10 20:35:33,232][__main__][INFO] - Starting training!
[2022-11-10 20:37:42,142][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/fubao/dev/my-ndc/src/train.py", line 98, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1285, in _run_train
    self.fit_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/fit_loop.py", line 270, in advance
    self._outputs = self.epoch_loop.run(self._data_fetcher)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 174, in advance
    batch = next(data_fetcher)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 185, in __next__
    return self.fetching_function()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 264, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 278, in _fetch_next_batch
    batch = next(iterator)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/supporters.py", line 558, in __next__
    return self.request_next_batch(self.loader_iters)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/supporters.py", line 570, in request_next_batch
    return apply_to_collection(loader_iters, Iterator, next)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/apply_func.py", line 100, in apply_to_collection
    return function(data, *args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 681, in __next__
    data = self._next_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 721, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    return self.collate_fn(data)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/collate.py", line 175, in default_collate
    return [default_collate(samples) for samples in transposed]  # Backwards compatibility.
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/collate.py", line 175, in <listcomp>
    return [default_collate(samples) for samples in transposed]  # Backwards compatibility.
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/collate.py", line 183, in default_collate
    raise TypeError(default_collate_err_msg_format.format(elem_type))
TypeError: default_collate: batch must contain tensors, numpy arrays, numbers, dicts or lists; found <class 'NoneType'>
[2022-11-10 20:37:42,154][src.utils.utils][INFO] - Closing loggers...
[2022-11-10 20:40:03,680][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-10 20:40:03,688][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-10 20:40:03,688][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-10 20:40:03,768][__main__][INFO] - Instantiating datamodule <src.datamodules.ndc_datamodule.NDCDataModule>
[2022-11-10 20:40:03,814][__main__][INFO] - Instantiating model <src.models.ndc_module.NDCLitModule>
[2022-11-10 20:40:03,830][__main__][INFO] - Instantiating callbacks...
[2022-11-10 20:40:03,830][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-10 20:40:03,836][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-10 20:40:03,837][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-10 20:40:03,838][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-10 20:40:03,839][__main__][INFO] - Instantiating loggers...
[2022-11-10 20:40:03,840][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-10 20:40:03,840][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-10 20:40:04,915][__main__][INFO] - Starting training!
[2022-11-10 20:40:20,554][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 98, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 648, in _call_and_handle_interrupt
    return self.strategy.launcher.launch(trainer_fn, *args, trainer=self, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 103, in launch
    mp.start_processes(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 198, in start_processes
    while not context.join():
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 160, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 6 terminated with the following error:
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 69, in _wrap
    fn(i, *args)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 129, in _wrapping_function
    results = function(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1285, in _run_train
    self.fit_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/fit_loop.py", line 270, in advance
    self._outputs = self.epoch_loop.run(self._data_fetcher)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 174, in advance
    batch = next(data_fetcher)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 185, in __next__
    return self.fetching_function()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 264, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 278, in _fetch_next_batch
    batch = next(iterator)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/supporters.py", line 558, in __next__
    return self.request_next_batch(self.loader_iters)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/supporters.py", line 570, in request_next_batch
    return apply_to_collection(loader_iters, Iterator, next)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/apply_func.py", line 100, in apply_to_collection
    return function(data, *args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 681, in __next__
    data = self._next_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 721, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/fubao/dev/my-ndc/src/datamodules/components/ndc_dataset.py", line 244, in __getitem__
    return gt_input, gt_output_bool, gt_output_bool_mask, gt_output_float, gt_output_float_mask
UnboundLocalError: local variable 'gt_output_float' referenced before assignment

[2022-11-10 20:40:20,561][src.utils.utils][INFO] - Closing loggers...
[2022-11-10 20:42:20,635][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-10 20:42:20,643][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-10 20:42:20,643][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-10 20:42:20,715][__main__][INFO] - Instantiating datamodule <src.datamodules.ndc_datamodule.NDCDataModule>
[2022-11-10 20:42:20,746][__main__][INFO] - Instantiating model <src.models.ndc_module.NDCLitModule>
[2022-11-10 20:42:20,758][__main__][INFO] - Instantiating callbacks...
[2022-11-10 20:42:20,758][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-10 20:42:20,763][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-10 20:42:20,764][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-10 20:42:20,765][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-10 20:42:20,766][__main__][INFO] - Instantiating loggers...
[2022-11-10 20:42:20,766][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-10 20:42:20,766][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-10 20:42:21,842][__main__][INFO] - Starting training!
[2022-11-10 20:42:31,650][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 98, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 648, in _call_and_handle_interrupt
    return self.strategy.launcher.launch(trainer_fn, *args, trainer=self, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 103, in launch
    mp.start_processes(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 198, in start_processes
    while not context.join():
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 149, in join
    raise ProcessExitedException(
torch.multiprocessing.spawn.ProcessExitedException: process 6 terminated with exit code 255
[2022-11-10 20:42:31,654][src.utils.utils][INFO] - Closing loggers...
[2022-11-10 20:42:59,484][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-10 20:42:59,491][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-10 20:42:59,492][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-10 20:42:59,578][__main__][INFO] - Instantiating datamodule <src.datamodules.ndc_datamodule.NDCDataModule>
[2022-11-10 20:42:59,622][__main__][INFO] - Instantiating model <src.models.ndc_module.NDCLitModule>
[2022-11-10 20:42:59,637][__main__][INFO] - Instantiating callbacks...
[2022-11-10 20:42:59,638][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-10 20:42:59,643][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-10 20:42:59,645][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-10 20:42:59,646][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-10 20:42:59,647][__main__][INFO] - Instantiating loggers...
[2022-11-10 20:42:59,647][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-10 20:42:59,648][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-10 20:43:00,718][__main__][INFO] - Starting training!
[2022-11-10 20:43:09,654][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 98, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 648, in _call_and_handle_interrupt
    return self.strategy.launcher.launch(trainer_fn, *args, trainer=self, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 103, in launch
    mp.start_processes(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 198, in start_processes
    while not context.join():
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 149, in join
    raise ProcessExitedException(
torch.multiprocessing.spawn.ProcessExitedException: process 5 terminated with exit code 255
[2022-11-10 20:43:09,659][src.utils.utils][INFO] - Closing loggers...
[2022-11-10 20:44:46,000][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-10 20:44:46,007][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-10 20:44:46,008][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-10 20:44:46,092][__main__][INFO] - Instantiating datamodule <src.datamodules.ndc_datamodule.NDCDataModule>
[2022-11-10 20:44:46,141][__main__][INFO] - Instantiating model <src.models.ndc_module.NDCLitModule>
[2022-11-10 20:44:46,158][__main__][INFO] - Instantiating callbacks...
[2022-11-10 20:44:46,158][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-10 20:44:46,164][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-10 20:44:46,166][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-10 20:44:46,167][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-10 20:44:46,168][__main__][INFO] - Instantiating loggers...
[2022-11-10 20:44:46,169][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-10 20:44:46,169][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-10 20:45:26,837][__main__][INFO] - Starting training!
[2022-11-10 20:45:42,975][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 98, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 648, in _call_and_handle_interrupt
    return self.strategy.launcher.launch(trainer_fn, *args, trainer=self, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 103, in launch
    mp.start_processes(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 198, in start_processes
    while not context.join():
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 149, in join
    raise ProcessExitedException(
torch.multiprocessing.spawn.ProcessExitedException: process 7 terminated with exit code 255
[2022-11-10 20:45:42,982][src.utils.utils][INFO] - Closing loggers...
[2022-11-10 20:46:53,664][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-10 20:46:53,670][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-10 20:46:53,670][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-10 20:46:53,733][__main__][INFO] - Instantiating datamodule <src.datamodules.ndc_datamodule.NDCDataModule>
[2022-11-10 20:46:53,763][__main__][INFO] - Instantiating model <src.models.ndc_module.NDCLitModule>
[2022-11-10 20:46:53,775][__main__][INFO] - Instantiating callbacks...
[2022-11-10 20:46:53,775][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-10 20:46:53,779][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-10 20:46:53,781][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-10 20:46:53,782][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-10 20:46:53,782][__main__][INFO] - Instantiating loggers...
[2022-11-10 20:46:53,783][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-10 20:46:53,783][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-10 20:47:35,129][__main__][INFO] - Starting training!
[2022-11-10 20:47:56,744][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 98, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 648, in _call_and_handle_interrupt
    return self.strategy.launcher.launch(trainer_fn, *args, trainer=self, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 103, in launch
    mp.start_processes(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 198, in start_processes
    while not context.join():
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 160, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 5 terminated with the following error:
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 69, in _wrap
    fn(i, *args)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 129, in _wrapping_function
    results = function(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1285, in _run_train
    self.fit_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/fit_loop.py", line 270, in advance
    self._outputs = self.epoch_loop.run(self._data_fetcher)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 174, in advance
    batch = next(data_fetcher)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 185, in __next__
    return self.fetching_function()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 264, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 278, in _fetch_next_batch
    batch = next(iterator)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/supporters.py", line 558, in __next__
    return self.request_next_batch(self.loader_iters)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/supporters.py", line 570, in request_next_batch
    return apply_to_collection(loader_iters, Iterator, next)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/apply_func.py", line 100, in apply_to_collection
    return function(data, *args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 681, in __next__
    data = self._next_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 721, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/fubao/dev/my-ndc/src/datamodules/components/ndc_dataset.py", line 244, in __getitem__
    return gt_input, gt_output_bool, gt_output_bool_mask, gt_output_float, gt_output_float_mask
UnboundLocalError: local variable 'gt_output_float' referenced before assignment

[2022-11-10 20:47:56,751][src.utils.utils][INFO] - Closing loggers...
[2022-11-10 20:56:14,097][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-10 20:56:14,104][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-10 20:56:14,105][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-10 20:56:14,171][__main__][INFO] - Instantiating datamodule <src.datamodules.ndc_datamodule.NDCDataModule>
[2022-11-10 20:56:14,204][__main__][INFO] - Instantiating model <src.models.ndc_module.NDCLitModule>
[2022-11-10 20:56:14,216][__main__][INFO] - Instantiating callbacks...
[2022-11-10 20:56:14,217][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-10 20:56:14,221][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-10 20:56:14,222][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-10 20:56:14,223][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-10 20:56:14,223][__main__][INFO] - Instantiating loggers...
[2022-11-10 20:56:14,224][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-10 20:56:14,224][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-10 20:56:54,719][__main__][INFO] - Starting training!
[2022-11-10 20:57:15,824][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 98, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 648, in _call_and_handle_interrupt
    return self.strategy.launcher.launch(trainer_fn, *args, trainer=self, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 103, in launch
    mp.start_processes(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 198, in start_processes
    while not context.join():
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 160, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 2 terminated with the following error:
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 69, in _wrap
    fn(i, *args)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 129, in _wrapping_function
    results = function(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1285, in _run_train
    self.fit_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/fit_loop.py", line 270, in advance
    self._outputs = self.epoch_loop.run(self._data_fetcher)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 174, in advance
    batch = next(data_fetcher)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 185, in __next__
    return self.fetching_function()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 264, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 278, in _fetch_next_batch
    batch = next(iterator)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/supporters.py", line 558, in __next__
    return self.request_next_batch(self.loader_iters)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/supporters.py", line 570, in request_next_batch
    return apply_to_collection(loader_iters, Iterator, next)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/apply_func.py", line 100, in apply_to_collection
    return function(data, *args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 681, in __next__
    data = self._next_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 721, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    return self.collate_fn(data)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/collate.py", line 175, in default_collate
    return [default_collate(samples) for samples in transposed]  # Backwards compatibility.
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/collate.py", line 175, in <listcomp>
    return [default_collate(samples) for samples in transposed]  # Backwards compatibility.
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/collate.py", line 183, in default_collate
    raise TypeError(default_collate_err_msg_format.format(elem_type))
TypeError: default_collate: batch must contain tensors, numpy arrays, numbers, dicts or lists; found <class 'NoneType'>

[2022-11-10 20:57:15,831][src.utils.utils][INFO] - Closing loggers...
[2022-11-10 20:59:21,756][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-10 20:59:21,763][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-10 20:59:21,763][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-10 20:59:21,826][__main__][INFO] - Instantiating datamodule <src.datamodules.ndc_datamodule.NDCDataModule>
[2022-11-10 20:59:21,858][__main__][INFO] - Instantiating model <src.models.ndc_module.NDCLitModule>
[2022-11-10 20:59:21,869][__main__][INFO] - Instantiating callbacks...
[2022-11-10 20:59:21,869][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-10 20:59:21,873][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-10 20:59:21,875][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-10 20:59:21,875][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-10 20:59:21,876][__main__][INFO] - Instantiating loggers...
[2022-11-10 20:59:21,877][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-10 20:59:21,877][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-10 21:00:02,871][__main__][INFO] - Starting training!
[2022-11-10 21:07:35,507][__main__][INFO] - Starting testing!
[2022-11-10 21:07:35,508][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2022-11-10 21:08:06,778][__main__][INFO] - Best ckpt path: None
[2022-11-10 21:08:06,781][src.utils.utils][INFO] - Closing loggers...
[2022-11-10 21:08:06,782][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-11-10_20-59-21
[2022-11-10 21:08:06,783][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-11-10 21:13:59,388][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-10 21:13:59,394][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-10 21:13:59,395][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-10 21:13:59,457][__main__][INFO] - Instantiating datamodule <src.datamodules.ndc_datamodule.NDCDataModule>
[2022-11-10 21:13:59,486][__main__][INFO] - Instantiating model <src.models.ndc_module.NDCLitModule>
[2022-11-10 21:13:59,498][__main__][INFO] - Instantiating callbacks...
[2022-11-10 21:13:59,498][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-10 21:13:59,503][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-10 21:13:59,504][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-10 21:13:59,505][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-10 21:13:59,506][__main__][INFO] - Instantiating loggers...
[2022-11-10 21:13:59,506][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-10 21:13:59,506][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-10 21:14:40,367][__main__][INFO] - Starting training!
[2022-11-10 21:15:20,038][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 98, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 648, in _call_and_handle_interrupt
    return self.strategy.launcher.launch(trainer_fn, *args, trainer=self, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 103, in launch
    mp.start_processes(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 198, in start_processes
    while not context.join():
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 160, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 2 terminated with the following error:
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 69, in _wrap
    fn(i, *args)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 129, in _wrapping_function
    results = function(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1285, in _run_train
    self.fit_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/fit_loop.py", line 270, in advance
    self._outputs = self.epoch_loop.run(self._data_fetcher)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 174, in advance
    batch = next(data_fetcher)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 185, in __next__
    return self.fetching_function()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 264, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 278, in _fetch_next_batch
    batch = next(iterator)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/supporters.py", line 558, in __next__
    return self.request_next_batch(self.loader_iters)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/supporters.py", line 570, in request_next_batch
    return apply_to_collection(loader_iters, Iterator, next)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/apply_func.py", line 100, in apply_to_collection
    return function(data, *args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 681, in __next__
    data = self._next_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 721, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    return self.collate_fn(data)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/collate.py", line 175, in default_collate
    return [default_collate(samples) for samples in transposed]  # Backwards compatibility.
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/collate.py", line 175, in <listcomp>
    return [default_collate(samples) for samples in transposed]  # Backwards compatibility.
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/collate.py", line 149, in default_collate
    return default_collate([torch.as_tensor(b) for b in batch])
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/collate.py", line 141, in default_collate
    return torch.stack(batch, 0, out=out)
RuntimeError: stack expects each tensor to be equal size, but got [1, 21, 53, 51] at entry 0 and [1, 37, 23, 11] at entry 1

[2022-11-10 21:15:20,043][src.utils.utils][INFO] - Closing loggers...
[2022-11-10 21:17:02,234][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-10 21:17:02,241][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-10 21:17:02,241][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-10 21:17:02,305][__main__][INFO] - Instantiating datamodule <src.datamodules.ndc_datamodule.NDCDataModule>
[2022-11-10 21:17:02,336][__main__][INFO] - Instantiating model <src.models.ndc_module.NDCLitModule>
[2022-11-10 21:17:02,348][__main__][INFO] - Instantiating callbacks...
[2022-11-10 21:17:02,348][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-10 21:17:02,353][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-10 21:17:02,354][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-10 21:17:02,355][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-10 21:17:02,356][__main__][INFO] - Instantiating loggers...
[2022-11-10 21:17:02,356][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-10 21:17:02,356][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-10 21:17:42,961][__main__][INFO] - Starting training!
[2022-11-10 21:18:34,269][__main__][INFO] - Starting testing!
[2022-11-10 21:18:34,269][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2022-11-10 21:18:34,938][__main__][INFO] - Best ckpt path: None
[2022-11-10 21:18:34,941][src.utils.utils][INFO] - Closing loggers...
[2022-11-10 21:18:34,943][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-11-10_21-17-02
[2022-11-10 21:18:34,943][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-11-10 22:18:58,523][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-10 22:18:58,530][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-10 22:18:58,530][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-10 22:18:58,596][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_datamodule.UNDCDataModule>
[2022-11-10 22:18:59,188][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-11-10 22:18:59,195][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/utils.py", line 639, in _locate
    obj = getattr(obj, part)
AttributeError: module 'src.models.components' has no attribute 'ndc_pc_net'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/utils.py", line 645, in _locate
    obj = import_module(mod)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1014, in _gcd_import
  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 973, in _find_and_load_unlocked
ModuleNotFoundError: No module named 'src.models.components.ndc_pc_net'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/utils.py", line 648, in _locate
    raise ImportError(
ImportError: Error loading 'src.models.components.ndc_pc_net.local_pointnet':
ModuleNotFoundError("No module named 'src.models.components.ndc_pc_net'")
Are you sure that 'ndc_pc_net' is importable from module 'src.models.components'?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 72, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 334, in instantiate_node
    value = instantiate_node(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 325, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'src.models.components.ndc_pc_net.local_pointnet', see chained exception above.
full_key: model.net
[2022-11-10 22:18:59,197][src.utils.utils][INFO] - Closing loggers...
[2022-11-10 22:19:53,588][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-10 22:19:53,595][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-10 22:19:53,595][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-10 22:19:53,659][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_datamodule.UNDCDataModule>
[2022-11-10 22:19:54,262][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-11-10 22:19:54,305][__main__][INFO] - Instantiating callbacks...
[2022-11-10 22:19:54,306][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-10 22:19:54,312][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-10 22:19:54,314][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-10 22:19:54,316][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-10 22:19:54,317][__main__][INFO] - Instantiating loggers...
[2022-11-10 22:19:54,317][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-10 22:19:54,318][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-10 22:20:35,315][__main__][INFO] - Starting training!
[2022-11-10 22:20:51,724][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 98, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 648, in _call_and_handle_interrupt
    return self.strategy.launcher.launch(trainer_fn, *args, trainer=self, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 103, in launch
    mp.start_processes(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 198, in start_processes
    while not context.join():
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 160, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 0 terminated with the following error:
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/parsing.py", line 285, in __getattr__
    return self[key]
KeyError: 'point_num'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 69, in _wrap
    fn(i, *args)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 129, in _wrapping_function
    results = function(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1107, in _run
    self._call_setup_hook()  # allow user to setup lightning_module in accelerator environment
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1449, in _call_setup_hook
    self._call_lightning_datamodule_hook("setup", stage=fn)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1571, in _call_lightning_datamodule_hook
    return fn(*args, **kwargs)
  File "/home/fubao/dev/my-ndc/src/datamodules/undc_datamodule.py", line 50, in setup
    self.data_train = ABC_pointcloud_hdf5(self.hparams.data_dir, self.hparams.point_num, self.hparams.grid_size, self.hparams.knn_num,
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/parsing.py", line 287, in __getattr__
    raise AttributeError(f'Missing attribute "{key}"') from exp
AttributeError: Missing attribute "point_num"

[2022-11-10 22:20:51,728][src.utils.utils][INFO] - Closing loggers...
[2022-11-10 22:22:09,329][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-10 22:22:09,336][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-10 22:22:09,336][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-10 22:22:09,402][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_datamodule.UNDCDataModule>
[2022-11-10 22:22:10,064][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
TypeError: __init__() got an unexpected keyword argument 'point_num'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 69, in train
    datamodule: LightningDataModule = hydra.utils.instantiate(cfg.datamodule)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 339, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.datamodules.undc_datamodule.UNDCDataModule':
TypeError("__init__() got an unexpected keyword argument 'point_num'")
full_key: datamodule
[2022-11-10 22:22:10,066][src.utils.utils][INFO] - Closing loggers...
[2022-11-10 22:22:28,787][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-10 22:22:28,794][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-10 22:22:28,794][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-10 22:22:28,863][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_datamodule.UNDCDataModule>
[2022-11-10 22:22:29,414][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-11-10 22:22:29,440][__main__][INFO] - Instantiating callbacks...
[2022-11-10 22:22:29,441][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-10 22:22:29,444][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-10 22:22:29,445][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-10 22:22:29,446][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-10 22:22:29,446][__main__][INFO] - Instantiating loggers...
[2022-11-10 22:22:29,447][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-10 22:22:29,447][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-10 22:23:09,418][__main__][INFO] - Starting training!
[2022-11-10 22:23:26,217][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 98, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 648, in _call_and_handle_interrupt
    return self.strategy.launcher.launch(trainer_fn, *args, trainer=self, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 103, in launch
    mp.start_processes(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 198, in start_processes
    while not context.join():
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 160, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 5 terminated with the following error:
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 69, in _wrap
    fn(i, *args)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 129, in _wrapping_function
    results = function(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1107, in _run
    self._call_setup_hook()  # allow user to setup lightning_module in accelerator environment
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1449, in _call_setup_hook
    self._call_lightning_datamodule_hook("setup", stage=fn)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1571, in _call_lightning_datamodule_hook
    return fn(*args, **kwargs)
  File "/home/fubao/dev/my-ndc/src/datamodules/undc_datamodule.py", line 50, in setup
    self.data_train = ABC_pointcloud_hdf5(self.hparams.data_dir, self.hparams.num_points, self.hparams.grid_size, self.hparams.knn_num,
  File "/home/fubao/dev/my-ndc/src/datamodules/components/ndc_pc_dataset.py", line 27, in __init__
    fin = open("abc_obj_list.txt", 'r')
FileNotFoundError: [Errno 2] No such file or directory: 'abc_obj_list.txt'

[2022-11-10 22:23:26,221][src.utils.utils][INFO] - Closing loggers...
[2022-11-10 22:24:33,117][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-10 22:24:33,124][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-10 22:24:33,124][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-10 22:24:33,189][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_datamodule.UNDCDataModule>
[2022-11-10 22:24:33,771][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-11-10 22:24:33,803][__main__][INFO] - Instantiating callbacks...
[2022-11-10 22:24:33,803][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-10 22:24:33,807][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-10 22:24:33,809][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-10 22:24:33,810][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-10 22:24:33,811][__main__][INFO] - Instantiating loggers...
[2022-11-10 22:24:33,811][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-10 22:24:33,811][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-10 22:25:15,358][__main__][INFO] - Starting training!
[2022-11-10 22:25:32,559][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 98, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 648, in _call_and_handle_interrupt
    return self.strategy.launcher.launch(trainer_fn, *args, trainer=self, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 103, in launch
    mp.start_processes(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 198, in start_processes
    while not context.join():
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 160, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 7 terminated with the following error:
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 69, in _wrap
    fn(i, *args)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 129, in _wrapping_function
    results = function(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_train
    self._run_sanity_check()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1345, in _run_sanity_check
    val_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 155, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 127, in advance
    batch = next(data_fetcher)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 185, in __next__
    return self.fetching_function()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 264, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 278, in _fetch_next_batch
    batch = next(iterator)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 681, in __next__
    data = self._next_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 721, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/fubao/dev/my-ndc/src/datamodules/components/ndc_pc_dataset.py", line 98, in __getitem__
    gt_output_bool_,gt_output_float_,gt_input_ = read_data(hdf5_dir,grid_size,self.input_type,self.out_bool,self.out_float,is_undc=True)
  File "/home/fubao/dev/my-ndc/src/utils/ndc_utils.py", line 93, in read_data
    LOD_input = hdf5_file["pointcloud"][:].astype(np.float32)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/h5py/_hl/group.py", line 328, in __getitem__
    oid = h5o.open(self.id, self._e(name), lapl=self._lapl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5o.pyx", line 190, in h5py.h5o.open
KeyError: "Unable to open object (object 'pointcloud' doesn't exist)"

[2022-11-10 22:25:32,567][src.utils.utils][INFO] - Closing loggers...
[2022-11-10 22:26:42,776][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-10 22:26:42,783][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-10 22:26:42,784][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-10 22:26:42,850][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_datamodule.UNDCDataModule>
[2022-11-10 22:26:43,455][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-11-10 22:26:43,487][__main__][INFO] - Instantiating callbacks...
[2022-11-10 22:26:43,487][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-10 22:26:43,491][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-10 22:26:43,493][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-10 22:26:43,494][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-10 22:26:43,495][__main__][INFO] - Instantiating loggers...
[2022-11-10 22:26:43,495][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-10 22:26:43,495][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-10 22:27:24,226][__main__][INFO] - Starting training!
[2022-11-10 22:27:40,820][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 98, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 648, in _call_and_handle_interrupt
    return self.strategy.launcher.launch(trainer_fn, *args, trainer=self, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 103, in launch
    mp.start_processes(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 198, in start_processes
    while not context.join():
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 160, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 0 terminated with the following error:
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 69, in _wrap
    fn(i, *args)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 129, in _wrapping_function
    results = function(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_train
    self._run_sanity_check()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1345, in _run_sanity_check
    val_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 155, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 143, in advance
    output = self._evaluation_step(**kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 240, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1706, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/ddp_spawn.py", line 291, in validation_step
    return self.model(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1008, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 969, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/overrides/base.py", line 90, in forward
    return self.module.validation_step(*inputs, **kwargs)
  File "/home/fubao/dev/my-ndc/src/models/undc_module.py", line 90, in validation_step
    loss, acc, pred_output_bool = self.step(batch)
  File "/home/fubao/dev/my-ndc/src/models/undc_module.py", line 55, in step
    pc_KNN_idx_,pc_KNN_xyz_, voxel_xyz_int_,voxel_KNN_idx_,voxel_KNN_xyz_, gt_output_bool_ = batch
ValueError: too many values to unpack (expected 6)

[2022-11-10 22:27:40,827][src.utils.utils][INFO] - Closing loggers...
[2022-11-10 22:28:16,022][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-10 22:28:16,029][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-10 22:28:16,030][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-10 22:28:16,095][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_datamodule.UNDCDataModule>
[2022-11-10 22:28:16,656][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-11-10 22:28:16,684][__main__][INFO] - Instantiating callbacks...
[2022-11-10 22:28:16,684][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-10 22:28:16,688][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-10 22:28:16,690][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-10 22:28:16,690][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-10 22:28:16,691][__main__][INFO] - Instantiating loggers...
[2022-11-10 22:28:16,691][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-10 22:28:16,692][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-10 22:28:57,460][__main__][INFO] - Starting training!
[2022-11-10 22:29:14,767][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 98, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 648, in _call_and_handle_interrupt
    return self.strategy.launcher.launch(trainer_fn, *args, trainer=self, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 103, in launch
    mp.start_processes(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 198, in start_processes
    while not context.join():
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 160, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 0 terminated with the following error:
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 69, in _wrap
    fn(i, *args)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 129, in _wrapping_function
    results = function(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_train
    self._run_sanity_check()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1345, in _run_sanity_check
    val_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 155, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 143, in advance
    output = self._evaluation_step(**kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 240, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1706, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/ddp_spawn.py", line 291, in validation_step
    return self.model(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1008, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 969, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/overrides/base.py", line 90, in forward
    return self.module.validation_step(*inputs, **kwargs)
  File "/home/fubao/dev/my-ndc/src/models/undc_module.py", line 90, in validation_step
    loss, acc, pred_output_bool = self.step(batch)
  File "/home/fubao/dev/my-ndc/src/models/undc_module.py", line 62, in step
    gt_output_bool = gt_output_bool_[0]
NameError: name 'gt_output_bool_' is not defined

[2022-11-10 22:29:14,774][src.utils.utils][INFO] - Closing loggers...
[2022-11-10 22:29:55,200][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-10 22:29:55,207][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-10 22:29:55,207][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-10 22:29:55,270][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_datamodule.UNDCDataModule>
[2022-11-10 22:29:55,818][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-11-10 22:29:55,845][__main__][INFO] - Instantiating callbacks...
[2022-11-10 22:29:55,846][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-10 22:29:55,849][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-10 22:29:55,850][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-10 22:29:55,851][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-10 22:29:55,852][__main__][INFO] - Instantiating loggers...
[2022-11-10 22:29:55,852][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-10 22:29:55,853][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-10 22:30:37,259][__main__][INFO] - Starting training!
[2022-11-10 22:30:54,411][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 98, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 648, in _call_and_handle_interrupt
    return self.strategy.launcher.launch(trainer_fn, *args, trainer=self, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 103, in launch
    mp.start_processes(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 198, in start_processes
    while not context.join():
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 160, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 5 terminated with the following error:
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 69, in _wrap
    fn(i, *args)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 129, in _wrapping_function
    results = function(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_train
    self._run_sanity_check()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1345, in _run_sanity_check
    val_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 155, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 143, in advance
    output = self._evaluation_step(**kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 240, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1706, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/ddp_spawn.py", line 291, in validation_step
    return self.model(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1008, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 969, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/overrides/base.py", line 90, in forward
    return self.module.validation_step(*inputs, **kwargs)
  File "/home/fubao/dev/my-ndc/src/models/undc_module.py", line 90, in validation_step
    loss, acc, pred_output_bool = self.step(batch)
  File "/home/fubao/dev/my-ndc/src/models/undc_module.py", line 64, in step
    pred_output_bool = self.forward(pc_KNN_idx,pc_KNN_xyz, voxel_xyz_int,voxel_KNN_idx,voxel_KNN_xyz)
TypeError: forward() takes 2 positional arguments but 6 were given

[2022-11-10 22:30:54,417][src.utils.utils][INFO] - Closing loggers...
[2022-11-10 22:36:39,910][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-10 22:36:39,916][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-10 22:36:39,917][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-10 22:36:39,981][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_datamodule.UNDCDataModule>
[2022-11-10 22:36:40,576][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-11-10 22:36:40,610][__main__][INFO] - Instantiating callbacks...
[2022-11-10 22:36:40,610][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-10 22:36:40,614][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-10 22:36:40,616][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-10 22:36:40,617][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-10 22:36:40,618][__main__][INFO] - Instantiating loggers...
[2022-11-10 22:36:40,618][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-10 22:36:40,618][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-10 22:37:19,403][__main__][INFO] - Starting training!
[2022-11-10 22:37:38,888][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 98, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 648, in _call_and_handle_interrupt
    return self.strategy.launcher.launch(trainer_fn, *args, trainer=self, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 103, in launch
    mp.start_processes(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 198, in start_processes
    while not context.join():
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 160, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 0 terminated with the following error:
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 69, in _wrap
    fn(i, *args)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 129, in _wrapping_function
    results = function(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_train
    self._run_sanity_check()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1345, in _run_sanity_check
    val_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 155, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 143, in advance
    output = self._evaluation_step(**kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 240, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1706, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/ddp_spawn.py", line 291, in validation_step
    return self.model(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1008, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 969, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/overrides/base.py", line 90, in forward
    return self.module.validation_step(*inputs, **kwargs)
  File "/home/fubao/dev/my-ndc/src/models/undc_module.py", line 111, in validation_step
    pred_output_float_ = gt_output_float_[0].numpy()
TypeError: can't convert cuda:0 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.

[2022-11-10 22:37:38,896][src.utils.utils][INFO] - Closing loggers...
[2022-11-10 22:38:16,085][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-10 22:38:16,093][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-10 22:38:16,093][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-10 22:38:16,163][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_datamodule.UNDCDataModule>
[2022-11-10 22:38:16,698][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-11-10 22:38:16,726][__main__][INFO] - Instantiating callbacks...
[2022-11-10 22:38:16,726][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-10 22:38:16,730][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-10 22:38:16,731][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-10 22:38:16,732][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-10 22:38:16,733][__main__][INFO] - Instantiating loggers...
[2022-11-10 22:38:16,733][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-10 22:38:16,733][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-10 22:38:57,134][__main__][INFO] - Starting training!
[2022-11-11 00:34:48,296][__main__][INFO] - Starting testing!
[2022-11-11 00:35:40,251][__main__][INFO] - Best ckpt path: /home/fubao/dev/my-ndc/logs/train/runs/2022-11-10_22-38-15/checkpoints/epoch_008.ckpt
[2022-11-11 00:35:40,255][src.utils.utils][INFO] - Closing loggers...
[2022-11-11 00:35:40,256][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-11-10_22-38-15
[2022-11-11 00:35:40,257][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-11-14 16:47:59,583][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-14 16:47:59,590][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-14 16:47:59,590][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-14 16:47:59,660][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_datamodule.UNDCDataModule>
[2022-11-14 16:48:00,262][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-11-14 16:48:00,296][__main__][INFO] - Instantiating callbacks...
[2022-11-14 16:48:00,296][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-14 16:48:00,301][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-14 16:48:00,302][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-14 16:48:00,303][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-14 16:48:00,304][__main__][INFO] - Instantiating loggers...
[2022-11-14 16:48:00,304][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-14 16:48:00,305][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-14 16:48:40,078][__main__][INFO] - Starting training!
[2022-11-14 17:24:56,603][__main__][INFO] - Starting testing!
[2022-11-14 17:24:56,604][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2022-11-14 17:25:00,222][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 108, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 864, in test
    return self._call_and_handle_interrupt(self._test_impl, model, dataloaders, ckpt_path, verbose, datamodule)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 648, in _call_and_handle_interrupt
    return self.strategy.launcher.launch(trainer_fn, *args, trainer=self, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 103, in launch
    mp.start_processes(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 198, in start_processes
    while not context.join():
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 160, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 0 terminated with the following error:
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 69, in _wrap
    fn(i, *args)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 128, in _wrapping_function
    self._strategy._worker_setup(process_idx)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/ddp_spawn.py", line 181, in _worker_setup
    init_dist_connection(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/distributed.py", line 374, in init_dist_connection
    torch.distributed.init_process_group(torch_distributed_backend, rank=global_rank, world_size=world_size, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/distributed/distributed_c10d.py", line 595, in init_process_group
    store, rank, world_size = next(rendezvous_iterator)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/distributed/rendezvous.py", line 257, in _env_rendezvous_handler
    store = _create_c10d_store(master_addr, master_port, rank, world_size, timeout)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/distributed/rendezvous.py", line 188, in _create_c10d_store
    return TCPStore(
RuntimeError: The server socket has failed to listen on any local network address. The server socket has failed to bind to [::]:37005 (errno: 98 - Address already in use). The server socket has failed to bind to 0.0.0.0:37005 (errno: 98 - Address already in use).

[2022-11-14 17:25:00,226][src.utils.utils][INFO] - Closing loggers...
[2022-11-14 17:26:55,585][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-14 17:26:55,592][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-14 17:26:55,592][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-14 17:26:55,663][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_datamodule.UNDCDataModule>
[2022-11-14 17:26:56,212][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-11-14 17:26:56,241][__main__][INFO] - Instantiating callbacks...
[2022-11-14 17:26:56,241][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-14 17:26:56,245][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-14 17:26:56,246][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-14 17:26:56,247][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-14 17:26:56,248][__main__][INFO] - Instantiating loggers...
[2022-11-14 17:26:56,248][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-14 17:26:56,248][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-14 17:26:57,318][__main__][INFO] - Starting training!
[2022-11-14 17:27:46,977][__main__][INFO] - Starting testing!
[2022-11-14 17:27:46,978][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2022-11-14 17:27:48,151][__main__][INFO] - Best ckpt path: None
[2022-11-14 17:27:48,155][src.utils.utils][INFO] - Closing loggers...
[2022-11-14 17:27:48,156][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-11-14_17-26-55
[2022-11-14 17:27:48,157][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-11-14 17:27:54,618][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-14 17:27:54,625][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-14 17:27:54,625][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-14 17:27:54,693][__main__][INFO] - Instantiating datamodule <src.datamodules.ndc_datamodule.NDCDataModule>
[2022-11-14 17:27:54,725][__main__][INFO] - Instantiating model <src.models.ndc_module.NDCLitModule>
[2022-11-14 17:27:54,739][__main__][INFO] - Instantiating callbacks...
[2022-11-14 17:27:54,739][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-14 17:27:54,743][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-14 17:27:54,744][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-14 17:27:54,745][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-14 17:27:54,745][__main__][INFO] - Instantiating loggers...
[2022-11-14 17:27:54,746][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-14 17:27:54,746][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-14 17:27:55,434][__main__][INFO] - Starting training!
[2022-11-14 17:28:15,279][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 98, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 648, in _call_and_handle_interrupt
    return self.strategy.launcher.launch(trainer_fn, *args, trainer=self, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 103, in launch
    mp.start_processes(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 198, in start_processes
    while not context.join():
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 160, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 2 terminated with the following error:
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 69, in _wrap
    fn(i, *args)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 129, in _wrapping_function
    results = function(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_train
    self._run_sanity_check()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1345, in _run_sanity_check
    val_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 155, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 143, in advance
    output = self._evaluation_step(**kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 240, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1706, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/ddp_spawn.py", line 291, in validation_step
    return self.model(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1008, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 969, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/overrides/base.py", line 90, in forward
    return self.module.validation_step(*inputs, **kwargs)
  File "/home/fubao/dev/my-ndc/src/models/ndc_module.py", line 102, in validation_step
    vertices, triangles = dual_contouring_ndc_test(pred_output_bool_numpy, pred_output_float_numpy)
  File "/home/fubao/dev/my-ndc/src/utils/ndc_utils.py", line 444, in dual_contouring_ndc_test
    dimx,dimy,dimz = int_grid.shape
ValueError: too many values to unpack (expected 3)

[2022-11-14 17:28:15,283][src.utils.utils][INFO] - Closing loggers...
[2022-11-14 17:34:08,793][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-14 17:34:08,801][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-14 17:34:08,801][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-14 17:34:08,871][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_datamodule.UNDCDataModule>
[2022-11-14 17:34:09,524][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-11-14 17:34:09,553][__main__][INFO] - Instantiating callbacks...
[2022-11-14 17:34:09,553][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-14 17:34:09,557][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-14 17:34:09,559][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-14 17:34:09,559][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-14 17:34:09,560][__main__][INFO] - Instantiating loggers...
[2022-11-14 17:34:09,560][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-14 17:34:09,561][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-14 17:34:10,342][__main__][INFO] - Starting training!
[2022-11-14 18:28:15,512][__main__][INFO] - Starting testing!
[2022-11-14 18:29:22,723][__main__][INFO] - Best ckpt path: /home/fubao/dev/my-ndc/logs/train/runs/2022-11-14_17-34-08/checkpoints/epoch_002.ckpt
[2022-11-14 18:29:22,728][src.utils.utils][INFO] - Closing loggers...
[2022-11-14 18:29:22,731][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-11-14_17-34-08
[2022-11-14 18:29:22,732][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-11-14 18:35:45,123][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-14 18:35:45,130][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-14 18:35:45,131][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-14 18:35:45,200][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_datamodule.UNDCDataModule>
[2022-11-14 18:35:45,782][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-11-14 18:35:45,814][__main__][INFO] - Instantiating callbacks...
[2022-11-14 18:35:45,814][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-14 18:35:45,818][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-14 18:35:45,820][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-14 18:35:45,821][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-14 18:35:45,822][__main__][INFO] - Instantiating loggers...
[2022-11-14 18:35:45,822][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-14 18:35:45,822][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-14 18:35:46,546][__main__][INFO] - Starting training!
[2022-11-14 18:36:31,101][__main__][INFO] - Starting testing!
[2022-11-14 18:36:31,101][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2022-11-14 18:36:35,120][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 108, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 864, in test
    return self._call_and_handle_interrupt(self._test_impl, model, dataloaders, ckpt_path, verbose, datamodule)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 648, in _call_and_handle_interrupt
    return self.strategy.launcher.launch(trainer_fn, *args, trainer=self, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 103, in launch
    mp.start_processes(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 198, in start_processes
    while not context.join():
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 160, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 0 terminated with the following error:
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 69, in _wrap
    fn(i, *args)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 128, in _wrapping_function
    self._strategy._worker_setup(process_idx)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/ddp_spawn.py", line 181, in _worker_setup
    init_dist_connection(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/distributed.py", line 374, in init_dist_connection
    torch.distributed.init_process_group(torch_distributed_backend, rank=global_rank, world_size=world_size, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/distributed/distributed_c10d.py", line 595, in init_process_group
    store, rank, world_size = next(rendezvous_iterator)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/distributed/rendezvous.py", line 257, in _env_rendezvous_handler
    store = _create_c10d_store(master_addr, master_port, rank, world_size, timeout)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/distributed/rendezvous.py", line 188, in _create_c10d_store
    return TCPStore(
RuntimeError: The server socket has failed to listen on any local network address. The server socket has failed to bind to [::]:41412 (errno: 98 - Address already in use). The server socket has failed to bind to 0.0.0.0:41412 (errno: 98 - Address already in use).

[2022-11-14 18:36:35,123][src.utils.utils][INFO] - Closing loggers...
[2022-11-14 20:02:47,096][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-14 20:02:47,103][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-14 20:02:47,103][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-14 20:02:47,186][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_datamodule.UNDCDataModule>
[2022-11-14 20:02:47,796][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-11-14 20:02:47,827][__main__][INFO] - Instantiating callbacks...
[2022-11-14 20:02:47,827][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-14 20:02:47,831][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-14 20:02:47,833][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-14 20:02:47,833][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-14 20:02:47,834][__main__][INFO] - Instantiating loggers...
[2022-11-14 20:02:47,834][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-14 20:02:47,835][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-14 20:02:48,616][__main__][INFO] - Starting training!
[2022-11-14 20:07:25,238][__main__][INFO] - Starting testing!
[2022-11-14 20:07:25,238][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2022-11-14 20:07:26,827][__main__][INFO] - Best ckpt path: None
[2022-11-14 20:07:26,832][src.utils.utils][INFO] - Closing loggers...
[2022-11-14 20:07:26,835][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-11-14_20-02-46
[2022-11-14 20:07:26,836][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-11-14 20:24:55,585][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-14 20:24:55,592][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-14 20:24:55,593][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-14 20:24:55,678][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_datamodule.UNDCDataModule>
[2022-11-14 20:24:56,295][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-11-14 20:24:56,324][__main__][INFO] - Instantiating callbacks...
[2022-11-14 20:24:56,324][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-14 20:24:56,328][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-14 20:24:56,329][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-14 20:24:56,330][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-14 20:24:56,331][__main__][INFO] - Instantiating loggers...
[2022-11-14 20:24:56,331][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-14 20:24:56,331][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-14 20:24:57,039][__main__][INFO] - Starting training!
[2022-11-14 20:26:20,368][__main__][INFO] - Starting testing!
[2022-11-14 20:26:20,369][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2022-11-14 20:26:22,392][__main__][INFO] - Best ckpt path: None
[2022-11-14 20:26:22,398][src.utils.utils][INFO] - Closing loggers...
[2022-11-14 20:26:22,401][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-11-14_20-24-55
[2022-11-14 20:26:22,402][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-11-14 20:26:52,995][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-14 20:26:53,002][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-14 20:26:53,002][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-14 20:26:53,071][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_datamodule.UNDCDataModule>
[2022-11-14 20:26:53,671][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-11-14 20:26:53,699][__main__][INFO] - Instantiating callbacks...
[2022-11-14 20:26:53,699][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-14 20:26:53,703][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-14 20:26:53,704][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-14 20:26:53,705][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-14 20:26:53,706][__main__][INFO] - Instantiating loggers...
[2022-11-14 20:26:53,706][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-14 20:26:53,706][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-14 20:26:54,406][__main__][INFO] - Starting training!
[2022-11-14 21:21:00,231][__main__][INFO] - Starting testing!
[2022-11-14 21:22:07,995][__main__][INFO] - Best ckpt path: /home/fubao/dev/my-ndc/logs/train/runs/2022-11-14_20-26-52/checkpoints/epoch_002.ckpt
[2022-11-14 21:22:07,999][src.utils.utils][INFO] - Closing loggers...
[2022-11-14 21:22:08,001][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-11-14_20-26-52
[2022-11-14 21:22:08,002][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-11-29 19:08:59,662][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-29 19:08:59,697][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-29 19:08:59,699][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-29 19:09:00,109][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_datamodule.UNDCDataModule>
[2022-11-29 19:09:00,125][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/utils.py", line 639, in _locate
    obj = getattr(obj, part)
AttributeError: module 'src.datamodules' has no attribute 'undc_datamodule'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/utils.py", line 645, in _locate
    obj = import_module(mod)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1014, in _gcd_import
  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 973, in _find_and_load_unlocked
ModuleNotFoundError: No module named 'src.datamodules.undc_datamodule'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/utils.py", line 648, in _locate
    raise ImportError(
ImportError: Error loading 'src.datamodules.undc_datamodule.UNDCDataModule':
ModuleNotFoundError("No module named 'src.datamodules.undc_datamodule'")
Are you sure that 'undc_datamodule' is importable from module 'src.datamodules'?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/fubao/dev/my-ndc/src/train.py", line 69, in train
    datamodule: LightningDataModule = hydra.utils.instantiate(cfg.datamodule)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 325, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'src.datamodules.undc_datamodule.UNDCDataModule', see chained exception above.
full_key: datamodule
[2022-11-29 19:09:00,135][src.utils.utils][INFO] - Closing loggers...
[2022-11-29 19:09:28,040][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-29 19:09:28,070][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-29 19:09:28,071][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-29 19:09:28,426][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-11-29 19:09:29,675][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-11-29 19:09:29,766][__main__][INFO] - Instantiating callbacks...
[2022-11-29 19:09:29,768][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-29 19:09:29,787][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-29 19:09:29,793][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-29 19:09:29,798][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-29 19:09:29,800][__main__][INFO] - Instantiating loggers...
[2022-11-29 19:09:29,801][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-29 19:09:29,802][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-29 19:09:56,401][__main__][INFO] - Starting training!
[2022-11-29 19:09:56,426][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/parsing.py", line 285, in __getattr__
    return self[key]
KeyError: 'input_type'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/fubao/dev/my-ndc/src/train.py", line 98, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1107, in _run
    self._call_setup_hook()  # allow user to setup lightning_module in accelerator environment
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1449, in _call_setup_hook
    self._call_lightning_datamodule_hook("setup", stage=fn)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1571, in _call_lightning_datamodule_hook
    return fn(*args, **kwargs)
  File "/home/fubao/dev/my-ndc/src/datamodules/undc_pc_datamodule.py", line 55, in setup
    self.hparams.input_type,
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/parsing.py", line 287, in __getattr__
    raise AttributeError(f'Missing attribute "{key}"') from exp
AttributeError: Missing attribute "input_type"
[2022-11-29 19:09:56,436][src.utils.utils][INFO] - Closing loggers...
[2022-11-29 19:12:49,308][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-29 19:12:49,341][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-29 19:12:49,342][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-29 19:12:49,727][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-11-29 19:12:50,730][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-11-29 19:12:50,780][__main__][INFO] - Instantiating callbacks...
[2022-11-29 19:12:50,781][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-29 19:12:50,795][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-29 19:12:50,800][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-29 19:12:50,803][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-29 19:12:50,804][__main__][INFO] - Instantiating loggers...
[2022-11-29 19:12:50,805][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-29 19:12:50,806][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-29 19:13:17,732][__main__][INFO] - Starting training!
[2022-11-29 19:13:17,755][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/fubao/dev/my-ndc/src/train.py", line 98, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1107, in _run
    self._call_setup_hook()  # allow user to setup lightning_module in accelerator environment
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1449, in _call_setup_hook
    self._call_lightning_datamodule_hook("setup", stage=fn)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1571, in _call_lightning_datamodule_hook
    return fn(*args, **kwargs)
  File "/home/fubao/dev/my-ndc/src/datamodules/undc_pc_datamodule.py", line 47, in setup
    self.data_train = ABC_pc_hdf5(
  File "/home/fubao/dev/my-ndc/src/datamodules/components/pc_dataset.py", line 38, in __init__
    with open(f"{data_dir}/abc_obj_list.txt", "r") as fp:
FileNotFoundError: [Errno 2] No such file or directory: '/home/fubao/dev/my-ndc/data/groundtruth/gt_UNDC/abc_obj_list.txt'
[2022-11-29 19:13:17,770][src.utils.utils][INFO] - Closing loggers...
[2022-11-29 19:14:31,112][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-29 19:14:31,139][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-29 19:14:31,141][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-29 19:14:31,413][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-11-29 19:14:32,403][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-11-29 19:14:32,454][__main__][INFO] - Instantiating callbacks...
[2022-11-29 19:14:32,456][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-29 19:14:32,470][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-29 19:14:32,476][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-29 19:14:32,478][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-29 19:14:32,480][__main__][INFO] - Instantiating loggers...
[2022-11-29 19:14:32,480][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-29 19:14:32,481][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-29 19:14:58,913][__main__][INFO] - Starting training!
[2022-11-29 19:14:58,930][src.datamodules.components.pc_dataset][INFO] - Len of TRAIN Dataset : 4280
[2022-11-29 19:14:58,952][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/parsing.py", line 285, in __getattr__
    return self[key]
KeyError: 'input_type'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/fubao/dev/my-ndc/src/train.py", line 98, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1107, in _run
    self._call_setup_hook()  # allow user to setup lightning_module in accelerator environment
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1449, in _call_setup_hook
    self._call_lightning_datamodule_hook("setup", stage=fn)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1571, in _call_lightning_datamodule_hook
    return fn(*args, **kwargs)
  File "/home/fubao/dev/my-ndc/src/datamodules/undc_pc_datamodule.py", line 61, in setup
    self.hparams.input_type,
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/parsing.py", line 287, in __getattr__
    raise AttributeError(f'Missing attribute "{key}"') from exp
AttributeError: Missing attribute "input_type"
[2022-11-29 19:14:58,963][src.utils.utils][INFO] - Closing loggers...
[2022-11-29 19:15:42,215][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-29 19:15:42,248][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-29 19:15:42,249][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-29 19:15:42,557][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-11-29 19:15:43,687][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-11-29 19:15:43,745][__main__][INFO] - Instantiating callbacks...
[2022-11-29 19:15:43,747][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-29 19:15:43,762][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-29 19:15:43,769][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-29 19:15:43,771][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-29 19:15:43,774][__main__][INFO] - Instantiating loggers...
[2022-11-29 19:15:43,775][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-29 19:15:43,775][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-29 19:16:10,167][__main__][INFO] - Starting training!
[2022-11-29 19:16:10,178][src.datamodules.components.pc_dataset][INFO] - Len of TRAIN Dataset : 4280
[2022-11-29 19:16:10,185][src.datamodules.components.pc_dataset][INFO] - Len of TEST Dataset : 1071
[2022-11-29 19:16:10,186][src.datamodules.components.pc_dataset][INFO] - Len of TEST Dataset : 1071
[2022-11-29 19:18:13,545][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-29 19:18:13,572][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-29 19:18:13,573][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-29 19:18:13,830][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-11-29 19:18:14,842][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-11-29 19:18:14,888][__main__][INFO] - Instantiating callbacks...
[2022-11-29 19:18:14,889][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-29 19:18:14,901][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-29 19:18:14,906][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-29 19:18:14,908][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-29 19:18:14,910][__main__][INFO] - Instantiating loggers...
[2022-11-29 19:18:14,911][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-29 19:18:14,911][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-29 19:18:41,986][__main__][INFO] - Starting training!
[2022-11-29 19:18:41,996][src.datamodules.components.pc_dataset][INFO] - Len of TRAIN Dataset : 4280
[2022-11-29 19:18:42,012][src.datamodules.components.pc_dataset][INFO] - Len of TEST Dataset : 1071
[2022-11-29 19:18:42,015][src.datamodules.components.pc_dataset][INFO] - Len of TEST Dataset : 1071
[2022-11-29 19:19:36,256][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/fubao/dev/my-ndc/src/train.py", line 98, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_train
    self._run_sanity_check()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1345, in _run_sanity_check
    val_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 155, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 127, in advance
    batch = next(data_fetcher)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 185, in __next__
    return self.fetching_function()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 264, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 278, in _fetch_next_batch
    batch = next(iterator)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 681, in __next__
    data = self._next_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 721, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/fubao/dev/my-ndc/src/datamodules/components/pc_dataset.py", line 71, in __getitem__
    if self.input_type == "pointcloud":
AttributeError: 'ABC_pc_hdf5' object has no attribute 'input_type'
[2022-11-29 19:19:43,576][src.utils.utils][INFO] - Closing loggers...
[2022-11-29 19:21:20,572][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-29 19:21:20,600][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-29 19:21:20,601][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-29 19:21:20,870][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-11-29 19:21:21,873][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-11-29 19:21:21,924][__main__][INFO] - Instantiating callbacks...
[2022-11-29 19:21:21,926][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-29 19:21:21,940][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-29 19:21:21,945][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-29 19:21:21,948][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-29 19:21:21,949][__main__][INFO] - Instantiating loggers...
[2022-11-29 19:21:21,950][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-29 19:21:21,951][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-29 19:21:48,710][__main__][INFO] - Starting training!
[2022-11-29 19:21:48,725][src.datamodules.components.pc_dataset][INFO] - Len of TRAIN Dataset : 4280
[2022-11-29 19:21:48,736][src.datamodules.components.pc_dataset][INFO] - Len of TEST Dataset : 1071
[2022-11-29 19:21:48,738][src.datamodules.components.pc_dataset][INFO] - Len of TEST Dataset : 1071
[2022-11-29 19:26:31,240][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/fubao/dev/my-ndc/src/train.py", line 98, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_train
    self._run_sanity_check()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1345, in _run_sanity_check
    val_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 155, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 127, in advance
    batch = next(data_fetcher)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 185, in __next__
    return self.fetching_function()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 264, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 278, in _fetch_next_batch
    batch = next(iterator)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 681, in __next__
    data = self._next_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 721, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/fubao/dev/my-ndc/src/datamodules/components/pc_dataset.py", line 83, in __getitem__
    hdf5_dir, grid_size, self.input_type, self.out_bool, self.out_float, is_undc=True)
AttributeError: 'ABC_pc_hdf5' object has no attribute 'input_type'
[2022-11-29 19:26:37,395][src.utils.utils][INFO] - Closing loggers...
[2022-11-29 19:30:22,220][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-29 19:30:22,228][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-29 19:30:22,228][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-29 19:30:22,307][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-11-29 19:30:22,894][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-11-29 19:30:22,925][__main__][INFO] - Instantiating callbacks...
[2022-11-29 19:30:22,926][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-29 19:30:22,930][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-29 19:30:22,932][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-29 19:30:22,932][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-29 19:30:22,933][__main__][INFO] - Instantiating loggers...
[2022-11-29 19:30:22,934][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-29 19:30:22,934][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-29 19:31:04,518][__main__][INFO] - Starting training!
[2022-11-29 19:32:06,509][__main__][INFO] - Starting testing!
[2022-11-29 19:32:06,510][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2022-11-29 19:32:07,564][__main__][INFO] - Best ckpt path: None
[2022-11-29 19:32:07,569][src.utils.utils][INFO] - Closing loggers...
[2022-11-29 19:32:07,571][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-11-29_19-30-22
[2022-11-29 19:32:07,572][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-11-29 19:36:16,325][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-29 19:36:16,354][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-29 19:36:16,355][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-29 19:36:16,730][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-11-29 19:36:17,862][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-11-29 19:36:17,914][__main__][INFO] - Instantiating callbacks...
[2022-11-29 19:36:17,916][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-29 19:36:17,930][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-29 19:36:17,935][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-29 19:36:17,938][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-29 19:36:17,940][__main__][INFO] - Instantiating loggers...
[2022-11-29 19:36:17,940][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-29 19:36:17,941][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-29 19:36:20,620][__main__][INFO] - Starting training!
[2022-11-29 19:36:20,636][src.datamodules.components.pc_dataset][INFO] - Len of TRAIN Dataset : 4280
[2022-11-29 19:36:20,648][src.datamodules.components.pc_dataset][INFO] - Len of TEST Dataset : 1071
[2022-11-29 19:36:20,651][src.datamodules.components.pc_dataset][INFO] - Len of TEST Dataset : 1071
[2022-11-29 19:37:57,189][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-29 19:37:57,219][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-29 19:37:57,220][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-29 19:37:57,517][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-11-29 19:37:58,491][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-11-29 19:37:58,540][__main__][INFO] - Instantiating callbacks...
[2022-11-29 19:37:58,541][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-29 19:37:58,556][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-29 19:37:58,562][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-29 19:37:58,564][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-29 19:37:58,565][__main__][INFO] - Instantiating loggers...
[2022-11-29 19:37:58,566][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-29 19:37:58,567][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-29 19:38:01,209][__main__][INFO] - Starting training!
[2022-11-29 19:38:01,223][src.datamodules.components.pc_dataset][INFO] - Len of TRAIN Dataset : 4280
[2022-11-29 19:38:01,233][src.datamodules.components.pc_dataset][INFO] - Len of TEST Dataset : 1071
[2022-11-29 19:38:01,235][src.datamodules.components.pc_dataset][INFO] - Len of TEST Dataset : 1071
[2022-11-29 19:54:22,428][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-29 19:54:22,462][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-29 19:54:22,463][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-29 19:54:22,868][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-11-29 19:54:23,884][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-11-29 19:54:23,933][__main__][INFO] - Instantiating callbacks...
[2022-11-29 19:54:23,934][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-29 19:54:23,948][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-29 19:54:23,954][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-29 19:54:23,956][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-29 19:54:23,957][__main__][INFO] - Instantiating loggers...
[2022-11-29 19:54:23,958][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-29 19:54:23,959][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-29 19:54:26,530][__main__][INFO] - Starting training!
[2022-11-29 19:54:26,546][src.datamodules.components.pc_dataset][INFO] - Len of TRAIN Dataset : 4280
[2022-11-29 19:54:26,558][src.datamodules.components.pc_dataset][INFO] - Len of TEST Dataset : 1071
[2022-11-29 19:54:26,561][src.datamodules.components.pc_dataset][INFO] - Len of TEST Dataset : 1071
[2022-11-29 20:06:30,563][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-29 20:06:30,607][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-29 20:06:30,609][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-29 20:06:31,049][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-11-29 20:06:32,112][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-11-29 20:06:32,166][__main__][INFO] - Instantiating callbacks...
[2022-11-29 20:06:32,168][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-29 20:06:32,181][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-29 20:06:32,187][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-29 20:06:32,189][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-29 20:06:32,191][__main__][INFO] - Instantiating loggers...
[2022-11-29 20:06:32,191][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-29 20:06:32,192][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-29 20:06:34,896][__main__][INFO] - Starting training!
[2022-11-29 20:06:34,913][src.datamodules.components.pc_dataset][INFO] - Len of TRAIN Dataset : 4280
[2022-11-29 20:06:34,925][src.datamodules.components.pc_dataset][INFO] - Len of TEST Dataset : 1071
[2022-11-29 20:06:34,928][src.datamodules.components.pc_dataset][INFO] - Len of TEST Dataset : 1071
[2022-11-29 20:13:23,452][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-29 20:13:23,459][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-29 20:13:23,460][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-29 20:13:23,547][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-11-29 20:13:24,153][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-11-29 20:13:24,186][__main__][INFO] - Instantiating callbacks...
[2022-11-29 20:13:24,186][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-29 20:13:24,191][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-29 20:13:24,192][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-29 20:13:24,193][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-29 20:13:24,194][__main__][INFO] - Instantiating loggers...
[2022-11-29 20:13:24,194][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-29 20:13:24,195][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-29 20:13:25,290][__main__][INFO] - Starting training!
[2022-11-29 20:13:50,501][__main__][INFO] - Starting testing!
[2022-11-29 20:13:50,502][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2022-11-29 20:13:51,391][__main__][INFO] - Best ckpt path: None
[2022-11-29 20:13:51,401][src.utils.utils][INFO] - Closing loggers...
[2022-11-29 20:13:51,425][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-11-29_20-13-23
[2022-11-29 20:13:51,425][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-11-29 20:17:14,264][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-29 20:17:14,271][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-29 20:17:14,271][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-29 20:17:14,367][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-11-29 20:17:14,954][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-11-29 20:17:14,986][__main__][INFO] - Instantiating callbacks...
[2022-11-29 20:17:14,986][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-29 20:17:14,990][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-29 20:17:14,992][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-29 20:17:14,993][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-29 20:17:14,994][__main__][INFO] - Instantiating loggers...
[2022-11-29 20:17:14,994][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-29 20:17:14,994][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-29 20:17:15,968][__main__][INFO] - Starting training!
[2022-11-29 20:23:41,101][__main__][INFO] - Starting testing!
[2022-11-29 20:23:41,102][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2022-11-29 20:23:43,418][__main__][INFO] - Best ckpt path: None
[2022-11-29 20:23:43,421][src.utils.utils][INFO] - Closing loggers...
[2022-11-29 20:23:43,438][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-11-29_20-17-14
[2022-11-29 20:23:43,439][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-11-29 20:27:40,918][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-29 20:27:40,947][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-29 20:27:40,948][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-29 20:27:41,230][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-11-29 20:27:42,282][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-11-29 20:27:42,337][__main__][INFO] - Instantiating callbacks...
[2022-11-29 20:27:42,338][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-29 20:27:42,352][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-29 20:27:42,358][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-29 20:27:42,360][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-29 20:27:42,362][__main__][INFO] - Instantiating loggers...
[2022-11-29 20:27:42,362][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-29 20:27:42,363][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-29 20:27:44,921][__main__][INFO] - Starting training!
[2022-11-29 20:27:44,935][src.datamodules.components.pc_dataset][INFO] - Len of TRAIN Dataset : 4280
[2022-11-29 20:27:44,945][src.datamodules.components.pc_dataset][INFO] - Len of TEST Dataset : 1071
[2022-11-29 20:27:44,948][src.datamodules.components.pc_dataset][INFO] - Len of TEST Dataset : 1071
[2022-11-29 20:36:03,354][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-29 20:36:03,382][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-29 20:36:03,383][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-29 20:36:03,670][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-11-29 20:36:04,543][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-11-29 20:36:04,595][__main__][INFO] - Instantiating callbacks...
[2022-11-29 20:36:04,596][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-29 20:36:04,609][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-29 20:36:04,615][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-29 20:36:04,617][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-29 20:36:04,619][__main__][INFO] - Instantiating loggers...
[2022-11-29 20:36:04,619][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-29 20:36:04,620][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-29 20:36:07,167][__main__][INFO] - Starting training!
[2022-11-29 20:36:07,176][src.datamodules.components.pc_dataset][INFO] - Len of TRAIN Dataset : 4280
[2022-11-29 20:36:07,184][src.datamodules.components.pc_dataset][INFO] - Len of TEST Dataset : 1071
[2022-11-29 20:36:07,186][src.datamodules.components.pc_dataset][INFO] - Len of TEST Dataset : 1071
[2022-11-29 20:43:05,575][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-29 20:43:05,610][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-29 20:43:05,611][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-29 20:43:05,892][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-11-29 20:43:06,949][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-11-29 20:43:07,008][__main__][INFO] - Instantiating callbacks...
[2022-11-29 20:43:07,010][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-29 20:43:07,026][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-29 20:43:07,032][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-29 20:43:07,035][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-29 20:43:07,037][__main__][INFO] - Instantiating loggers...
[2022-11-29 20:43:07,037][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-29 20:43:07,038][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-29 20:43:09,555][__main__][INFO] - Starting training!
[2022-11-29 20:43:09,564][src.datamodules.components.pc_dataset][INFO] - Len of TRAIN Dataset : 4280
[2022-11-29 20:43:09,571][src.datamodules.components.pc_dataset][INFO] - Len of TEST Dataset : 1071
[2022-11-29 20:43:09,573][src.datamodules.components.pc_dataset][INFO] - Len of TEST Dataset : 1071
[2022-11-29 20:43:38,322][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-29 20:43:38,353][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-29 20:43:38,354][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-29 20:43:38,635][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-11-29 20:43:39,572][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-11-29 20:43:39,621][__main__][INFO] - Instantiating callbacks...
[2022-11-29 20:43:39,622][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-29 20:43:39,635][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-29 20:43:39,641][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-29 20:43:39,643][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-29 20:43:39,645][__main__][INFO] - Instantiating loggers...
[2022-11-29 20:43:39,645][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-29 20:43:39,646][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-29 20:43:42,566][__main__][INFO] - Starting training!
[2022-11-29 20:43:42,579][src.datamodules.components.pc_dataset][INFO] - Len of TRAIN Dataset : 4280
[2022-11-29 20:43:42,589][src.datamodules.components.pc_dataset][INFO] - Len of TEST Dataset : 1071
[2022-11-29 20:43:42,591][src.datamodules.components.pc_dataset][INFO] - Len of TEST Dataset : 1071
[2022-11-29 20:45:58,891][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-29 20:45:58,920][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-29 20:45:58,921][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-29 20:45:59,198][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-11-29 20:46:00,322][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-11-29 20:46:00,380][__main__][INFO] - Instantiating callbacks...
[2022-11-29 20:46:00,381][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-29 20:46:00,397][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-29 20:46:00,403][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-29 20:46:00,405][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-29 20:46:00,407][__main__][INFO] - Instantiating loggers...
[2022-11-29 20:46:00,408][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-29 20:46:00,409][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-29 20:46:03,145][__main__][INFO] - Starting training!
[2022-11-29 20:46:03,155][src.datamodules.components.pc_dataset][INFO] - Len of TRAIN Dataset : 4280
[2022-11-29 20:46:03,162][src.datamodules.components.pc_dataset][INFO] - Len of TEST Dataset : 1071
[2022-11-29 20:46:03,164][src.datamodules.components.pc_dataset][INFO] - Len of TEST Dataset : 1071
[2022-11-29 21:06:58,113][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-29 21:06:58,161][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-29 21:06:58,163][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-29 21:06:58,572][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-11-29 21:06:59,740][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-11-29 21:06:59,804][__main__][INFO] - Instantiating callbacks...
[2022-11-29 21:06:59,805][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-29 21:06:59,820][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-29 21:06:59,826][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-29 21:06:59,829][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-29 21:06:59,831][__main__][INFO] - Instantiating loggers...
[2022-11-29 21:06:59,832][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-29 21:06:59,832][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-29 21:07:02,434][__main__][INFO] - Starting training!
[2022-11-29 21:07:02,448][src.datamodules.components.pc_dataset][INFO] - Len of TRAIN Dataset : 4280
[2022-11-29 21:07:02,459][src.datamodules.components.pc_dataset][INFO] - Len of TEST Dataset : 1071
[2022-11-29 21:07:02,461][src.datamodules.components.pc_dataset][INFO] - Len of TEST Dataset : 1071
[2022-11-29 21:10:25,951][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-29 21:10:25,980][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-29 21:10:25,981][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-29 21:10:26,252][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-11-29 21:10:27,137][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-11-29 21:10:27,184][__main__][INFO] - Instantiating callbacks...
[2022-11-29 21:10:27,185][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-29 21:10:27,198][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-29 21:10:27,203][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-29 21:10:27,205][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-29 21:10:27,207][__main__][INFO] - Instantiating loggers...
[2022-11-29 21:10:27,208][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-29 21:10:27,209][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-29 21:10:29,808][__main__][INFO] - Starting training!
[2022-11-29 21:10:29,818][src.datamodules.components.pc_dataset][INFO] - Len of TRAIN Dataset : 4280
[2022-11-29 21:10:29,825][src.datamodules.components.pc_dataset][INFO] - Len of TEST Dataset : 1071
[2022-11-29 21:10:29,827][src.datamodules.components.pc_dataset][INFO] - Len of TEST Dataset : 1071
[2022-11-29 21:16:01,150][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-29 21:16:01,178][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-29 21:16:01,179][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-29 21:16:01,464][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-11-29 21:16:02,442][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-11-29 21:16:02,491][__main__][INFO] - Instantiating callbacks...
[2022-11-29 21:16:02,492][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-29 21:16:02,506][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-29 21:16:02,511][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-29 21:16:02,513][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-29 21:16:02,515][__main__][INFO] - Instantiating loggers...
[2022-11-29 21:16:02,516][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-29 21:16:02,516][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-29 21:16:05,086][__main__][INFO] - Starting training!
[2022-11-29 21:16:05,101][src.datamodules.components.pc_dataset][INFO] - Len of TRAIN Dataset : 4280
[2022-11-29 21:16:05,114][src.datamodules.components.pc_dataset][INFO] - Len of TEST Dataset : 1071
[2022-11-29 21:16:05,116][src.datamodules.components.pc_dataset][INFO] - Len of TEST Dataset : 1071
[2022-11-29 21:17:12,742][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-29 21:17:12,785][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-29 21:17:12,787][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-29 21:17:13,204][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-11-29 21:17:14,226][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-11-29 21:17:14,276][__main__][INFO] - Instantiating callbacks...
[2022-11-29 21:17:14,277][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-29 21:17:14,290][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-29 21:17:14,295][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-29 21:17:14,297][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-29 21:17:14,299][__main__][INFO] - Instantiating loggers...
[2022-11-29 21:17:14,300][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-29 21:17:14,300][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-29 21:17:16,896][__main__][INFO] - Starting training!
[2022-11-29 21:17:16,912][src.datamodules.components.pc_dataset][INFO] - Len of TRAIN Dataset : 4280
[2022-11-29 21:17:16,924][src.datamodules.components.pc_dataset][INFO] - Len of TEST Dataset : 1071
[2022-11-29 21:17:16,927][src.datamodules.components.pc_dataset][INFO] - Len of TEST Dataset : 1071
[2022-11-29 21:24:58,891][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-29 21:24:58,919][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-29 21:24:58,920][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-29 21:24:59,203][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-11-29 21:25:00,292][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-11-29 21:25:00,344][__main__][INFO] - Instantiating callbacks...
[2022-11-29 21:25:00,345][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-29 21:25:00,359][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-29 21:25:00,364][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-29 21:25:00,367][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-29 21:25:00,368][__main__][INFO] - Instantiating loggers...
[2022-11-29 21:25:00,369][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-29 21:25:00,370][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-29 21:25:03,135][__main__][INFO] - Starting training!
[2022-11-29 21:25:03,154][src.datamodules.components.pc_dataset][INFO] - Len of TRAIN Dataset : 4280
[2022-11-29 21:25:03,164][src.datamodules.components.pc_dataset][INFO] - Len of TEST Dataset : 1071
[2022-11-29 21:25:03,166][src.datamodules.components.pc_dataset][INFO] - Len of TEST Dataset : 1071
[2022-11-29 21:29:53,198][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-29 21:29:53,249][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-29 21:29:53,251][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-29 21:29:53,637][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-11-29 21:29:54,550][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-11-29 21:29:54,603][__main__][INFO] - Instantiating callbacks...
[2022-11-29 21:29:54,604][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-29 21:29:54,618][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-29 21:29:54,624][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-29 21:29:54,626][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-29 21:29:54,628][__main__][INFO] - Instantiating loggers...
[2022-11-29 21:29:54,629][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-29 21:29:54,630][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-29 21:29:57,231][__main__][INFO] - Starting training!
[2022-11-29 21:29:57,240][src.datamodules.components.pc_dataset][INFO] - Len of TRAIN Dataset : 4280
[2022-11-29 21:29:57,248][src.datamodules.components.pc_dataset][INFO] - Len of TEST Dataset : 1071
[2022-11-29 21:29:57,250][src.datamodules.components.pc_dataset][INFO] - Len of TEST Dataset : 1071
[2022-11-29 21:32:49,267][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-29 21:32:49,297][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-29 21:32:49,298][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-29 21:32:49,754][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-11-29 21:32:51,006][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-11-29 21:32:51,063][__main__][INFO] - Instantiating callbacks...
[2022-11-29 21:32:51,064][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-29 21:32:51,079][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-29 21:32:51,086][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-29 21:32:51,088][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-29 21:32:51,091][__main__][INFO] - Instantiating loggers...
[2022-11-29 21:32:51,092][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-29 21:32:51,092][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-29 21:32:53,676][__main__][INFO] - Starting training!
[2022-11-29 21:32:53,690][src.datamodules.components.pc_dataset][INFO] - Len of TRAIN Dataset : 4280
[2022-11-29 21:32:53,701][src.datamodules.components.pc_dataset][INFO] - Len of TEST Dataset : 1071
[2022-11-29 21:32:53,705][src.datamodules.components.pc_dataset][INFO] - Len of TEST Dataset : 1071
[2022-11-30 09:52:29,306][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-30 09:52:29,337][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-30 09:52:29,338][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-30 09:52:29,634][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-11-30 09:52:30,891][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-11-30 09:52:30,950][__main__][INFO] - Instantiating callbacks...
[2022-11-30 09:52:30,951][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-30 09:52:30,967][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-30 09:52:30,973][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-30 09:52:30,976][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-30 09:52:30,978][__main__][INFO] - Instantiating loggers...
[2022-11-30 09:52:30,979][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-30 09:52:30,979][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-30 09:52:33,356][__main__][INFO] - Starting training!
[2022-11-30 09:52:33,367][src.datamodules.undc_pc_datamodule][INFO] - Loading Train dataset...
[2022-11-30 09:52:33,378][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/fubao/dev/my-ndc/src/train.py", line 98, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1107, in _run
    self._call_setup_hook()  # allow user to setup lightning_module in accelerator environment
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1449, in _call_setup_hook
    self._call_lightning_datamodule_hook("setup", stage=fn)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1571, in _call_lightning_datamodule_hook
    return fn(*args, **kwargs)
  File "/home/fubao/dev/my-ndc/src/datamodules/undc_pc_datamodule.py", line 51, in setup
    self.data_train = ABC_pc_hdf5(
  File "/home/fubao/dev/my-ndc/src/datamodules/components/pc_dataset.py", line 25, in __init__
    if self.out_bool and self.out_float and self.train:
AttributeError: 'ABC_pc_hdf5' object has no attribute 'out_bool'
[2022-11-30 09:52:33,387][src.utils.utils][INFO] - Closing loggers...
[2022-11-30 09:53:38,090][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-30 09:53:38,133][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-30 09:53:38,135][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-30 09:53:38,440][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-11-30 09:53:39,330][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-11-30 09:53:39,380][__main__][INFO] - Instantiating callbacks...
[2022-11-30 09:53:39,381][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-30 09:53:39,395][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-30 09:53:39,401][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-30 09:53:39,403][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-30 09:53:39,405][__main__][INFO] - Instantiating loggers...
[2022-11-30 09:53:39,405][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-30 09:53:39,406][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-30 09:53:41,621][__main__][INFO] - Starting training!
[2022-11-30 09:53:41,633][src.datamodules.undc_pc_datamodule][INFO] - Loading Train dataset...
[2022-11-30 09:53:41,643][src.datamodules.undc_pc_datamodule][INFO] - Train dataset [ABC_pc_hdf5] of size 8560 had been created.
[2022-11-30 09:53:41,644][src.datamodules.undc_pc_datamodule][INFO] - Loading Val dataset...
[2022-11-30 09:53:41,647][src.datamodules.undc_pc_datamodule][INFO] - Val dataset [ABC_pc_hdf5] of size 8560 had been created.
[2022-11-30 09:53:41,648][src.datamodules.undc_pc_datamodule][INFO] - Loading Test dataset...
[2022-11-30 09:53:41,650][src.datamodules.undc_pc_datamodule][INFO] - Test dataset [ABC_pc_hdf5] of size 8560 had been created.
[2022-11-30 09:53:41,914][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/fubao/dev/my-ndc/src/train.py", line 98, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_train
    self._run_sanity_check()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1345, in _run_sanity_check
    val_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 155, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 127, in advance
    batch = next(data_fetcher)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 185, in __next__
    return self.fetching_function()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 264, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 278, in _fetch_next_batch
    batch = next(iterator)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 681, in __next__
    data = self._next_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 721, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/fubao/dev/my-ndc/src/datamodules/components/pc_dataset.py", line 68, in __getitem__
    hdf5_dir, grid_size, "pointcloud", self.out_bool, self.out_float, is_undc=True)
AttributeError: 'ABC_pc_hdf5' object has no attribute 'out_bool'
[2022-11-30 09:53:41,923][src.utils.utils][INFO] - Closing loggers...
[2022-11-30 10:01:43,573][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-30 10:01:43,601][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-30 10:01:43,602][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-30 10:01:43,895][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-11-30 10:01:44,949][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-11-30 10:01:45,008][__main__][INFO] - Instantiating callbacks...
[2022-11-30 10:01:45,010][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-30 10:01:45,026][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-30 10:01:45,033][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-30 10:01:45,036][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-30 10:01:45,039][__main__][INFO] - Instantiating loggers...
[2022-11-30 10:01:45,040][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-30 10:01:45,041][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-30 10:01:47,360][__main__][INFO] - Starting training!
[2022-11-30 10:01:47,372][src.datamodules.undc_pc_datamodule][INFO] - Loading Train dataset...
[2022-11-30 10:01:47,384][src.datamodules.undc_pc_datamodule][INFO] - Train dataset [ABC_pc_hdf5] of size 8560 had been created.
[2022-11-30 10:01:47,384][src.datamodules.undc_pc_datamodule][INFO] - Loading Val dataset...
[2022-11-30 10:01:47,387][src.datamodules.undc_pc_datamodule][INFO] - Val dataset [ABC_pc_hdf5] of size 8560 had been created.
[2022-11-30 10:01:47,388][src.datamodules.undc_pc_datamodule][INFO] - Loading Test dataset...
[2022-11-30 10:01:47,391][src.datamodules.undc_pc_datamodule][INFO] - Test dataset [ABC_pc_hdf5] of size 8560 had been created.
[2022-11-30 11:25:47,538][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-30 11:25:47,545][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-30 11:25:47,546][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-30 11:25:47,618][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-11-30 11:25:48,233][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-11-30 11:25:48,263][__main__][INFO] - Instantiating callbacks...
[2022-11-30 11:25:48,264][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-30 11:25:48,268][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-30 11:25:48,269][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-30 11:25:48,270][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-30 11:25:48,271][__main__][INFO] - Instantiating loggers...
[2022-11-30 11:25:48,271][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-30 11:25:48,271][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-30 11:25:49,226][__main__][INFO] - Starting training!
[2022-11-30 11:26:14,548][__main__][INFO] - Starting testing!
[2022-11-30 11:26:14,550][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2022-11-30 11:26:15,942][__main__][INFO] - Best ckpt path: None
[2022-11-30 11:26:15,947][src.utils.utils][INFO] - Closing loggers...
[2022-11-30 11:26:15,949][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-11-30_11-25-47
[2022-11-30 11:26:15,949][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-11-30 11:28:38,337][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-30 11:28:38,344][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-30 11:28:38,345][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-30 11:28:38,414][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-11-30 11:28:39,007][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-11-30 11:28:39,040][__main__][INFO] - Instantiating callbacks...
[2022-11-30 11:28:39,041][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-30 11:28:39,045][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-30 11:28:39,047][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-30 11:28:39,048][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-30 11:28:39,049][__main__][INFO] - Instantiating loggers...
[2022-11-30 11:28:39,050][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-30 11:28:39,050][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-30 11:28:40,010][__main__][INFO] - Starting training!
[2022-11-30 11:34:51,806][__main__][INFO] - Starting testing!
[2022-11-30 11:34:51,807][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2022-11-30 11:34:52,533][__main__][INFO] - Best ckpt path: None
[2022-11-30 11:34:52,566][src.utils.utils][INFO] - Closing loggers...
[2022-11-30 11:34:52,570][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-11-30_11-28-38
[2022-11-30 11:34:52,571][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-11-30 11:35:02,276][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-30 11:35:02,283][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-30 11:35:02,283][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-30 11:35:02,352][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-11-30 11:35:02,936][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-11-30 11:35:02,967][__main__][INFO] - Instantiating callbacks...
[2022-11-30 11:35:02,967][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-30 11:35:02,971][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-30 11:35:02,973][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-30 11:35:02,974][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-30 11:35:02,974][__main__][INFO] - Instantiating loggers...
[2022-11-30 11:35:02,975][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-30 11:35:02,975][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-30 11:35:03,452][__main__][INFO] - Starting training!
[2022-11-30 11:35:03,457][src.datamodules.undc_pc_datamodule][INFO] - Loading Train dataset...
[2022-11-30 11:35:03,461][src.datamodules.undc_pc_datamodule][INFO] - Train dataset [ABC_pc_hdf5] of size 8560 had been created.
[2022-11-30 11:35:03,461][src.datamodules.undc_pc_datamodule][INFO] - Loading Val dataset...
[2022-11-30 11:35:03,464][src.datamodules.undc_pc_datamodule][INFO] - Val dataset [ABC_pc_hdf5] of size 8560 had been created.
[2022-11-30 11:35:03,464][src.datamodules.undc_pc_datamodule][INFO] - Loading Test dataset...
[2022-11-30 11:35:03,466][src.datamodules.undc_pc_datamodule][INFO] - Test dataset [ABC_pc_hdf5] of size 8560 had been created.
[2022-11-30 11:38:40,587][__main__][INFO] - Starting testing!
[2022-11-30 11:38:40,588][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2022-11-30 11:38:41,904][__main__][INFO] - Best ckpt path: None
[2022-11-30 11:38:41,908][src.utils.utils][INFO] - Closing loggers...
[2022-11-30 11:38:41,909][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-11-30_11-35-02
[2022-11-30 11:38:41,910][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-11-30 11:38:49,478][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-30 11:38:49,486][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-30 11:38:49,486][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-30 11:38:49,555][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-11-30 11:38:50,175][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-11-30 11:38:50,206][__main__][INFO] - Instantiating callbacks...
[2022-11-30 11:38:50,206][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-30 11:38:50,210][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-30 11:38:50,211][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-30 11:38:50,212][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-30 11:38:50,213][__main__][INFO] - Instantiating loggers...
[2022-11-30 11:38:50,213][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-30 11:38:50,213][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-30 11:38:51,159][__main__][INFO] - Starting training!
[2022-11-30 11:38:51,338][src.datamodules.undc_pc_datamodule][INFO] - Loading Train dataset...
[2022-11-30 11:38:51,341][src.datamodules.undc_pc_datamodule][INFO] - Train dataset [ABC_pc_hdf5] of size 8560 had been created.
[2022-11-30 11:38:51,342][src.datamodules.undc_pc_datamodule][INFO] - Loading Val dataset...
[2022-11-30 11:38:51,343][src.datamodules.undc_pc_datamodule][INFO] - Val dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-11-30 11:38:51,343][src.datamodules.undc_pc_datamodule][INFO] - Loading Test dataset...
[2022-11-30 11:38:51,345][src.datamodules.undc_pc_datamodule][INFO] - Test dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-11-30 11:39:40,458][__main__][INFO] - Starting testing!
[2022-11-30 11:39:40,459][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2022-11-30 11:39:41,148][__main__][INFO] - Best ckpt path: None
[2022-11-30 11:39:41,152][src.utils.utils][INFO] - Closing loggers...
[2022-11-30 11:39:41,154][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-11-30_11-38-49
[2022-11-30 11:39:41,155][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-11-30 11:52:53,853][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-30 11:52:53,862][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-30 11:52:53,863][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-30 11:52:53,943][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-11-30 11:52:54,542][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-11-30 11:52:54,573][__main__][INFO] - Instantiating callbacks...
[2022-11-30 11:52:54,574][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-30 11:52:54,578][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-30 11:52:54,579][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-30 11:52:54,580][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-30 11:52:54,581][__main__][INFO] - Instantiating loggers...
[2022-11-30 11:52:54,581][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-30 11:52:54,581][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-30 11:52:55,494][__main__][INFO] - Starting training!
[2022-11-30 12:42:27,827][__main__][INFO] - Starting testing!
[2022-11-30 12:43:23,190][__main__][INFO] - Best ckpt path: /home/fubao/dev/my-ndc/logs/train/runs/2022-11-30_11-52-53/checkpoints/epoch_002.ckpt
[2022-11-30 12:43:23,193][src.utils.utils][INFO] - Closing loggers...
[2022-11-30 12:43:23,195][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-11-30_11-52-53
[2022-11-30 12:43:23,195][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-11-30 15:43:41,703][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-30 15:43:41,711][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-30 15:43:41,712][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-30 15:43:41,801][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-11-30 15:43:42,462][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-11-30 15:43:42,496][__main__][INFO] - Instantiating callbacks...
[2022-11-30 15:43:42,496][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-30 15:43:42,500][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-30 15:43:42,501][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-30 15:43:42,502][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-30 15:43:42,503][__main__][INFO] - Instantiating loggers...
[2022-11-30 15:43:42,503][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-30 15:43:42,504][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-30 15:43:43,423][__main__][INFO] - Starting training!
[2022-11-30 15:43:53,858][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 98, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 648, in _call_and_handle_interrupt
    return self.strategy.launcher.launch(trainer_fn, *args, trainer=self, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 103, in launch
    mp.start_processes(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 198, in start_processes
    while not context.join():
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 160, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 7 terminated with the following error:
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 69, in _wrap
    fn(i, *args)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 129, in _wrapping_function
    results = function(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1112, in _run
    self._restore_modules_and_callbacks(ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1067, in _restore_modules_and_callbacks
    self._checkpoint_connector.restore_model()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/checkpoint_connector.py", line 182, in restore_model
    self.trainer.strategy.load_model_state_dict(self._loaded_checkpoint)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 343, in load_model_state_dict
    self.lightning_module.load_state_dict(checkpoint["state_dict"])
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1604, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for UNDCLitModule:
	Missing key(s) in state_dict: "net.pc_conv_out_float.weight", "net.pc_conv_out_float.bias". 

[2022-11-30 15:43:53,862][src.utils.utils][INFO] - Closing loggers...
[2022-11-30 15:44:51,484][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-30 15:44:51,491][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-30 15:44:51,491][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-30 15:44:51,558][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-11-30 15:44:52,124][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-11-30 15:44:52,156][__main__][INFO] - Instantiating callbacks...
[2022-11-30 15:44:52,156][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-30 15:44:52,160][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-30 15:44:52,161][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-30 15:44:52,162][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-30 15:44:52,163][__main__][INFO] - Instantiating loggers...
[2022-11-30 15:44:52,163][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-30 15:44:52,163][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-30 15:44:53,132][__main__][INFO] - Starting training!
[2022-11-30 15:45:06,987][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 98, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 648, in _call_and_handle_interrupt
    return self.strategy.launcher.launch(trainer_fn, *args, trainer=self, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 103, in launch
    mp.start_processes(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 198, in start_processes
    while not context.join():
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 160, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 4 terminated with the following error:
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torchmetrics/metric.py", line 395, in wrapped_func
    update(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torchmetrics/aggregation.py", line 359, in update
    self.value += (value * weight).sum()
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:4 and cpu!

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 69, in _wrap
    fn(i, *args)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 129, in _wrapping_function
    results = function(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_train
    self._run_sanity_check()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1345, in _run_sanity_check
    val_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 155, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 143, in advance
    output = self._evaluation_step(**kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 240, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1706, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/ddp_spawn.py", line 291, in validation_step
    return self.model(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1008, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 969, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/overrides/base.py", line 90, in forward
    return self.module.validation_step(*inputs, **kwargs)
  File "/home/fubao/dev/my-ndc/src/models/undc_module.py", line 142, in validation_step
    self.val_float_loss(float_loss)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torchmetrics/metric.py", line 245, in forward
    self._forward_cache = self._forward_reduce_state_update(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torchmetrics/metric.py", line 309, in _forward_reduce_state_update
    self.update(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torchmetrics/metric.py", line 398, in wrapped_func
    raise RuntimeError(
RuntimeError: Encountered different devices in metric calculation (see stacktrace for details). This could be due to the metric class not being on the same device as input. Instead of `metric=MeanMetric(...)` try to do `metric=MeanMetric(...).to(device)` where device corresponds to the device of the input.

[2022-11-30 15:45:06,991][src.utils.utils][INFO] - Closing loggers...
[2022-11-30 16:17:30,477][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-30 16:17:30,484][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-30 16:17:30,484][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-30 16:17:30,551][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-11-30 16:17:31,193][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-11-30 16:17:31,230][__main__][INFO] - Instantiating callbacks...
[2022-11-30 16:17:31,230][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-30 16:17:31,235][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-30 16:17:31,236][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-30 16:17:31,237][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-30 16:17:31,238][__main__][INFO] - Instantiating loggers...
[2022-11-30 16:17:31,238][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-30 16:17:31,238][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-30 16:17:32,133][__main__][INFO] - Starting training!
[2022-11-30 16:17:45,501][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 98, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 648, in _call_and_handle_interrupt
    return self.strategy.launcher.launch(trainer_fn, *args, trainer=self, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 103, in launch
    mp.start_processes(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 198, in start_processes
    while not context.join():
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 160, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 4 terminated with the following error:
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 69, in _wrap
    fn(i, *args)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 129, in _wrapping_function
    results = function(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_train
    self._run_sanity_check()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1345, in _run_sanity_check
    val_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 155, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 143, in advance
    output = self._evaluation_step(**kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 240, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1706, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/ddp_spawn.py", line 291, in validation_step
    return self.model(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1008, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 969, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/overrides/base.py", line 90, in forward
    return self.module.validation_step(*inputs, **kwargs)
  File "/home/fubao/dev/my-ndc/src/models/undc_module.py", line 149, in validation_step
    self.log("val/bool_loss", self.val_loss, on_step=False, on_epoch=True, prog_bar=True)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1207, in __getattr__
    raise AttributeError("'{}' object has no attribute '{}'".format(
AttributeError: 'UNDCLitModule' object has no attribute 'val_loss'

[2022-11-30 16:17:45,505][src.utils.utils][INFO] - Closing loggers...
[2022-11-30 17:28:09,408][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-30 17:28:09,416][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-30 17:28:09,416][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-30 17:28:09,510][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-11-30 17:28:10,149][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-11-30 17:28:10,184][__main__][INFO] - Instantiating callbacks...
[2022-11-30 17:28:10,185][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-30 17:28:10,189][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-30 17:28:10,190][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-30 17:28:10,191][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-30 17:28:10,192][__main__][INFO] - Instantiating loggers...
[2022-11-30 17:28:10,192][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-30 17:28:10,192][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-30 17:28:11,132][__main__][INFO] - Starting training!
[2022-11-30 17:28:26,704][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 98, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 648, in _call_and_handle_interrupt
    return self.strategy.launcher.launch(trainer_fn, *args, trainer=self, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 103, in launch
    mp.start_processes(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 198, in start_processes
    while not context.join():
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 160, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 7 terminated with the following error:
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 69, in _wrap
    fn(i, *args)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 129, in _wrapping_function
    results = function(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1285, in _run_train
    self.fit_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 195, in run
    self.on_run_start(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/fit_loop.py", line 222, in on_run_start
    self.trainer._call_lightning_module_hook("on_train_start")
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1552, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
  File "/home/fubao/dev/my-ndc/src/models/undc_module.py", line 62, in on_train_start
    self.val_acc_best.reset()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1207, in __getattr__
    raise AttributeError("'{}' object has no attribute '{}'".format(
AttributeError: 'UNDCLitModule' object has no attribute 'val_acc_best'

[2022-11-30 17:28:26,708][src.utils.utils][INFO] - Closing loggers...
[2022-11-30 17:29:44,448][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-30 17:29:44,455][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-30 17:29:44,456][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-30 17:29:44,524][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-11-30 17:29:45,104][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-11-30 17:29:45,137][__main__][INFO] - Instantiating callbacks...
[2022-11-30 17:29:45,138][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-30 17:29:45,142][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-30 17:29:45,143][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-30 17:29:45,144][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-30 17:29:45,144][__main__][INFO] - Instantiating loggers...
[2022-11-30 17:29:45,145][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-30 17:29:45,145][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-30 17:29:46,106][__main__][INFO] - Starting training!
[2022-11-30 17:45:07,289][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 98, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 648, in _call_and_handle_interrupt
    return self.strategy.launcher.launch(trainer_fn, *args, trainer=self, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 103, in launch
    mp.start_processes(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 198, in start_processes
    while not context.join():
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 160, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 6 terminated with the following error:
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 69, in _wrap
    fn(i, *args)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 129, in _wrapping_function
    results = function(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1285, in _run_train
    self.fit_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 201, in run
    self.on_advance_end()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/fit_loop.py", line 298, in on_advance_end
    self.trainer._call_callback_hooks("on_train_epoch_end")
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1599, in _call_callback_hooks
    fn(self, self.lightning_module, *args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/callbacks/early_stopping.py", line 183, in on_train_epoch_end
    self._run_early_stopping_check(trainer)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/callbacks/early_stopping.py", line 194, in _run_early_stopping_check
    if trainer.fast_dev_run or not self._validate_condition_metric(  # disable early_stopping with fast_dev_run
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/callbacks/early_stopping.py", line 149, in _validate_condition_metric
    raise RuntimeError(error_msg)
RuntimeError: Early stopping conditioned on metric `val/acc` which is not available. Pass in or modify your `EarlyStopping` callback to use any of the following: `val/bool_loss`, `val/bool_acc`, `val/float_loss`, `val/float_acc`, `val/acc_bool_best`, `val/acc_float_best`, `train/bool_loss`, `train/bool_acc`, `train/float_loss`, `train/float_acc`

[2022-11-30 17:45:07,296][src.utils.utils][INFO] - Closing loggers...
[2022-11-30 18:13:32,267][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-30 18:13:32,274][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-30 18:13:32,274][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-30 18:13:32,343][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-11-30 18:13:32,877][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-11-30 18:13:32,907][__main__][INFO] - Instantiating callbacks...
[2022-11-30 18:13:32,907][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-30 18:13:32,911][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-30 18:13:32,912][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-30 18:13:32,913][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-30 18:13:32,914][__main__][INFO] - Instantiating loggers...
[2022-11-30 18:13:32,914][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-30 18:13:32,914][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-30 18:13:33,874][__main__][INFO] - Starting training!
[2022-11-30 18:35:20,792][__main__][INFO] - Starting testing!
[2022-11-30 18:35:20,793][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2022-11-30 18:35:21,426][__main__][INFO] - Best ckpt path: None
[2022-11-30 18:35:21,429][src.utils.utils][INFO] - Closing loggers...
[2022-11-30 18:35:21,431][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-11-30_18-13-32
[2022-11-30 18:35:21,432][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-11-30 18:54:12,162][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-30 18:54:12,204][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-30 18:54:12,206][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-30 18:54:12,606][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-11-30 18:54:13,713][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-11-30 18:54:13,782][__main__][INFO] - Instantiating callbacks...
[2022-11-30 18:54:13,784][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-30 18:54:13,798][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-30 18:54:13,804][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-30 18:54:13,806][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-30 18:54:13,808][__main__][INFO] - Instantiating loggers...
[2022-11-30 18:54:13,809][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-30 18:54:13,809][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-30 18:54:16,248][__main__][INFO] - Starting training!
[2022-11-30 18:54:16,262][src.datamodules.undc_pc_datamodule][INFO] - Loading Train dataset...
[2022-11-30 18:54:16,272][src.datamodules.undc_pc_datamodule][INFO] - Train dataset [ABC_pc_hdf5] of size 8560 had been created.
[2022-11-30 18:54:16,272][src.datamodules.undc_pc_datamodule][INFO] - Loading Val dataset...
[2022-11-30 18:54:16,274][src.datamodules.undc_pc_datamodule][INFO] - Val dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-11-30 18:54:16,275][src.datamodules.undc_pc_datamodule][INFO] - Loading Test dataset...
[2022-11-30 18:54:16,277][src.datamodules.undc_pc_datamodule][INFO] - Test dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-11-30 18:57:57,666][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-30 18:57:57,702][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-30 18:57:57,703][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-30 18:57:58,123][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-11-30 18:57:59,324][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-11-30 18:57:59,415][__main__][INFO] - Instantiating callbacks...
[2022-11-30 18:57:59,417][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-30 18:57:59,435][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-30 18:57:59,445][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-30 18:57:59,450][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-30 18:57:59,453][__main__][INFO] - Instantiating loggers...
[2022-11-30 18:57:59,454][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-30 18:57:59,455][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-30 18:58:01,813][__main__][INFO] - Starting training!
[2022-11-30 18:58:01,830][src.datamodules.undc_pc_datamodule][INFO] - Loading Train dataset...
[2022-11-30 18:58:01,839][src.datamodules.undc_pc_datamodule][INFO] - Train dataset [ABC_pc_hdf5] of size 8560 had been created.
[2022-11-30 18:58:01,839][src.datamodules.undc_pc_datamodule][INFO] - Loading Val dataset...
[2022-11-30 18:58:01,841][src.datamodules.undc_pc_datamodule][INFO] - Val dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-11-30 18:58:01,842][src.datamodules.undc_pc_datamodule][INFO] - Loading Test dataset...
[2022-11-30 18:58:01,844][src.datamodules.undc_pc_datamodule][INFO] - Test dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-11-30 19:01:24,357][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-11-30 19:01:24,364][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-11-30 19:01:24,364][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-11-30 19:01:24,431][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-11-30 19:01:25,024][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-11-30 19:01:25,054][__main__][INFO] - Instantiating callbacks...
[2022-11-30 19:01:25,055][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-11-30 19:01:25,058][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-11-30 19:01:25,060][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-11-30 19:01:25,061][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-11-30 19:01:25,061][__main__][INFO] - Instantiating loggers...
[2022-11-30 19:01:25,062][src.utils.utils][WARNING] - Logger config is empty.
[2022-11-30 19:01:25,062][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-11-30 19:01:25,978][__main__][INFO] - Starting training!
[2022-11-30 19:44:16,731][__main__][INFO] - Starting testing!
[2022-11-30 19:45:13,708][__main__][INFO] - Best ckpt path: /home/fubao/dev/my-ndc/logs/train/runs/2022-11-30_19-01-24/checkpoints/epoch_002.ckpt
[2022-11-30 19:45:13,713][src.utils.utils][INFO] - Closing loggers...
[2022-11-30 19:45:13,716][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-11-30_19-01-24
[2022-11-30 19:45:13,717][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-12-01 17:41:14,294][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-01 17:41:14,301][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-01 17:41:14,302][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-01 17:41:14,371][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-01 17:41:14,945][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-12-01 17:41:14,976][__main__][INFO] - Instantiating callbacks...
[2022-12-01 17:41:14,977][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-01 17:41:14,981][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-01 17:41:14,982][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-01 17:41:14,983][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-01 17:41:14,983][__main__][INFO] - Instantiating loggers...
[2022-12-01 17:41:14,984][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-01 17:41:14,984][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-01 17:41:15,936][__main__][INFO] - Starting training!
[2022-12-01 17:41:30,046][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 98, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 648, in _call_and_handle_interrupt
    return self.strategy.launcher.launch(trainer_fn, *args, trainer=self, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 103, in launch
    mp.start_processes(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 198, in start_processes
    while not context.join():
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 160, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 4 terminated with the following error:
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 69, in _wrap
    fn(i, *args)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 129, in _wrapping_function
    results = function(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_train
    self._run_sanity_check()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1345, in _run_sanity_check
    val_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 155, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 143, in advance
    output = self._evaluation_step(**kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 240, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1706, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/ddp_spawn.py", line 291, in validation_step
    return self.model(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1008, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 969, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/overrides/base.py", line 90, in forward
    return self.module.validation_step(*inputs, **kwargs)
  File "/home/fubao/dev/my-ndc/src/models/undc_module.py", line 152, in validation_step
    voxel_xyz_int_np = voxel_xyz_int_[0].numpy()
TypeError: can't convert cuda:4 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.

[2022-12-01 17:41:30,050][src.utils.utils][INFO] - Closing loggers...
[2022-12-01 17:42:11,296][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-01 17:42:11,303][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-01 17:42:11,303][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-01 17:42:11,389][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-01 17:42:12,046][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-12-01 17:42:12,084][__main__][INFO] - Instantiating callbacks...
[2022-12-01 17:42:12,084][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-01 17:42:12,088][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-01 17:42:12,090][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-01 17:42:12,091][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-01 17:42:12,092][__main__][INFO] - Instantiating loggers...
[2022-12-01 17:42:12,092][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-01 17:42:12,092][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-01 17:42:13,068][__main__][INFO] - Starting training!
[2022-12-01 17:42:27,337][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 98, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 648, in _call_and_handle_interrupt
    return self.strategy.launcher.launch(trainer_fn, *args, trainer=self, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 103, in launch
    mp.start_processes(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 198, in start_processes
    while not context.join():
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 160, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 1 terminated with the following error:
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 69, in _wrap
    fn(i, *args)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 129, in _wrapping_function
    results = function(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_train
    self._run_sanity_check()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1345, in _run_sanity_check
    val_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 155, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 143, in advance
    output = self._evaluation_step(**kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 240, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1706, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/ddp_spawn.py", line 291, in validation_step
    return self.model(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1008, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 969, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/overrides/base.py", line 90, in forward
    return self.module.validation_step(*inputs, **kwargs)
  File "/home/fubao/dev/my-ndc/src/models/undc_module.py", line 158, in validation_step
    self.generate_obj_test(voxel_xyz_int_np,gt_output_bool_np,gt_output_float_np,batch_idx,"gt")
  File "/home/fubao/dev/my-ndc/src/models/undc_module.py", line 257, in generate_obj_test
    if not os.path.exists({self.hparams.out_dir}/{batch_index}):
TypeError: unsupported operand type(s) for /: 'set' and 'set'

[2022-12-01 17:42:27,347][src.utils.utils][INFO] - Closing loggers...
[2022-12-01 17:43:57,036][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-01 17:43:57,044][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-01 17:43:57,044][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-01 17:43:57,113][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-01 17:43:57,757][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-12-01 17:43:57,788][__main__][INFO] - Instantiating callbacks...
[2022-12-01 17:43:57,788][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-01 17:43:57,792][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-01 17:43:57,793][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-01 17:43:57,794][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-01 17:43:57,795][__main__][INFO] - Instantiating loggers...
[2022-12-01 17:43:57,795][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-01 17:43:57,795][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-01 17:43:58,736][__main__][INFO] - Starting training!
[2022-12-01 17:44:13,163][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 98, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 648, in _call_and_handle_interrupt
    return self.strategy.launcher.launch(trainer_fn, *args, trainer=self, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 103, in launch
    mp.start_processes(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 198, in start_processes
    while not context.join():
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 160, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 1 terminated with the following error:
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 69, in _wrap
    fn(i, *args)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 129, in _wrapping_function
    results = function(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_train
    self._run_sanity_check()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1345, in _run_sanity_check
    val_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 155, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 143, in advance
    output = self._evaluation_step(**kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 240, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1706, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/ddp_spawn.py", line 291, in validation_step
    return self.model(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1008, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 969, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/overrides/base.py", line 90, in forward
    return self.module.validation_step(*inputs, **kwargs)
  File "/home/fubao/dev/my-ndc/src/models/undc_module.py", line 158, in validation_step
    self.generate_obj_test(voxel_xyz_int_np,gt_output_bool_np,gt_output_float_np,batch_idx,"gt")
  File "/home/fubao/dev/my-ndc/src/models/undc_module.py", line 257, in generate_obj_test
    if not os.path.exists({self.hparams.out_dir}/{batch_index}):
TypeError: unsupported operand type(s) for /: 'set' and 'set'

[2022-12-01 17:44:13,167][src.utils.utils][INFO] - Closing loggers...
[2022-12-01 17:44:47,225][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-01 17:44:47,232][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-01 17:44:47,232][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-01 17:44:47,300][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-01 17:44:47,903][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-12-01 17:44:47,934][__main__][INFO] - Instantiating callbacks...
[2022-12-01 17:44:47,935][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-01 17:44:47,939][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-01 17:44:47,940][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-01 17:44:47,941][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-01 17:44:47,941][__main__][INFO] - Instantiating loggers...
[2022-12-01 17:44:47,942][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-01 17:44:47,942][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-01 17:44:48,900][__main__][INFO] - Starting training!
[2022-12-01 18:56:06,681][__main__][INFO] - Starting testing!
[2022-12-01 18:57:03,144][__main__][INFO] - Best ckpt path: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-01_17-44-47/checkpoints/epoch_002.ckpt
[2022-12-01 18:57:03,149][src.utils.utils][INFO] - Closing loggers...
[2022-12-01 18:57:03,151][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-01_17-44-47
[2022-12-01 18:57:03,152][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-12-01 19:00:02,608][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-01 19:00:02,615][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-01 19:00:02,615][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-01 19:00:02,684][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-01 19:00:03,321][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-12-01 19:00:03,353][__main__][INFO] - Instantiating callbacks...
[2022-12-01 19:00:03,353][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-01 19:00:03,357][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-01 19:00:03,359][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-01 19:00:03,359][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-01 19:00:03,360][__main__][INFO] - Instantiating loggers...
[2022-12-01 19:00:03,360][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-01 19:00:03,361][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-01 19:00:04,297][__main__][INFO] - Starting training!
[2022-12-01 19:29:29,688][__main__][INFO] - Starting testing!
[2022-12-01 19:32:58,508][__main__][INFO] - Best ckpt path: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-01_19-00-02/checkpoints/epoch_001.ckpt
[2022-12-01 19:32:58,512][src.utils.utils][INFO] - Closing loggers...
[2022-12-01 19:32:58,514][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-01_19-00-02
[2022-12-01 19:32:58,514][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-12-01 19:43:47,213][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-01 19:43:47,222][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-01 19:43:47,223][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-01 19:43:47,302][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-01 19:43:47,918][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-12-01 19:43:47,952][__main__][INFO] - Instantiating callbacks...
[2022-12-01 19:43:47,953][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-01 19:43:47,957][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-01 19:43:47,958][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-01 19:43:47,959][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-01 19:43:47,960][__main__][INFO] - Instantiating loggers...
[2022-12-01 19:43:47,960][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-01 19:43:47,961][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-01 19:43:48,899][__main__][INFO] - Starting training!
[2022-12-01 19:44:03,280][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 98, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 648, in _call_and_handle_interrupt
    return self.strategy.launcher.launch(trainer_fn, *args, trainer=self, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 103, in launch
    mp.start_processes(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 198, in start_processes
    while not context.join():
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 160, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 3 terminated with the following error:
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 69, in _wrap
    fn(i, *args)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 129, in _wrapping_function
    results = function(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_train
    self._run_sanity_check()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1345, in _run_sanity_check
    val_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 207, in run
    output = self.on_run_end()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 183, in on_run_end
    self._evaluation_epoch_end(self._outputs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 293, in _evaluation_epoch_end
    self.trainer._call_lightning_module_hook(hook_name, output_or_outputs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1552, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
  File "/home/fubao/dev/my-ndc/src/models/undc_module.py", line 166, in validation_epoch_end
    _, batch, pred_bool, pred_float = outputs
ValueError: not enough values to unpack (expected 4, got 2)

[2022-12-01 19:44:03,287][src.utils.utils][INFO] - Closing loggers...
[2022-12-01 19:50:12,741][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-01 19:50:12,747][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-01 19:50:12,748][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-01 19:50:12,817][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-01 19:50:13,364][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-12-01 19:50:13,396][__main__][INFO] - Instantiating callbacks...
[2022-12-01 19:50:13,396][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-01 19:50:13,400][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-01 19:50:13,401][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-01 19:50:13,402][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-01 19:50:13,403][__main__][INFO] - Instantiating loggers...
[2022-12-01 19:50:13,403][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-01 19:50:13,403][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-01 19:50:14,369][__main__][INFO] - Starting training!
[2022-12-01 19:50:28,643][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 98, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 648, in _call_and_handle_interrupt
    return self.strategy.launcher.launch(trainer_fn, *args, trainer=self, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 103, in launch
    mp.start_processes(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 198, in start_processes
    while not context.join():
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 160, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 3 terminated with the following error:
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 69, in _wrap
    fn(i, *args)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 129, in _wrapping_function
    results = function(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_train
    self._run_sanity_check()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1345, in _run_sanity_check
    val_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 207, in run
    output = self.on_run_end()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 183, in on_run_end
    self._evaluation_epoch_end(self._outputs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 293, in _evaluation_epoch_end
    self.trainer._call_lightning_module_hook(hook_name, output_or_outputs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1552, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
  File "/home/fubao/dev/my-ndc/src/models/undc_module.py", line 165, in validation_epoch_end
    batch = outputs["batch"]
TypeError: list indices must be integers or slices, not str

[2022-12-01 19:50:28,647][src.utils.utils][INFO] - Closing loggers...
[2022-12-01 19:51:30,707][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-01 19:51:30,738][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-01 19:51:30,739][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-01 19:51:31,033][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-01 19:51:32,195][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-12-01 19:51:32,256][__main__][INFO] - Instantiating callbacks...
[2022-12-01 19:51:32,257][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-01 19:51:32,273][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-01 19:51:32,279][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-01 19:51:32,283][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-01 19:51:32,285][__main__][INFO] - Instantiating loggers...
[2022-12-01 19:51:32,286][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-01 19:51:32,286][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-01 19:51:34,511][__main__][INFO] - Starting training!
[2022-12-01 19:51:34,519][src.datamodules.undc_pc_datamodule][INFO] - Loading Train dataset...
[2022-12-01 19:51:34,526][src.datamodules.undc_pc_datamodule][INFO] - Train dataset [ABC_pc_hdf5] of size 8560 had been created.
[2022-12-01 19:51:34,526][src.datamodules.undc_pc_datamodule][INFO] - Loading Val dataset...
[2022-12-01 19:51:34,528][src.datamodules.undc_pc_datamodule][INFO] - Val dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-12-01 19:51:34,529][src.datamodules.undc_pc_datamodule][INFO] - Loading Test dataset...
[2022-12-01 19:51:34,531][src.datamodules.undc_pc_datamodule][INFO] - Test dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-12-01 19:52:08,559][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-01 19:52:08,566][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-01 19:52:08,566][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-01 19:52:08,635][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-01 19:52:09,295][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-12-01 19:52:09,330][__main__][INFO] - Instantiating callbacks...
[2022-12-01 19:52:09,330][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-01 19:52:09,334][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-01 19:52:09,336][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-01 19:52:09,337][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-01 19:52:09,337][__main__][INFO] - Instantiating loggers...
[2022-12-01 19:52:09,338][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-01 19:52:09,338][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-01 19:52:10,339][__main__][INFO] - Starting training!
[2022-12-01 19:52:24,836][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 98, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 648, in _call_and_handle_interrupt
    return self.strategy.launcher.launch(trainer_fn, *args, trainer=self, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 103, in launch
    mp.start_processes(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 198, in start_processes
    while not context.join():
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 160, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 5 terminated with the following error:
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 69, in _wrap
    fn(i, *args)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 129, in _wrapping_function
    results = function(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_train
    self._run_sanity_check()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1345, in _run_sanity_check
    val_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 207, in run
    output = self.on_run_end()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 183, in on_run_end
    self._evaluation_epoch_end(self._outputs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 293, in _evaluation_epoch_end
    self.trainer._call_lightning_module_hook(hook_name, output_or_outputs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1552, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
  File "/home/fubao/dev/my-ndc/src/models/undc_module.py", line 178, in validation_epoch_end
    self.generate_obj_test(voxel_xyz_int_np,gt_output_bool_np,gt_output_float_np,"gt")
TypeError: generate_obj_test() missing 1 required positional argument: 'name'

[2022-12-01 19:52:24,840][src.utils.utils][INFO] - Closing loggers...
[2022-12-01 19:52:42,595][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-01 19:52:42,609][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-01 19:52:42,609][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-01 19:52:42,707][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-01 19:52:43,339][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-12-01 19:52:43,374][__main__][INFO] - Instantiating callbacks...
[2022-12-01 19:52:43,375][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-01 19:52:43,379][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-01 19:52:43,380][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-01 19:52:43,381][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-01 19:52:43,382][__main__][INFO] - Instantiating loggers...
[2022-12-01 19:52:43,382][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-01 19:52:43,383][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-01 19:52:44,308][__main__][INFO] - Starting training!
[2022-12-01 20:14:01,539][__main__][INFO] - Starting testing!
[2022-12-01 20:14:01,540][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2022-12-01 20:14:02,508][__main__][INFO] - Best ckpt path: None
[2022-12-01 20:14:02,514][src.utils.utils][INFO] - Closing loggers...
[2022-12-01 20:14:02,517][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-01_19-52-42
[2022-12-01 20:14:02,518][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-12-01 21:16:59,412][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-01 21:16:59,420][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-01 21:16:59,421][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-01 21:16:59,490][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-01 21:17:00,107][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-12-01 21:17:00,139][__main__][INFO] - Instantiating callbacks...
[2022-12-01 21:17:00,140][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-01 21:17:00,144][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-01 21:17:00,145][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-01 21:17:00,146][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-01 21:17:00,146][__main__][INFO] - Instantiating loggers...
[2022-12-01 21:17:00,147][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-01 21:17:00,147][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-01 21:17:00,939][__main__][INFO] - Starting training!
[2022-12-01 21:18:13,220][__main__][INFO] - Starting testing!
[2022-12-01 21:18:13,221][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2022-12-01 21:18:13,871][__main__][INFO] - Best ckpt path: None
[2022-12-01 21:18:13,876][src.utils.utils][INFO] - Closing loggers...
[2022-12-01 21:18:13,879][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-01_21-16-59
[2022-12-01 21:18:13,880][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-12-01 21:18:18,944][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-01 21:18:18,951][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-01 21:18:18,951][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-01 21:18:19,022][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-01 21:18:19,636][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-12-01 21:18:19,668][__main__][INFO] - Instantiating callbacks...
[2022-12-01 21:18:19,668][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-01 21:18:19,672][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-01 21:18:19,674][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-01 21:18:19,675][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-01 21:18:19,675][__main__][INFO] - Instantiating loggers...
[2022-12-01 21:18:19,676][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-01 21:18:19,676][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-01 21:18:20,482][__main__][INFO] - Starting training!
[2022-12-01 21:18:50,876][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 98, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 648, in _call_and_handle_interrupt
    return self.strategy.launcher.launch(trainer_fn, *args, trainer=self, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 103, in launch
    mp.start_processes(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 198, in start_processes
    while not context.join():
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 160, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 0 terminated with the following error:
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1163, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/multiprocessing/queues.py", line 107, in get
    if not self._poll(timeout):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/multiprocessing/connection.py", line 257, in poll
    return self._poll(timeout)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/multiprocessing/connection.py", line 424, in _poll
    r = wait([self], timeout)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/multiprocessing/connection.py", line 931, in wait
    ready = selector.select(timeout)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/signal_handling.py", line 66, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 28443) is killed by signal: Interrupt. 

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 69, in _wrap
    fn(i, *args)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 129, in _wrapping_function
    results = function(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_train
    self._run_sanity_check()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1345, in _run_sanity_check
    val_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 155, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 127, in advance
    batch = next(data_fetcher)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 185, in __next__
    return self.fetching_function()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 264, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 278, in _fetch_next_batch
    batch = next(iterator)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 681, in __next__
    data = self._next_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1359, in _next_data
    idx, data = self._get_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1325, in _get_data
    success, data = self._try_get_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1176, in _try_get_data
    raise RuntimeError('DataLoader worker (pid(s) {}) exited unexpectedly'.format(pids_str)) from e
RuntimeError: DataLoader worker (pid(s) 28443) exited unexpectedly

[2022-12-01 21:18:50,882][src.utils.utils][INFO] - Closing loggers...
[2022-12-01 21:21:22,250][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-01 21:21:22,257][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-01 21:21:22,257][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-01 21:21:22,329][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-01 21:21:22,925][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
TypeError: __init__() got an unexpected keyword argument 'net_bool'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 69, in train
    datamodule: LightningDataModule = hydra.utils.instantiate(cfg.datamodule)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 339, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule':
TypeError("__init__() got an unexpected keyword argument 'net_bool'")
full_key: datamodule
[2022-12-01 21:21:22,927][src.utils.utils][INFO] - Closing loggers...
[2022-12-01 21:26:58,119][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-01 21:26:58,126][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-01 21:26:58,126][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-01 21:26:58,194][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-01 21:26:58,816][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-12-01 21:26:58,845][__main__][INFO] - Instantiating callbacks...
[2022-12-01 21:26:58,846][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-01 21:26:58,849][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-01 21:26:58,851][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-01 21:26:58,851][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-01 21:26:58,852][__main__][INFO] - Instantiating loggers...
[2022-12-01 21:26:58,852][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-01 21:26:58,853][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-01 21:26:59,723][__main__][INFO] - Starting training!
[2022-12-01 22:21:28,915][__main__][INFO] - Starting testing!
[2022-12-01 22:23:14,164][__main__][INFO] - Best ckpt path: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-01_21-26-58/checkpoints/epoch_001.ckpt
[2022-12-01 22:23:14,167][src.utils.utils][INFO] - Closing loggers...
[2022-12-01 22:23:14,169][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-01_21-26-58
[2022-12-01 22:23:14,169][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-12-02 13:11:10,224][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-02 13:11:10,232][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-02 13:11:10,232][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-02 13:11:10,301][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-02 13:11:11,038][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-12-02 13:11:11,068][__main__][INFO] - Instantiating callbacks...
[2022-12-02 13:11:11,068][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-02 13:11:11,072][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-02 13:11:11,073][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-02 13:11:11,074][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-02 13:11:11,075][__main__][INFO] - Instantiating loggers...
[2022-12-02 13:11:11,075][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-02 13:11:11,076][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-02 13:11:11,920][__main__][INFO] - Starting training!
[2022-12-02 19:08:16,955][__main__][INFO] - Starting testing!
[2022-12-02 19:08:16,956][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2022-12-02 19:08:17,914][__main__][INFO] - Best ckpt path: None
[2022-12-02 19:08:17,923][src.utils.utils][INFO] - Closing loggers...
[2022-12-02 19:08:17,928][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-02_13-11-10
[2022-12-02 19:08:17,932][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-12-02 19:10:13,415][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-02 19:10:13,422][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-02 19:10:13,423][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-02 19:10:13,505][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-02 19:10:14,154][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-12-02 19:10:14,185][__main__][INFO] - Instantiating callbacks...
[2022-12-02 19:10:14,186][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-02 19:10:14,189][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-02 19:10:14,191][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-02 19:10:14,192][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-02 19:10:14,192][__main__][INFO] - Instantiating loggers...
[2022-12-02 19:10:14,193][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-02 19:10:14,193][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-02 19:10:14,983][__main__][INFO] - Starting training!
[2022-12-02 19:12:04,218][__main__][INFO] - Starting testing!
[2022-12-02 19:12:04,218][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2022-12-02 19:12:04,923][__main__][INFO] - Best ckpt path: None
[2022-12-02 19:12:04,928][src.utils.utils][INFO] - Closing loggers...
[2022-12-02 19:12:04,931][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-02_19-10-13
[2022-12-02 19:12:04,932][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-12-02 19:13:01,927][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-02 19:13:01,934][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-02 19:13:01,934][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-02 19:13:02,002][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-02 19:13:02,574][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-12-02 19:13:02,603][__main__][INFO] - Instantiating callbacks...
[2022-12-02 19:13:02,604][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-02 19:13:02,607][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-02 19:13:02,609][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-02 19:13:02,610][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-02 19:13:02,610][__main__][INFO] - Instantiating loggers...
[2022-12-02 19:13:02,611][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-02 19:13:02,611][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-02 19:13:03,403][__main__][INFO] - Starting training!
[2022-12-02 19:13:34,633][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 98, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 648, in _call_and_handle_interrupt
    return self.strategy.launcher.launch(trainer_fn, *args, trainer=self, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 103, in launch
    mp.start_processes(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 198, in start_processes
    while not context.join():
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 160, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 4 terminated with the following error:
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1163, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/queue.py", line 179, in get
    self.not_empty.wait(remaining)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/threading.py", line 306, in wait
    gotit = waiter.acquire(True, timeout)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/signal_handling.py", line 66, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 19484) is killed by signal: Interrupt. 

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 69, in _wrap
    fn(i, *args)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 129, in _wrapping_function
    results = function(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_train
    self._run_sanity_check()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1345, in _run_sanity_check
    val_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 155, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 127, in advance
    batch = next(data_fetcher)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 185, in __next__
    return self.fetching_function()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 264, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 278, in _fetch_next_batch
    batch = next(iterator)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 681, in __next__
    data = self._next_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1359, in _next_data
    idx, data = self._get_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1315, in _get_data
    success, data = self._try_get_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1176, in _try_get_data
    raise RuntimeError('DataLoader worker (pid(s) {}) exited unexpectedly'.format(pids_str)) from e
RuntimeError: DataLoader worker (pid(s) 19484) exited unexpectedly

[2022-12-02 19:13:34,640][src.utils.utils][INFO] - Closing loggers...
[2022-12-02 19:13:43,526][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-02 19:13:43,541][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-02 19:13:43,541][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-02 19:13:43,640][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-02 19:13:44,265][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-12-02 19:13:44,294][__main__][INFO] - Instantiating callbacks...
[2022-12-02 19:13:44,295][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-02 19:13:44,299][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-02 19:13:44,300][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-02 19:13:44,301][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-02 19:13:44,301][__main__][INFO] - Instantiating loggers...
[2022-12-02 19:13:44,302][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-02 19:13:44,302][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-02 19:13:45,173][__main__][INFO] - Starting training!
[2022-12-02 20:44:13,962][__main__][INFO] - Starting testing!
[2022-12-02 20:44:13,964][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2022-12-02 20:44:15,682][__main__][INFO] - Best ckpt path: None
[2022-12-02 20:44:15,687][src.utils.utils][INFO] - Closing loggers...
[2022-12-02 20:44:15,690][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-02_19-13-43
[2022-12-02 20:44:15,691][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-12-02 20:45:10,340][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-02 20:45:10,348][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-02 20:45:10,348][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-02 20:45:10,442][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-02 20:45:11,170][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-12-02 20:45:11,232][__main__][INFO] - Instantiating callbacks...
[2022-12-02 20:45:11,233][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-02 20:45:11,241][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-02 20:45:11,244][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-02 20:45:11,245][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-02 20:45:11,246][__main__][INFO] - Instantiating loggers...
[2022-12-02 20:45:11,247][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-02 20:45:11,247][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-02 20:45:12,065][__main__][INFO] - Starting training!
[2022-12-03 04:14:17,620][__main__][INFO] - Starting testing!
[2022-12-03 04:15:59,812][__main__][INFO] - Best ckpt path: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-02_20-45-10/checkpoints/epoch_023.ckpt
[2022-12-03 04:15:59,818][src.utils.utils][INFO] - Closing loggers...
[2022-12-03 04:15:59,819][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-02_20-45-10
[2022-12-03 04:15:59,820][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-12-03 18:38:08,018][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-03 18:38:08,026][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-03 18:38:08,027][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-03 18:38:08,095][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-03 18:38:08,696][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-12-03 18:38:08,725][__main__][INFO] - Instantiating callbacks...
[2022-12-03 18:38:08,725][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-03 18:38:08,729][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-03 18:38:08,730][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-03 18:38:08,731][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-03 18:38:08,732][__main__][INFO] - Instantiating loggers...
[2022-12-03 18:38:08,732][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-03 18:38:08,732][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-03 18:38:09,556][__main__][INFO] - Starting training!
[2022-12-03 18:38:09,701][src.datamodules.undc_pc_datamodule][INFO] - Loading Train dataset...
[2022-12-03 18:38:09,706][src.datamodules.undc_pc_datamodule][INFO] - Train dataset [ABC_pc_hdf5] of size 8560 had been created.
[2022-12-03 18:38:09,706][src.datamodules.undc_pc_datamodule][INFO] - Loading Val dataset...
[2022-12-03 18:38:09,708][src.datamodules.undc_pc_datamodule][INFO] - Val dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-12-03 18:38:09,708][src.datamodules.undc_pc_datamodule][INFO] - Loading Test dataset...
[2022-12-03 18:38:09,710][src.datamodules.undc_pc_datamodule][INFO] - Test dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-12-03 18:38:30,736][__main__][INFO] - Starting testing!
[2022-12-03 18:38:31,514][__main__][INFO] - Best ckpt path: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-02_13-11-10/checkpoints/epoch_011.ckpt
[2022-12-03 18:38:31,518][src.utils.utils][INFO] - Closing loggers...
[2022-12-03 18:38:31,520][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-03_18-38-07
[2022-12-03 18:38:31,521][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-12-03 18:38:42,111][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-03 18:38:42,127][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-03 18:38:42,128][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-03 18:38:42,250][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-03 18:38:42,902][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-12-03 18:38:42,934][__main__][INFO] - Instantiating callbacks...
[2022-12-03 18:38:42,935][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-03 18:38:42,939][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-03 18:38:42,940][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-03 18:38:42,941][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-03 18:38:42,942][__main__][INFO] - Instantiating loggers...
[2022-12-03 18:38:42,942][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-03 18:38:42,943][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-03 18:38:43,745][__main__][INFO] - Starting training!
[2022-12-03 18:38:43,880][src.datamodules.undc_pc_datamodule][INFO] - Loading Train dataset...
[2022-12-03 18:38:43,882][src.datamodules.undc_pc_datamodule][INFO] - Train dataset [ABC_pc_hdf5] of size 8560 had been created.
[2022-12-03 18:38:43,882][src.datamodules.undc_pc_datamodule][INFO] - Loading Val dataset...
[2022-12-03 18:38:43,884][src.datamodules.undc_pc_datamodule][INFO] - Val dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-12-03 18:38:43,884][src.datamodules.undc_pc_datamodule][INFO] - Loading Test dataset...
[2022-12-03 18:38:43,885][src.datamodules.undc_pc_datamodule][INFO] - Test dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-12-03 18:39:29,905][__main__][INFO] - Starting testing!
[2022-12-03 18:39:37,977][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1163, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/queue.py", line 178, in get
    raise Empty
_queue.Empty

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 108, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 864, in test
    return self._call_and_handle_interrupt(self._test_impl, model, dataloaders, ckpt_path, verbose, datamodule)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 911, in _test_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1251, in _run_stage
    return self._run_evaluate()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1297, in _run_evaluate
    eval_loop_results = self._evaluation_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 155, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 127, in advance
    batch = next(data_fetcher)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 185, in __next__
    return self.fetching_function()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 264, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 278, in _fetch_next_batch
    batch = next(iterator)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 681, in __next__
    data = self._next_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1359, in _next_data
    idx, data = self._get_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1315, in _get_data
    success, data = self._try_get_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1176, in _try_get_data
    raise RuntimeError('DataLoader worker (pid(s) {}) exited unexpectedly'.format(pids_str)) from e
RuntimeError: DataLoader worker (pid(s) 5445, 5446, 5447, 5448, 5449, 5450, 5452, 5456, 5459, 5460, 5461, 5462, 5463, 5464, 5465, 5466, 5467, 5472, 5473, 5474, 5480, 5481, 5482, 5483) exited unexpectedly
[2022-12-03 18:39:37,987][src.utils.utils][INFO] - Closing loggers...
[2022-12-03 19:08:39,240][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-03 19:08:39,247][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-03 19:08:39,248][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-03 19:08:39,317][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-03 19:08:40,000][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-12-03 19:08:40,040][__main__][INFO] - Instantiating callbacks...
[2022-12-03 19:08:40,040][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-03 19:08:40,044][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-03 19:08:40,046][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-03 19:08:40,047][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-03 19:08:40,047][__main__][INFO] - Instantiating loggers...
[2022-12-03 19:08:40,048][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-03 19:08:40,048][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-03 19:08:40,898][__main__][INFO] - Starting training!
[2022-12-04 05:06:17,039][__main__][INFO] - Starting testing!
[2022-12-04 05:08:02,805][__main__][INFO] - Best ckpt path: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-03_19-08-39/checkpoints/epoch_024.ckpt
[2022-12-04 05:08:02,810][src.utils.utils][INFO] - Closing loggers...
[2022-12-04 05:08:02,812][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-03_19-08-39
[2022-12-04 05:08:02,813][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-12-06 12:53:33,118][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-06 12:53:33,153][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-06 12:53:33,154][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-06 12:53:33,616][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-06 12:53:35,291][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-12-06 12:53:35,391][__main__][INFO] - Instantiating callbacks...
[2022-12-06 12:53:35,393][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-06 12:53:35,409][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-06 12:53:35,415][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-06 12:53:35,417][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-06 12:53:35,419][__main__][INFO] - Instantiating loggers...
[2022-12-06 12:53:35,419][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-06 12:53:35,420][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-06 12:53:37,418][__main__][INFO] - Starting training!
[2022-12-06 12:53:37,432][src.datamodules.undc_pc_datamodule][INFO] - Loading Train dataset...
[2022-12-06 12:53:37,447][src.datamodules.undc_pc_datamodule][INFO] - Train dataset [ABC_pc_hdf5] of size 8560 had been created.
[2022-12-06 12:53:37,448][src.datamodules.undc_pc_datamodule][INFO] - Loading Val dataset...
[2022-12-06 12:53:37,452][src.datamodules.undc_pc_datamodule][INFO] - Val dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-12-06 12:53:37,453][src.datamodules.undc_pc_datamodule][INFO] - Loading Test dataset...
[2022-12-06 12:53:37,456][src.datamodules.undc_pc_datamodule][INFO] - Test dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-12-07 18:51:52,047][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-07 18:51:52,054][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-07 18:51:52,055][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-07 18:51:52,123][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-07 18:51:52,800][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-12-07 18:51:52,846][__main__][INFO] - Instantiating callbacks...
[2022-12-07 18:51:52,846][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-07 18:51:52,850][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-07 18:51:52,851][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-07 18:51:52,852][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-07 18:51:52,853][__main__][INFO] - Instantiating loggers...
[2022-12-07 18:51:52,853][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-07 18:51:52,853][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-07 18:51:53,638][__main__][INFO] - Starting training!
[2022-12-07 18:55:44,283][__main__][INFO] - Starting testing!
[2022-12-07 18:55:44,285][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2022-12-07 18:55:45,174][__main__][INFO] - Best ckpt path: None
[2022-12-07 18:55:45,178][src.utils.utils][INFO] - Closing loggers...
[2022-12-07 18:55:45,180][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-07_18-51-51
[2022-12-07 18:55:45,180][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-12-07 18:56:10,948][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-07 18:56:10,955][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-07 18:56:10,956][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-07 18:56:11,029][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-07 18:56:11,696][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-12-07 18:56:11,726][__main__][INFO] - Instantiating callbacks...
[2022-12-07 18:56:11,726][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-07 18:56:11,730][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-07 18:56:11,731][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-07 18:56:11,732][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-07 18:56:11,733][__main__][INFO] - Instantiating loggers...
[2022-12-07 18:56:11,733][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-07 18:56:11,733][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-07 18:56:12,457][__main__][INFO] - Starting training!
[2022-12-07 18:56:12,586][src.datamodules.undc_pc_datamodule][INFO] - Loading Train dataset...
[2022-12-07 18:56:12,589][src.datamodules.undc_pc_datamodule][INFO] - Train dataset [ABC_pc_hdf5] of size 8560 had been created.
[2022-12-07 18:56:12,590][src.datamodules.undc_pc_datamodule][INFO] - Loading Val dataset...
[2022-12-07 18:56:12,591][src.datamodules.undc_pc_datamodule][INFO] - Val dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-12-07 18:56:12,591][src.datamodules.undc_pc_datamodule][INFO] - Loading Test dataset...
[2022-12-07 18:56:12,592][src.datamodules.undc_pc_datamodule][INFO] - Test dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-12-07 18:58:02,204][__main__][INFO] - Starting testing!
[2022-12-07 18:58:03,642][__main__][INFO] - Best ckpt path: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-02_13-11-10/checkpoints/epoch_011.ckpt
[2022-12-07 18:58:03,649][src.utils.utils][INFO] - Closing loggers...
[2022-12-07 18:58:03,652][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-07_18-56-10
[2022-12-07 18:58:03,653][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-12-07 19:11:54,944][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-07 19:11:54,954][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-07 19:11:54,954][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-07 19:11:55,064][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-07 19:11:55,702][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-12-07 19:11:55,733][__main__][INFO] - Instantiating callbacks...
[2022-12-07 19:11:55,734][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-07 19:11:55,742][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-07 19:11:55,745][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-07 19:11:55,747][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-07 19:11:55,748][__main__][INFO] - Instantiating loggers...
[2022-12-07 19:11:55,748][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-07 19:11:55,749][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-07 19:11:56,623][__main__][INFO] - Starting training!
[2022-12-07 19:12:09,047][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 98, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 648, in _call_and_handle_interrupt
    return self.strategy.launcher.launch(trainer_fn, *args, trainer=self, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 103, in launch
    mp.start_processes(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 198, in start_processes
    while not context.join():
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 160, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 6 terminated with the following error:
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 69, in _wrap
    fn(i, *args)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 129, in _wrapping_function
    results = function(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1112, in _run
    self._restore_modules_and_callbacks(ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1065, in _restore_modules_and_callbacks
    self._checkpoint_connector.resume_start(checkpoint_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/checkpoint_connector.py", line 85, in resume_start
    self._loaded_checkpoint = self._load_and_validate_checkpoint(checkpoint_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/checkpoint_connector.py", line 89, in _load_and_validate_checkpoint
    loaded_checkpoint = self.trainer.strategy.load_checkpoint(checkpoint_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 339, in load_checkpoint
    return self.checkpoint_io.load_checkpoint(checkpoint_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/plugins/io/torch_plugin.py", line 83, in load_checkpoint
    raise FileNotFoundError(f"Checkpoint at {path} not found. Aborting training.")
FileNotFoundError: Checkpoint at /home/fubao/dev/my-ndc/logs/train/runs/2022-12-02_13-11-10/checkpoints/epoch_011.ckpt not found. Aborting training.

[2022-12-07 19:12:09,051][src.utils.utils][INFO] - Closing loggers...
[2022-12-07 19:12:26,290][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-07 19:12:26,298][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-07 19:12:26,298][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-07 19:12:26,368][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-07 19:12:26,979][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-12-07 19:12:27,008][__main__][INFO] - Instantiating callbacks...
[2022-12-07 19:12:27,009][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-07 19:12:27,013][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-07 19:12:27,014][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-07 19:12:27,015][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-07 19:12:27,016][__main__][INFO] - Instantiating loggers...
[2022-12-07 19:12:27,016][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-07 19:12:27,017][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-07 19:12:27,772][__main__][INFO] - Starting training!
[2022-12-07 19:13:01,921][__main__][INFO] - Starting testing!
[2022-12-07 19:13:01,926][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2022-12-07 19:13:02,847][__main__][INFO] - Best ckpt path: None
[2022-12-07 19:13:02,855][src.utils.utils][INFO] - Closing loggers...
[2022-12-07 19:13:02,858][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-07_19-12-26
[2022-12-07 19:13:02,866][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-12-07 19:13:23,864][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-07 19:13:23,873][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-07 19:13:23,874][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-07 19:13:23,944][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-07 19:13:24,526][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-12-07 19:13:24,555][__main__][INFO] - Instantiating callbacks...
[2022-12-07 19:13:24,556][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-07 19:13:24,559][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-07 19:13:24,561][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-07 19:13:24,562][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-07 19:13:24,562][__main__][INFO] - Instantiating loggers...
[2022-12-07 19:13:24,562][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-07 19:13:24,563][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-07 19:13:25,334][__main__][INFO] - Starting training!
[2022-12-07 19:14:17,663][__main__][INFO] - Starting testing!
[2022-12-07 19:14:17,664][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2022-12-07 19:14:17,740][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 108, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 864, in test
    return self._call_and_handle_interrupt(self._test_impl, model, dataloaders, ckpt_path, verbose, datamodule)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 648, in _call_and_handle_interrupt
    return self.strategy.launcher.launch(trainer_fn, *args, trainer=self, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 103, in launch
    mp.start_processes(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 189, in start_processes
    process.start()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/multiprocessing/process.py", line 121, in start
    self._popen = self._Popen(self)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/multiprocessing/context.py", line 284, in _Popen
    return Popen(process_obj)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/multiprocessing/popen_spawn_posix.py", line 32, in __init__
    super().__init__(process_obj)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/multiprocessing/popen_spawn_posix.py", line 58, in _launch
    self.pid = util.spawnv_passfds(spawn.get_executable(),
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/multiprocessing/util.py", line 452, in spawnv_passfds
    return _posixsubprocess.fork_exec(
BlockingIOError: [Errno 11] Resource temporarily unavailable
[2022-12-07 19:14:17,747][src.utils.utils][INFO] - Closing loggers...
[2022-12-07 19:14:29,294][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-07 19:14:29,301][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-07 19:14:29,301][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-07 19:14:29,368][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-07 19:14:30,037][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-12-07 19:14:30,068][__main__][INFO] - Instantiating callbacks...
[2022-12-07 19:14:30,068][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-07 19:14:30,073][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-07 19:14:30,074][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-07 19:14:30,075][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-07 19:14:30,076][__main__][INFO] - Instantiating loggers...
[2022-12-07 19:14:30,076][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-07 19:14:30,076][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-07 19:14:30,835][__main__][INFO] - Starting training!
[2022-12-07 19:14:31,020][src.datamodules.undc_pc_datamodule][INFO] - Loading Train dataset...
[2022-12-07 19:14:31,023][src.datamodules.undc_pc_datamodule][INFO] - Train dataset [ABC_pc_hdf5] of size 8560 had been created.
[2022-12-07 19:14:31,023][src.datamodules.undc_pc_datamodule][INFO] - Loading Val dataset...
[2022-12-07 19:14:31,024][src.datamodules.undc_pc_datamodule][INFO] - Val dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-12-07 19:14:31,025][src.datamodules.undc_pc_datamodule][INFO] - Loading Test dataset...
[2022-12-07 19:14:31,026][src.datamodules.undc_pc_datamodule][INFO] - Test dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-12-07 19:14:40,977][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 98, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_train
    self._run_sanity_check()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1345, in _run_sanity_check
    val_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 155, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 143, in advance
    output = self._evaluation_step(**kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 240, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1706, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 370, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/home/fubao/dev/my-ndc/src/models/undc_module.py", line 159, in validation_step
    self.gen_obj(batch, pred_bool, pred_float, batch_idx)
  File "/home/fubao/dev/my-ndc/src/models/undc_module.py", line 244, in gen_obj
    pc_KNN_idx_, pc_KNN_xyz_, voxel_xyz_int_, voxel_KNN_idx_, voxel_KNN_xyz_, gt_output_bool_, gt_output_float_, gt_output_float_mask_ = batch
ValueError: too many values to unpack (expected 8)
[2022-12-07 19:14:40,984][src.utils.utils][INFO] - Closing loggers...
[2022-12-07 19:18:43,422][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-07 19:18:43,437][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-07 19:18:43,438][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-07 19:18:43,545][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-07 19:18:44,127][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-12-07 19:18:44,159][__main__][INFO] - Instantiating callbacks...
[2022-12-07 19:18:44,159][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-07 19:18:44,163][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-07 19:18:44,165][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-07 19:18:44,166][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-07 19:18:44,166][__main__][INFO] - Instantiating loggers...
[2022-12-07 19:18:44,167][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-07 19:18:44,167][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-07 19:18:44,928][__main__][INFO] - Starting training!
[2022-12-07 19:19:03,047][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 98, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 648, in _call_and_handle_interrupt
    return self.strategy.launcher.launch(trainer_fn, *args, trainer=self, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 103, in launch
    mp.start_processes(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 198, in start_processes
    while not context.join():
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 160, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 3 terminated with the following error:
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 69, in _wrap
    fn(i, *args)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 129, in _wrapping_function
    results = function(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_train
    self._run_sanity_check()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1345, in _run_sanity_check
    val_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 155, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 143, in advance
    output = self._evaluation_step(**kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 240, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1706, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/ddp_spawn.py", line 291, in validation_step
    return self.model(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1008, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 969, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/overrides/base.py", line 90, in forward
    return self.module.validation_step(*inputs, **kwargs)
  File "/home/fubao/dev/my-ndc/src/models/undc_module.py", line 159, in validation_step
    self.gen_obj(batch, pred_bool, pred_float, batch_idx)
  File "/home/fubao/dev/my-ndc/src/models/undc_module.py", line 244, in gen_obj
    pc_KNN_idx_, pc_KNN_xyz_, voxel_xyz_int_, voxel_KNN_idx_, voxel_KNN_xyz_, \
ValueError: too many values to unpack (expected 8)

[2022-12-07 19:19:03,053][src.utils.utils][INFO] - Closing loggers...
[2022-12-07 19:22:33,075][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-07 19:22:33,083][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-07 19:22:33,083][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-07 19:22:33,177][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-07 19:22:33,823][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-12-07 19:22:33,855][__main__][INFO] - Instantiating callbacks...
[2022-12-07 19:22:33,856][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-07 19:22:33,859][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-07 19:22:33,861][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-07 19:22:33,862][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-07 19:22:33,862][__main__][INFO] - Instantiating loggers...
[2022-12-07 19:22:33,863][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-07 19:22:33,863][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-07 19:22:34,649][__main__][INFO] - Starting training!
[2022-12-07 19:30:06,982][__main__][INFO] - Starting testing!
[2022-12-07 19:30:06,983][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2022-12-07 19:30:07,895][__main__][INFO] - Best ckpt path: None
[2022-12-07 19:30:07,928][src.utils.utils][INFO] - Closing loggers...
[2022-12-07 19:30:07,931][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-07_19-22-32
[2022-12-07 19:30:07,932][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-12-07 19:30:21,408][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-07 19:30:21,416][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-07 19:30:21,416][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-07 19:30:21,485][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-07 19:30:22,192][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-12-07 19:30:22,221][__main__][INFO] - Instantiating callbacks...
[2022-12-07 19:30:22,222][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-07 19:30:22,226][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-07 19:30:22,227][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-07 19:30:22,228][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-07 19:30:22,229][__main__][INFO] - Instantiating loggers...
[2022-12-07 19:30:22,229][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-07 19:30:22,229][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-07 19:30:23,029][__main__][INFO] - Starting training!
[2022-12-07 19:30:23,189][src.datamodules.undc_pc_datamodule][INFO] - Loading Train dataset...
[2022-12-07 19:30:23,191][src.datamodules.undc_pc_datamodule][INFO] - Train dataset [ABC_pc_hdf5] of size 8560 had been created.
[2022-12-07 19:30:23,192][src.datamodules.undc_pc_datamodule][INFO] - Loading Val dataset...
[2022-12-07 19:30:23,193][src.datamodules.undc_pc_datamodule][INFO] - Val dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-12-07 19:30:23,193][src.datamodules.undc_pc_datamodule][INFO] - Loading Test dataset...
[2022-12-07 19:30:23,194][src.datamodules.undc_pc_datamodule][INFO] - Test dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-12-07 19:31:31,841][__main__][INFO] - Starting testing!
[2022-12-07 19:31:31,845][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2022-12-07 19:31:35,552][__main__][INFO] - Best ckpt path: None
[2022-12-07 19:31:35,559][src.utils.utils][INFO] - Closing loggers...
[2022-12-07 19:31:35,562][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-07_19-30-21
[2022-12-07 19:31:35,564][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-12-07 19:51:57,604][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-07 19:51:57,612][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-07 19:51:57,612][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-07 19:51:57,681][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-07 19:51:58,295][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-12-07 19:51:58,328][__main__][INFO] - Instantiating callbacks...
[2022-12-07 19:51:58,328][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-07 19:51:58,332][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-07 19:51:58,333][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-07 19:51:58,334][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-07 19:51:58,335][__main__][INFO] - Instantiating loggers...
[2022-12-07 19:51:58,335][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-07 19:51:58,335][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-07 19:51:59,223][__main__][INFO] - Starting training!
[2022-12-07 19:52:22,015][__main__][INFO] - Starting testing!
[2022-12-07 19:52:22,081][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2022-12-07 19:52:22,479][__main__][INFO] - Best ckpt path: None
[2022-12-07 19:52:22,485][src.utils.utils][INFO] - Closing loggers...
[2022-12-07 19:52:22,488][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-07_19-51-57
[2022-12-07 19:52:22,489][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-12-07 19:52:39,385][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-07 19:52:39,392][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-07 19:52:39,393][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-07 19:52:39,463][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-07 19:52:40,097][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-12-07 19:52:40,126][__main__][INFO] - Instantiating callbacks...
[2022-12-07 19:52:40,126][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-07 19:52:40,130][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-07 19:52:40,132][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-07 19:52:40,133][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-07 19:52:40,133][__main__][INFO] - Instantiating loggers...
[2022-12-07 19:52:40,134][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-07 19:52:40,134][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-07 19:52:40,883][__main__][INFO] - Starting training!
[2022-12-07 21:23:38,002][__main__][INFO] - Starting testing!
[2022-12-07 21:23:38,003][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2022-12-07 21:23:41,813][__main__][INFO] - Best ckpt path: None
[2022-12-07 21:23:41,818][src.utils.utils][INFO] - Closing loggers...
[2022-12-07 21:23:41,821][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-07_19-52-39
[2022-12-07 21:23:41,822][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-12-07 21:27:07,923][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-07 21:27:07,930][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-07 21:27:07,930][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-07 21:27:08,000][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-07 21:27:08,630][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-12-07 21:27:08,659][__main__][INFO] - Instantiating callbacks...
[2022-12-07 21:27:08,659][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-07 21:27:08,663][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-07 21:27:08,665][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-07 21:27:08,665][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-07 21:27:08,666][__main__][INFO] - Instantiating loggers...
[2022-12-07 21:27:08,666][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-07 21:27:08,667][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-07 21:27:09,435][__main__][INFO] - Starting training!
[2022-12-07 22:01:22,083][__main__][INFO] - Starting testing!
[2022-12-07 22:01:22,084][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2022-12-07 22:01:22,858][__main__][INFO] - Best ckpt path: None
[2022-12-07 22:01:22,863][src.utils.utils][INFO] - Closing loggers...
[2022-12-07 22:01:22,867][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-07_21-27-07
[2022-12-07 22:01:22,868][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-12-07 22:10:35,232][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-07 22:10:35,240][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-07 22:10:35,240][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-07 22:10:35,313][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-07 22:10:36,005][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-12-07 22:10:36,037][__main__][INFO] - Instantiating callbacks...
[2022-12-07 22:10:36,037][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-07 22:10:36,041][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-07 22:10:36,042][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-07 22:10:36,043][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-07 22:10:36,044][__main__][INFO] - Instantiating loggers...
[2022-12-07 22:10:36,045][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-07 22:10:36,045][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-07 22:10:36,788][__main__][INFO] - Starting training!
[2022-12-07 22:21:32,365][__main__][INFO] - Starting testing!
[2022-12-07 22:21:32,366][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2022-12-07 22:21:33,544][__main__][INFO] - Best ckpt path: None
[2022-12-07 22:21:33,551][src.utils.utils][INFO] - Closing loggers...
[2022-12-07 22:21:33,553][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-07_22-10-35
[2022-12-07 22:21:33,554][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-12-07 22:21:43,191][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-07 22:21:43,199][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-07 22:21:43,199][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-07 22:21:43,272][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-07 22:21:43,895][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-12-07 22:21:43,929][__main__][INFO] - Instantiating callbacks...
[2022-12-07 22:21:43,929][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-07 22:21:43,933][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-07 22:21:43,934][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-07 22:21:43,935][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-07 22:21:43,936][__main__][INFO] - Instantiating loggers...
[2022-12-07 22:21:43,936][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-07 22:21:43,936][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-07 22:21:44,723][__main__][INFO] - Starting training!
[2022-12-07 22:23:48,351][__main__][INFO] - Starting testing!
[2022-12-07 22:23:48,352][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2022-12-07 22:23:49,029][__main__][INFO] - Best ckpt path: None
[2022-12-07 22:23:49,034][src.utils.utils][INFO] - Closing loggers...
[2022-12-07 22:23:49,037][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-07_22-21-43
[2022-12-07 22:23:49,037][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-12-07 22:23:56,937][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-07 22:23:56,953][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-07 22:23:56,954][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-07 22:23:57,097][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-07 22:23:57,775][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-12-07 22:23:57,805][__main__][INFO] - Instantiating callbacks...
[2022-12-07 22:23:57,806][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-07 22:23:57,810][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-07 22:23:57,811][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-07 22:23:57,812][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-07 22:23:57,813][__main__][INFO] - Instantiating loggers...
[2022-12-07 22:23:57,813][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-07 22:23:57,813][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-07 22:23:59,085][__main__][INFO] - Starting training!
[2022-12-07 22:25:14,079][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 98, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 648, in _call_and_handle_interrupt
    return self.strategy.launcher.launch(trainer_fn, *args, trainer=self, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 103, in launch
    mp.start_processes(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 198, in start_processes
    while not context.join():
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 160, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 0 terminated with the following error:
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 69, in _wrap
    fn(i, *args)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 129, in _wrapping_function
    results = function(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1285, in _run_train
    self.fit_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/fit_loop.py", line 270, in advance
    self._outputs = self.epoch_loop.run(self._data_fetcher)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 203, in advance
    batch_output = self.batch_loop.run(kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 87, in advance
    outputs = self.optimizer_loop.run(optimizers, kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 201, in advance
    result = self._run_optimization(kwargs, self._optimizers[self.optim_progress.optimizer_position])
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 248, in _run_optimization
    self._optimizer_step(optimizer, opt_idx, kwargs.get("batch_idx", 0), closure)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 358, in _optimizer_step
    self.trainer._call_lightning_module_hook(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1552, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/core/module.py", line 1666, in optimizer_step
    optimizer.step(closure=optimizer_closure)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/core/optimizer.py", line 168, in step
    step_output = self._strategy.optimizer_step(self._optimizer, self._optimizer_idx, closure, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 216, in optimizer_step
    return self.precision_plugin.optimizer_step(model, optimizer, opt_idx, closure, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/plugins/precision/precision_plugin.py", line 153, in optimizer_step
    return optimizer.step(closure=closure, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/optim/optimizer.py", line 113, in wrapper
    return func(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/optim/sgd.py", line 125, in step
    loss = closure()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/plugins/precision/precision_plugin.py", line 138, in _wrap_closure
    closure_result = closure()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 146, in __call__
    self._result = self.closure(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 141, in closure
    self._backward_fn(step_output.closure_loss)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 304, in backward_fn
    self.trainer._call_strategy_hook("backward", loss, optimizer, opt_idx)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1706, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 191, in backward
    self.precision_plugin.backward(self.lightning_module, closure_loss, optimizer, optimizer_idx, *args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/plugins/precision/precision_plugin.py", line 80, in backward
    model.backward(closure_loss, optimizer, optimizer_idx, *args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/core/module.py", line 1411, in backward
    loss.backward(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/_tensor.py", line 396, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/autograd/__init__.py", line 173, in backward
    Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
RuntimeError: CUDA out of memory. Tried to allocate 30.00 MiB (GPU 0; 23.88 GiB total capacity; 1.08 GiB already allocated; 36.44 MiB free; 1.16 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF

[2022-12-07 22:25:14,083][src.utils.utils][INFO] - Closing loggers...
[2022-12-07 22:30:08,340][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-07 22:30:08,346][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-07 22:30:08,347][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-07 22:30:08,409][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-07 22:30:09,131][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-12-07 22:30:09,165][__main__][INFO] - Instantiating callbacks...
[2022-12-07 22:30:09,165][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-07 22:30:09,169][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-07 22:30:09,171][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-07 22:30:09,172][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-07 22:30:09,173][__main__][INFO] - Instantiating loggers...
[2022-12-07 22:30:09,173][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-07 22:30:09,173][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-07 22:30:49,397][__main__][INFO] - Starting training!
[2022-12-08 02:34:22,985][__main__][INFO] - Starting testing!
[2022-12-08 02:35:34,699][__main__][INFO] - Best ckpt path: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-07_22-30-08/checkpoints/epoch_006.ckpt
[2022-12-08 02:35:34,702][src.utils.utils][INFO] - Closing loggers...
[2022-12-08 02:35:34,704][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-07_22-30-08
[2022-12-08 02:35:34,704][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-12-08 10:13:58,617][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-08 10:13:58,624][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-08 10:13:58,625][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-08 10:13:58,700][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-08 10:13:59,284][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-12-08 10:13:59,319][__main__][INFO] - Instantiating callbacks...
[2022-12-08 10:13:59,320][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-08 10:13:59,324][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-08 10:13:59,326][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-08 10:13:59,326][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-08 10:13:59,327][__main__][INFO] - Instantiating loggers...
[2022-12-08 10:13:59,327][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-08 10:13:59,328][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-08 10:14:39,509][__main__][INFO] - Starting training!
[2022-12-08 10:14:45,256][src.datamodules.undc_pc_datamodule][INFO] - Loading Train dataset...
[2022-12-08 10:14:45,261][src.datamodules.undc_pc_datamodule][INFO] - Train dataset [ABC_pc_hdf5] of size 8560 had been created.
[2022-12-08 10:14:45,261][src.datamodules.undc_pc_datamodule][INFO] - Loading Val dataset...
[2022-12-08 10:14:45,263][src.datamodules.undc_pc_datamodule][INFO] - Val dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-12-08 10:14:45,263][src.datamodules.undc_pc_datamodule][INFO] - Loading Test dataset...
[2022-12-08 10:14:45,264][src.datamodules.undc_pc_datamodule][INFO] - Test dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-12-08 10:14:55,910][__main__][INFO] - Starting testing!
[2022-12-08 10:14:55,911][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2022-12-08 10:14:57,575][__main__][INFO] - Best ckpt path: None
[2022-12-08 10:14:57,579][src.utils.utils][INFO] - Closing loggers...
[2022-12-08 10:14:57,580][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-08_10-13-58
[2022-12-08 10:14:57,581][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-12-08 10:18:55,246][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-08 10:18:55,252][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-08 10:18:55,253][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-08 10:18:55,334][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-08 10:18:56,082][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-12-08 10:18:56,115][__main__][INFO] - Instantiating callbacks...
[2022-12-08 10:18:56,116][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-08 10:18:56,120][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-08 10:18:56,122][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-08 10:18:56,122][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-08 10:18:56,123][__main__][INFO] - Instantiating loggers...
[2022-12-08 10:18:56,124][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-08 10:18:56,124][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-08 10:19:36,437][__main__][INFO] - Starting training!
[2022-12-08 10:20:06,128][__main__][INFO] - Starting testing!
[2022-12-08 10:20:06,128][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2022-12-08 10:20:06,579][__main__][INFO] - Best ckpt path: None
[2022-12-08 10:20:06,585][src.utils.utils][INFO] - Closing loggers...
[2022-12-08 10:20:06,588][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-08_10-18-55
[2022-12-08 10:20:06,589][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-12-08 10:20:26,833][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-08 10:20:26,839][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-08 10:20:26,840][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-08 10:20:26,903][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-08 10:20:27,535][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-12-08 10:20:27,564][__main__][INFO] - Instantiating callbacks...
[2022-12-08 10:20:27,565][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-08 10:20:27,568][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-08 10:20:27,570][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-08 10:20:27,571][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-08 10:20:27,571][__main__][INFO] - Instantiating loggers...
[2022-12-08 10:20:27,572][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-08 10:20:27,572][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-08 10:21:08,731][__main__][INFO] - Starting training!
[2022-12-08 10:28:00,747][__main__][INFO] - Starting testing!
[2022-12-08 10:28:00,747][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2022-12-08 10:28:01,403][__main__][INFO] - Best ckpt path: None
[2022-12-08 10:28:01,408][src.utils.utils][INFO] - Closing loggers...
[2022-12-08 10:28:01,410][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-08_10-20-26
[2022-12-08 10:28:01,411][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-12-08 10:28:42,811][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-08 10:28:42,823][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-08 10:28:42,824][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-08 10:28:42,918][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-08 10:28:43,538][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-12-08 10:28:43,569][__main__][INFO] - Instantiating callbacks...
[2022-12-08 10:28:43,569][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-08 10:28:43,573][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-08 10:28:43,575][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-08 10:28:43,575][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-08 10:28:43,576][__main__][INFO] - Instantiating loggers...
[2022-12-08 10:28:43,576][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-08 10:28:43,577][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-08 10:28:44,602][__main__][INFO] - Starting training!
[2022-12-08 10:30:22,044][__main__][INFO] - Starting testing!
[2022-12-08 10:30:22,044][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2022-12-08 10:30:22,470][__main__][INFO] - Best ckpt path: None
[2022-12-08 10:30:22,477][src.utils.utils][INFO] - Closing loggers...
[2022-12-08 10:30:22,481][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-08_10-28-42
[2022-12-08 10:30:22,483][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-12-08 15:25:21,529][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-08 15:25:21,535][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-08 15:25:21,536][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-08 15:25:21,604][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-08 15:25:22,228][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-12-08 15:25:22,264][__main__][INFO] - Instantiating callbacks...
[2022-12-08 15:25:22,264][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-08 15:25:22,268][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-08 15:25:22,270][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-08 15:25:22,271][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-08 15:25:22,271][__main__][INFO] - Instantiating loggers...
[2022-12-08 15:25:22,272][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-08 15:25:22,272][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-08 15:25:23,328][__main__][INFO] - Starting training!
[2022-12-08 15:26:45,873][__main__][INFO] - Starting testing!
[2022-12-08 15:26:45,874][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2022-12-08 15:26:46,320][__main__][INFO] - Best ckpt path: None
[2022-12-08 15:26:46,324][src.utils.utils][INFO] - Closing loggers...
[2022-12-08 15:26:46,326][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-08_15-25-21
[2022-12-08 15:26:46,327][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-12-08 15:49:54,300][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-08 15:49:54,307][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-08 15:49:54,308][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-08 15:49:54,378][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-08 15:49:54,888][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-12-08 15:49:54,894][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
TypeError: __init__() got an unexpected keyword argument 'out_bool'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 72, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 334, in instantiate_node
    value = instantiate_node(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 339, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.models.components.undc_pc_net.local_pointnet':
TypeError("__init__() got an unexpected keyword argument 'out_bool'")
full_key: model.net
[2022-12-08 15:49:54,896][src.utils.utils][INFO] - Closing loggers...
[2022-12-08 15:50:51,628][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-08 15:50:51,635][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-08 15:50:51,636][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-08 15:50:51,706][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-08 15:50:52,275][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2022-12-08 15:50:52,283][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/utils.py", line 639, in _locate
    obj = getattr(obj, part)
AttributeError: module 'src.models.components' has no attribute 'undc_pc_net2'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/utils.py", line 645, in _locate
    obj = import_module(mod)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1014, in _gcd_import
  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 973, in _find_and_load_unlocked
ModuleNotFoundError: No module named 'src.models.components.undc_pc_net2'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/utils.py", line 648, in _locate
    raise ImportError(
ImportError: Error loading 'src.models.components.undc_pc_net2.local_pointnet':
ModuleNotFoundError("No module named 'src.models.components.undc_pc_net2'")
Are you sure that 'undc_pc_net2' is importable from module 'src.models.components'?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 72, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 334, in instantiate_node
    value = instantiate_node(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 325, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'src.models.components.undc_pc_net2.local_pointnet', see chained exception above.
full_key: model.net_bool
[2022-12-08 15:50:52,287][src.utils.utils][INFO] - Closing loggers...
[2022-12-08 15:53:23,765][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-08 15:53:23,772][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-08 15:53:23,772][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-08 15:53:23,841][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-08 15:53:24,446][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2022-12-08 15:53:24,559][__main__][INFO] - Instantiating callbacks...
[2022-12-08 15:53:24,560][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-08 15:53:24,564][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-08 15:53:24,567][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-08 15:53:24,567][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-08 15:53:24,568][__main__][INFO] - Instantiating loggers...
[2022-12-08 15:53:24,569][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-08 15:53:24,569][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-08 15:53:25,561][__main__][INFO] - Starting training!
[2022-12-08 16:01:04,527][__main__][INFO] - Starting testing!
[2022-12-08 16:01:04,528][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2022-12-08 16:01:05,259][__main__][INFO] - Best ckpt path: None
[2022-12-08 16:01:05,264][src.utils.utils][INFO] - Closing loggers...
[2022-12-08 16:01:05,266][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-08_15-53-23
[2022-12-08 16:01:05,267][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-12-08 16:02:39,192][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-08 16:02:39,199][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-08 16:02:39,200][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-08 16:02:39,267][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-08 16:02:39,847][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2022-12-08 16:02:39,939][__main__][INFO] - Instantiating callbacks...
[2022-12-08 16:02:39,940][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-08 16:02:39,944][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-08 16:02:39,946][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-08 16:02:39,947][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-08 16:02:39,948][__main__][INFO] - Instantiating loggers...
[2022-12-08 16:02:39,949][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-08 16:02:39,949][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-08 16:02:40,903][__main__][INFO] - Starting training!
[2022-12-08 16:38:03,269][__main__][INFO] - Starting testing!
[2022-12-08 16:38:03,270][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2022-12-08 16:38:03,977][__main__][INFO] - Best ckpt path: None
[2022-12-08 16:38:03,982][src.utils.utils][INFO] - Closing loggers...
[2022-12-08 16:38:03,984][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-08_16-02-39
[2022-12-08 16:38:03,985][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-12-08 16:39:39,121][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-08 16:39:39,128][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-08 16:39:39,128][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-08 16:39:39,196][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-08 16:39:39,831][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2022-12-08 16:39:42,528][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "/home/fubao/dev/my-ndc/src/models/undc_module2.py", line 42, in __init__
    self.net_bool.load_state_dict(torch.load(bool_ckpt))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1604, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for local_pointnet:
	Missing key(s) in state_dict: "pc_conv_0.linear_1.weight", "pc_conv_0.linear_1.bias", "pc_conv_0.linear_2.weight", "pc_conv_0.linear_2.bias", "pc_res_1.linear_1.weight", "pc_res_1.linear_1.bias", "pc_res_1.linear_2.weight", "pc_res_1.linear_2.bias", "pc_conv_1.linear_1.weight", "pc_conv_1.linear_1.bias", "pc_conv_1.linear_2.weight", "pc_conv_1.linear_2.bias", "pc_res_2.linear_1.weight", "pc_res_2.linear_1.bias", "pc_res_2.linear_2.weight", "pc_res_2.linear_2.bias", "pc_conv_2.linear_1.weight", "pc_conv_2.linear_1.bias", "pc_conv_2.linear_2.weight", "pc_conv_2.linear_2.bias", "pc_res_3.linear_1.weight", "pc_res_3.linear_1.bias", "pc_res_3.linear_2.weight", "pc_res_3.linear_2.bias", "pc_conv_3.linear_1.weight", "pc_conv_3.linear_1.bias", "pc_conv_3.linear_2.weight", "pc_conv_3.linear_2.bias", "pc_res_4.linear_1.weight", "pc_res_4.linear_1.bias", "pc_res_4.linear_2.weight", "pc_res_4.linear_2.bias", "pc_conv_4.linear_1.weight", "pc_conv_4.linear_1.bias", "pc_conv_4.linear_2.weight", "pc_conv_4.linear_2.bias", "pc_res_5.linear_1.weight", "pc_res_5.linear_1.bias", "pc_res_5.linear_2.weight", "pc_res_5.linear_2.bias", "pc_conv_5.linear_1.weight", "pc_conv_5.linear_1.bias", "pc_conv_5.linear_2.weight", "pc_conv_5.linear_2.bias", "pc_res_6.linear_1.weight", "pc_res_6.linear_1.bias", "pc_res_6.linear_2.weight", "pc_res_6.linear_2.bias", "pc_conv_6.linear_1.weight", "pc_conv_6.linear_1.bias", "pc_conv_6.linear_2.weight", "pc_conv_6.linear_2.bias", "pc_res_7.linear_1.weight", "pc_res_7.linear_1.bias", "pc_res_7.linear_2.weight", "pc_res_7.linear_2.bias", "conv_1.weight", "conv_1.bias", "conv_2.weight", "conv_2.bias", "conv_3.weight", "conv_3.bias", "conv_4.weight", "conv_4.bias", "conv_5.weight", "conv_5.bias", "pc_conv_out_bool.weight", "pc_conv_out_bool.bias", "pc_conv_out_float.weight", "pc_conv_out_float.bias". 
	Unexpected key(s) in state_dict: "epoch", "global_step", "pytorch-lightning_version", "state_dict", "loops", "callbacks", "optimizer_states", "lr_schedulers", "hparams_name", "hyper_parameters", "datamodule_hparams_name", "datamodule_hyper_parameters". 

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 72, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 339, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.models.undc_module2.UNDCLitModule':
RuntimeError('Error(s) in loading state_dict for local_pointnet:\n\tMissing key(s) in state_dict: "pc_conv_0.linear_1.weight", "pc_conv_0.linear_1.bias", "pc_conv_0.linear_2.weight", "pc_conv_0.linear_2.bias", "pc_res_1.linear_1.weight", "pc_res_1.linear_1.bias", "pc_res_1.linear_2.weight", "pc_res_1.linear_2.bias", "pc_conv_1.linear_1.weight", "pc_conv_1.linear_1.bias", "pc_conv_1.linear_2.weight", "pc_conv_1.linear_2.bias", "pc_res_2.linear_1.weight", "pc_res_2.linear_1.bias", "pc_res_2.linear_2.weight", "pc_res_2.linear_2.bias", "pc_conv_2.linear_1.weight", "pc_conv_2.linear_1.bias", "pc_conv_2.linear_2.weight", "pc_conv_2.linear_2.bias", "pc_res_3.linear_1.weight", "pc_res_3.linear_1.bias", "pc_res_3.linear_2.weight", "pc_res_3.linear_2.bias", "pc_conv_3.linear_1.weight", "pc_conv_3.linear_1.bias", "pc_conv_3.linear_2.weight", "pc_conv_3.linear_2.bias", "pc_res_4.linear_1.weight", "pc_res_4.linear_1.bias", "pc_res_4.linear_2.weight", "pc_res_4.linear_2.bias", "pc_conv_4.linear_1.weight", "pc_conv_4.linear_1.bias", "pc_conv_4.linear_2.weight", "pc_conv_4.linear_2.bias", "pc_res_5.linear_1.weight", "pc_res_5.linear_1.bias", "pc_res_5.linear_2.weight", "pc_res_5.linear_2.bias", "pc_conv_5.linear_1.weight", "pc_conv_5.linear_1.bias", "pc_conv_5.linear_2.weight", "pc_conv_5.linear_2.bias", "pc_res_6.linear_1.weight", "pc_res_6.linear_1.bias", "pc_res_6.linear_2.weight", "pc_res_6.linear_2.bias", "pc_conv_6.linear_1.weight", "pc_conv_6.linear_1.bias", "pc_conv_6.linear_2.weight", "pc_conv_6.linear_2.bias", "pc_res_7.linear_1.weight", "pc_res_7.linear_1.bias", "pc_res_7.linear_2.weight", "pc_res_7.linear_2.bias", "conv_1.weight", "conv_1.bias", "conv_2.weight", "conv_2.bias", "conv_3.weight", "conv_3.bias", "conv_4.weight", "conv_4.bias", "conv_5.weight", "conv_5.bias", "pc_conv_out_bool.weight", "pc_conv_out_bool.bias", "pc_conv_out_float.weight", "pc_conv_out_float.bias". \n\tUnexpected key(s) in state_dict: "epoch", "global_step", "pytorch-lightning_version", "state_dict", "loops", "callbacks", "optimizer_states", "lr_schedulers", "hparams_name", "hyper_parameters", "datamodule_hparams_name", "datamodule_hyper_parameters". ')
full_key: model
[2022-12-08 16:39:42,535][src.utils.utils][INFO] - Closing loggers...
[2022-12-08 16:40:33,781][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-08 16:40:33,788][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-08 16:40:33,789][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-08 16:40:33,873][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-08 16:40:34,442][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2022-12-08 16:40:37,134][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "/home/fubao/dev/my-ndc/src/models/undc_module2.py", line 42, in __init__
    self.net_bool.load_state_dict(torch.load(bool_ckpt))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1604, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for local_pointnet:
	Missing key(s) in state_dict: "pc_conv_0.linear_1.weight", "pc_conv_0.linear_1.bias", "pc_conv_0.linear_2.weight", "pc_conv_0.linear_2.bias", "pc_res_1.linear_1.weight", "pc_res_1.linear_1.bias", "pc_res_1.linear_2.weight", "pc_res_1.linear_2.bias", "pc_conv_1.linear_1.weight", "pc_conv_1.linear_1.bias", "pc_conv_1.linear_2.weight", "pc_conv_1.linear_2.bias", "pc_res_2.linear_1.weight", "pc_res_2.linear_1.bias", "pc_res_2.linear_2.weight", "pc_res_2.linear_2.bias", "pc_conv_2.linear_1.weight", "pc_conv_2.linear_1.bias", "pc_conv_2.linear_2.weight", "pc_conv_2.linear_2.bias", "pc_res_3.linear_1.weight", "pc_res_3.linear_1.bias", "pc_res_3.linear_2.weight", "pc_res_3.linear_2.bias", "pc_conv_3.linear_1.weight", "pc_conv_3.linear_1.bias", "pc_conv_3.linear_2.weight", "pc_conv_3.linear_2.bias", "pc_res_4.linear_1.weight", "pc_res_4.linear_1.bias", "pc_res_4.linear_2.weight", "pc_res_4.linear_2.bias", "pc_conv_4.linear_1.weight", "pc_conv_4.linear_1.bias", "pc_conv_4.linear_2.weight", "pc_conv_4.linear_2.bias", "pc_res_5.linear_1.weight", "pc_res_5.linear_1.bias", "pc_res_5.linear_2.weight", "pc_res_5.linear_2.bias", "pc_conv_5.linear_1.weight", "pc_conv_5.linear_1.bias", "pc_conv_5.linear_2.weight", "pc_conv_5.linear_2.bias", "pc_res_6.linear_1.weight", "pc_res_6.linear_1.bias", "pc_res_6.linear_2.weight", "pc_res_6.linear_2.bias", "pc_conv_6.linear_1.weight", "pc_conv_6.linear_1.bias", "pc_conv_6.linear_2.weight", "pc_conv_6.linear_2.bias", "pc_res_7.linear_1.weight", "pc_res_7.linear_1.bias", "pc_res_7.linear_2.weight", "pc_res_7.linear_2.bias", "conv_1.weight", "conv_1.bias", "conv_2.weight", "conv_2.bias", "conv_3.weight", "conv_3.bias", "conv_4.weight", "conv_4.bias", "conv_5.weight", "conv_5.bias", "pc_conv_out_bool.weight", "pc_conv_out_bool.bias", "pc_conv_out_float.weight", "pc_conv_out_float.bias". 
	Unexpected key(s) in state_dict: "epoch", "global_step", "pytorch-lightning_version", "state_dict", "loops", "callbacks", "optimizer_states", "lr_schedulers", "hparams_name", "hyper_parameters", "datamodule_hparams_name", "datamodule_hyper_parameters". 

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 72, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 339, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.models.undc_module2.UNDCLitModule':
RuntimeError('Error(s) in loading state_dict for local_pointnet:\n\tMissing key(s) in state_dict: "pc_conv_0.linear_1.weight", "pc_conv_0.linear_1.bias", "pc_conv_0.linear_2.weight", "pc_conv_0.linear_2.bias", "pc_res_1.linear_1.weight", "pc_res_1.linear_1.bias", "pc_res_1.linear_2.weight", "pc_res_1.linear_2.bias", "pc_conv_1.linear_1.weight", "pc_conv_1.linear_1.bias", "pc_conv_1.linear_2.weight", "pc_conv_1.linear_2.bias", "pc_res_2.linear_1.weight", "pc_res_2.linear_1.bias", "pc_res_2.linear_2.weight", "pc_res_2.linear_2.bias", "pc_conv_2.linear_1.weight", "pc_conv_2.linear_1.bias", "pc_conv_2.linear_2.weight", "pc_conv_2.linear_2.bias", "pc_res_3.linear_1.weight", "pc_res_3.linear_1.bias", "pc_res_3.linear_2.weight", "pc_res_3.linear_2.bias", "pc_conv_3.linear_1.weight", "pc_conv_3.linear_1.bias", "pc_conv_3.linear_2.weight", "pc_conv_3.linear_2.bias", "pc_res_4.linear_1.weight", "pc_res_4.linear_1.bias", "pc_res_4.linear_2.weight", "pc_res_4.linear_2.bias", "pc_conv_4.linear_1.weight", "pc_conv_4.linear_1.bias", "pc_conv_4.linear_2.weight", "pc_conv_4.linear_2.bias", "pc_res_5.linear_1.weight", "pc_res_5.linear_1.bias", "pc_res_5.linear_2.weight", "pc_res_5.linear_2.bias", "pc_conv_5.linear_1.weight", "pc_conv_5.linear_1.bias", "pc_conv_5.linear_2.weight", "pc_conv_5.linear_2.bias", "pc_res_6.linear_1.weight", "pc_res_6.linear_1.bias", "pc_res_6.linear_2.weight", "pc_res_6.linear_2.bias", "pc_conv_6.linear_1.weight", "pc_conv_6.linear_1.bias", "pc_conv_6.linear_2.weight", "pc_conv_6.linear_2.bias", "pc_res_7.linear_1.weight", "pc_res_7.linear_1.bias", "pc_res_7.linear_2.weight", "pc_res_7.linear_2.bias", "conv_1.weight", "conv_1.bias", "conv_2.weight", "conv_2.bias", "conv_3.weight", "conv_3.bias", "conv_4.weight", "conv_4.bias", "conv_5.weight", "conv_5.bias", "pc_conv_out_bool.weight", "pc_conv_out_bool.bias", "pc_conv_out_float.weight", "pc_conv_out_float.bias". \n\tUnexpected key(s) in state_dict: "epoch", "global_step", "pytorch-lightning_version", "state_dict", "loops", "callbacks", "optimizer_states", "lr_schedulers", "hparams_name", "hyper_parameters", "datamodule_hparams_name", "datamodule_hyper_parameters". ')
full_key: model
[2022-12-08 16:40:37,140][src.utils.utils][INFO] - Closing loggers...
[2022-12-08 16:42:53,300][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-08 16:42:53,308][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-08 16:42:53,308][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-08 16:42:53,378][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-08 16:42:53,999][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2022-12-08 16:42:56,588][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "/home/fubao/dev/my-ndc/src/models/undc_module2.py", line 42, in __init__
    self.net_bool.load_state_dict(torch.load(bool_ckpt))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1604, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for local_pointnet:
	Missing key(s) in state_dict: "pc_conv_0.linear_1.weight", "pc_conv_0.linear_1.bias", "pc_conv_0.linear_2.weight", "pc_conv_0.linear_2.bias", "pc_res_1.linear_1.weight", "pc_res_1.linear_1.bias", "pc_res_1.linear_2.weight", "pc_res_1.linear_2.bias", "pc_conv_1.linear_1.weight", "pc_conv_1.linear_1.bias", "pc_conv_1.linear_2.weight", "pc_conv_1.linear_2.bias", "pc_res_2.linear_1.weight", "pc_res_2.linear_1.bias", "pc_res_2.linear_2.weight", "pc_res_2.linear_2.bias", "pc_conv_2.linear_1.weight", "pc_conv_2.linear_1.bias", "pc_conv_2.linear_2.weight", "pc_conv_2.linear_2.bias", "pc_res_3.linear_1.weight", "pc_res_3.linear_1.bias", "pc_res_3.linear_2.weight", "pc_res_3.linear_2.bias", "pc_conv_3.linear_1.weight", "pc_conv_3.linear_1.bias", "pc_conv_3.linear_2.weight", "pc_conv_3.linear_2.bias", "pc_res_4.linear_1.weight", "pc_res_4.linear_1.bias", "pc_res_4.linear_2.weight", "pc_res_4.linear_2.bias", "pc_conv_4.linear_1.weight", "pc_conv_4.linear_1.bias", "pc_conv_4.linear_2.weight", "pc_conv_4.linear_2.bias", "pc_res_5.linear_1.weight", "pc_res_5.linear_1.bias", "pc_res_5.linear_2.weight", "pc_res_5.linear_2.bias", "pc_conv_5.linear_1.weight", "pc_conv_5.linear_1.bias", "pc_conv_5.linear_2.weight", "pc_conv_5.linear_2.bias", "pc_res_6.linear_1.weight", "pc_res_6.linear_1.bias", "pc_res_6.linear_2.weight", "pc_res_6.linear_2.bias", "pc_conv_6.linear_1.weight", "pc_conv_6.linear_1.bias", "pc_conv_6.linear_2.weight", "pc_conv_6.linear_2.bias", "pc_res_7.linear_1.weight", "pc_res_7.linear_1.bias", "pc_res_7.linear_2.weight", "pc_res_7.linear_2.bias", "conv_1.weight", "conv_1.bias", "conv_2.weight", "conv_2.bias", "conv_3.weight", "conv_3.bias", "conv_4.weight", "conv_4.bias", "conv_5.weight", "conv_5.bias", "pc_conv_out_bool.weight", "pc_conv_out_bool.bias", "pc_conv_out_float.weight", "pc_conv_out_float.bias". 
	Unexpected key(s) in state_dict: "epoch", "global_step", "pytorch-lightning_version", "state_dict", "loops", "callbacks", "optimizer_states", "lr_schedulers", "hparams_name", "hyper_parameters", "datamodule_hparams_name", "datamodule_hyper_parameters". 

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 72, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 339, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.models.undc_module2.UNDCLitModule':
RuntimeError('Error(s) in loading state_dict for local_pointnet:\n\tMissing key(s) in state_dict: "pc_conv_0.linear_1.weight", "pc_conv_0.linear_1.bias", "pc_conv_0.linear_2.weight", "pc_conv_0.linear_2.bias", "pc_res_1.linear_1.weight", "pc_res_1.linear_1.bias", "pc_res_1.linear_2.weight", "pc_res_1.linear_2.bias", "pc_conv_1.linear_1.weight", "pc_conv_1.linear_1.bias", "pc_conv_1.linear_2.weight", "pc_conv_1.linear_2.bias", "pc_res_2.linear_1.weight", "pc_res_2.linear_1.bias", "pc_res_2.linear_2.weight", "pc_res_2.linear_2.bias", "pc_conv_2.linear_1.weight", "pc_conv_2.linear_1.bias", "pc_conv_2.linear_2.weight", "pc_conv_2.linear_2.bias", "pc_res_3.linear_1.weight", "pc_res_3.linear_1.bias", "pc_res_3.linear_2.weight", "pc_res_3.linear_2.bias", "pc_conv_3.linear_1.weight", "pc_conv_3.linear_1.bias", "pc_conv_3.linear_2.weight", "pc_conv_3.linear_2.bias", "pc_res_4.linear_1.weight", "pc_res_4.linear_1.bias", "pc_res_4.linear_2.weight", "pc_res_4.linear_2.bias", "pc_conv_4.linear_1.weight", "pc_conv_4.linear_1.bias", "pc_conv_4.linear_2.weight", "pc_conv_4.linear_2.bias", "pc_res_5.linear_1.weight", "pc_res_5.linear_1.bias", "pc_res_5.linear_2.weight", "pc_res_5.linear_2.bias", "pc_conv_5.linear_1.weight", "pc_conv_5.linear_1.bias", "pc_conv_5.linear_2.weight", "pc_conv_5.linear_2.bias", "pc_res_6.linear_1.weight", "pc_res_6.linear_1.bias", "pc_res_6.linear_2.weight", "pc_res_6.linear_2.bias", "pc_conv_6.linear_1.weight", "pc_conv_6.linear_1.bias", "pc_conv_6.linear_2.weight", "pc_conv_6.linear_2.bias", "pc_res_7.linear_1.weight", "pc_res_7.linear_1.bias", "pc_res_7.linear_2.weight", "pc_res_7.linear_2.bias", "conv_1.weight", "conv_1.bias", "conv_2.weight", "conv_2.bias", "conv_3.weight", "conv_3.bias", "conv_4.weight", "conv_4.bias", "conv_5.weight", "conv_5.bias", "pc_conv_out_bool.weight", "pc_conv_out_bool.bias", "pc_conv_out_float.weight", "pc_conv_out_float.bias". \n\tUnexpected key(s) in state_dict: "epoch", "global_step", "pytorch-lightning_version", "state_dict", "loops", "callbacks", "optimizer_states", "lr_schedulers", "hparams_name", "hyper_parameters", "datamodule_hparams_name", "datamodule_hyper_parameters". ')
full_key: model
[2022-12-08 16:42:56,591][src.utils.utils][INFO] - Closing loggers...
[2022-12-08 16:43:09,529][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-08 16:43:09,536][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-08 16:43:09,537][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-08 16:43:09,606][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-08 16:43:10,145][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2022-12-08 16:43:10,239][__main__][INFO] - Instantiating callbacks...
[2022-12-08 16:43:10,240][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-08 16:43:10,244][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-08 16:43:10,246][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-08 16:43:10,247][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-08 16:43:10,248][__main__][INFO] - Instantiating loggers...
[2022-12-08 16:43:10,248][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-08 16:43:10,249][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-08 16:43:11,211][__main__][INFO] - Starting training!
[2022-12-08 18:33:58,415][__main__][INFO] - Starting testing!
[2022-12-08 18:33:58,415][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2022-12-08 18:33:59,114][__main__][INFO] - Best ckpt path: None
[2022-12-08 18:33:59,119][src.utils.utils][INFO] - Closing loggers...
[2022-12-08 18:33:59,134][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-08_16-43-09
[2022-12-08 18:33:59,135][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-12-08 18:36:17,650][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-08 18:36:17,657][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-08 18:36:17,657][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-08 18:36:17,728][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-08 18:36:18,387][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2022-12-08 18:36:21,049][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "/home/fubao/dev/my-ndc/src/models/undc_module2.py", line 42, in __init__
    self.net_bool.load_state_dict(torch.load(bool_ckpt))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1604, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for local_pointnet:
	Missing key(s) in state_dict: "pc_conv_0.linear_1.weight", "pc_conv_0.linear_1.bias", "pc_conv_0.linear_2.weight", "pc_conv_0.linear_2.bias", "pc_res_1.linear_1.weight", "pc_res_1.linear_1.bias", "pc_res_1.linear_2.weight", "pc_res_1.linear_2.bias", "pc_conv_1.linear_1.weight", "pc_conv_1.linear_1.bias", "pc_conv_1.linear_2.weight", "pc_conv_1.linear_2.bias", "pc_res_2.linear_1.weight", "pc_res_2.linear_1.bias", "pc_res_2.linear_2.weight", "pc_res_2.linear_2.bias", "pc_conv_2.linear_1.weight", "pc_conv_2.linear_1.bias", "pc_conv_2.linear_2.weight", "pc_conv_2.linear_2.bias", "pc_res_3.linear_1.weight", "pc_res_3.linear_1.bias", "pc_res_3.linear_2.weight", "pc_res_3.linear_2.bias", "pc_conv_3.linear_1.weight", "pc_conv_3.linear_1.bias", "pc_conv_3.linear_2.weight", "pc_conv_3.linear_2.bias", "pc_res_4.linear_1.weight", "pc_res_4.linear_1.bias", "pc_res_4.linear_2.weight", "pc_res_4.linear_2.bias", "pc_conv_4.linear_1.weight", "pc_conv_4.linear_1.bias", "pc_conv_4.linear_2.weight", "pc_conv_4.linear_2.bias", "pc_res_5.linear_1.weight", "pc_res_5.linear_1.bias", "pc_res_5.linear_2.weight", "pc_res_5.linear_2.bias", "pc_conv_5.linear_1.weight", "pc_conv_5.linear_1.bias", "pc_conv_5.linear_2.weight", "pc_conv_5.linear_2.bias", "pc_res_6.linear_1.weight", "pc_res_6.linear_1.bias", "pc_res_6.linear_2.weight", "pc_res_6.linear_2.bias", "pc_conv_6.linear_1.weight", "pc_conv_6.linear_1.bias", "pc_conv_6.linear_2.weight", "pc_conv_6.linear_2.bias", "pc_res_7.linear_1.weight", "pc_res_7.linear_1.bias", "pc_res_7.linear_2.weight", "pc_res_7.linear_2.bias", "conv_1.weight", "conv_1.bias", "conv_2.weight", "conv_2.bias", "conv_3.weight", "conv_3.bias", "conv_4.weight", "conv_4.bias", "conv_5.weight", "conv_5.bias", "pc_conv_out_bool.weight", "pc_conv_out_bool.bias", "pc_conv_out_float.weight", "pc_conv_out_float.bias". 
	Unexpected key(s) in state_dict: "epoch", "global_step", "pytorch-lightning_version", "state_dict", "loops", "callbacks", "optimizer_states", "lr_schedulers", "hparams_name", "hyper_parameters", "datamodule_hparams_name", "datamodule_hyper_parameters". 

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 72, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 339, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.models.undc_module2.UNDCLitModule':
RuntimeError('Error(s) in loading state_dict for local_pointnet:\n\tMissing key(s) in state_dict: "pc_conv_0.linear_1.weight", "pc_conv_0.linear_1.bias", "pc_conv_0.linear_2.weight", "pc_conv_0.linear_2.bias", "pc_res_1.linear_1.weight", "pc_res_1.linear_1.bias", "pc_res_1.linear_2.weight", "pc_res_1.linear_2.bias", "pc_conv_1.linear_1.weight", "pc_conv_1.linear_1.bias", "pc_conv_1.linear_2.weight", "pc_conv_1.linear_2.bias", "pc_res_2.linear_1.weight", "pc_res_2.linear_1.bias", "pc_res_2.linear_2.weight", "pc_res_2.linear_2.bias", "pc_conv_2.linear_1.weight", "pc_conv_2.linear_1.bias", "pc_conv_2.linear_2.weight", "pc_conv_2.linear_2.bias", "pc_res_3.linear_1.weight", "pc_res_3.linear_1.bias", "pc_res_3.linear_2.weight", "pc_res_3.linear_2.bias", "pc_conv_3.linear_1.weight", "pc_conv_3.linear_1.bias", "pc_conv_3.linear_2.weight", "pc_conv_3.linear_2.bias", "pc_res_4.linear_1.weight", "pc_res_4.linear_1.bias", "pc_res_4.linear_2.weight", "pc_res_4.linear_2.bias", "pc_conv_4.linear_1.weight", "pc_conv_4.linear_1.bias", "pc_conv_4.linear_2.weight", "pc_conv_4.linear_2.bias", "pc_res_5.linear_1.weight", "pc_res_5.linear_1.bias", "pc_res_5.linear_2.weight", "pc_res_5.linear_2.bias", "pc_conv_5.linear_1.weight", "pc_conv_5.linear_1.bias", "pc_conv_5.linear_2.weight", "pc_conv_5.linear_2.bias", "pc_res_6.linear_1.weight", "pc_res_6.linear_1.bias", "pc_res_6.linear_2.weight", "pc_res_6.linear_2.bias", "pc_conv_6.linear_1.weight", "pc_conv_6.linear_1.bias", "pc_conv_6.linear_2.weight", "pc_conv_6.linear_2.bias", "pc_res_7.linear_1.weight", "pc_res_7.linear_1.bias", "pc_res_7.linear_2.weight", "pc_res_7.linear_2.bias", "conv_1.weight", "conv_1.bias", "conv_2.weight", "conv_2.bias", "conv_3.weight", "conv_3.bias", "conv_4.weight", "conv_4.bias", "conv_5.weight", "conv_5.bias", "pc_conv_out_bool.weight", "pc_conv_out_bool.bias", "pc_conv_out_float.weight", "pc_conv_out_float.bias". \n\tUnexpected key(s) in state_dict: "epoch", "global_step", "pytorch-lightning_version", "state_dict", "loops", "callbacks", "optimizer_states", "lr_schedulers", "hparams_name", "hyper_parameters", "datamodule_hparams_name", "datamodule_hyper_parameters". ')
full_key: model
[2022-12-08 18:36:21,053][src.utils.utils][INFO] - Closing loggers...
[2022-12-08 18:39:19,954][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-08 18:39:19,964][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-08 18:39:19,964][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-08 18:39:20,086][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-08 18:39:20,682][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2022-12-08 18:39:23,204][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "/home/fubao/dev/my-ndc/src/models/undc_module2.py", line 42, in __init__
    self.net_bool.load_state_dict(torch.load(bool_ckpt))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1604, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for local_pointnet:
	Missing key(s) in state_dict: "pc_conv_0.linear_1.weight", "pc_conv_0.linear_1.bias", "pc_conv_0.linear_2.weight", "pc_conv_0.linear_2.bias", "pc_res_1.linear_1.weight", "pc_res_1.linear_1.bias", "pc_res_1.linear_2.weight", "pc_res_1.linear_2.bias", "pc_conv_1.linear_1.weight", "pc_conv_1.linear_1.bias", "pc_conv_1.linear_2.weight", "pc_conv_1.linear_2.bias", "pc_res_2.linear_1.weight", "pc_res_2.linear_1.bias", "pc_res_2.linear_2.weight", "pc_res_2.linear_2.bias", "pc_conv_2.linear_1.weight", "pc_conv_2.linear_1.bias", "pc_conv_2.linear_2.weight", "pc_conv_2.linear_2.bias", "pc_res_3.linear_1.weight", "pc_res_3.linear_1.bias", "pc_res_3.linear_2.weight", "pc_res_3.linear_2.bias", "pc_conv_3.linear_1.weight", "pc_conv_3.linear_1.bias", "pc_conv_3.linear_2.weight", "pc_conv_3.linear_2.bias", "pc_res_4.linear_1.weight", "pc_res_4.linear_1.bias", "pc_res_4.linear_2.weight", "pc_res_4.linear_2.bias", "pc_conv_4.linear_1.weight", "pc_conv_4.linear_1.bias", "pc_conv_4.linear_2.weight", "pc_conv_4.linear_2.bias", "pc_res_5.linear_1.weight", "pc_res_5.linear_1.bias", "pc_res_5.linear_2.weight", "pc_res_5.linear_2.bias", "pc_conv_5.linear_1.weight", "pc_conv_5.linear_1.bias", "pc_conv_5.linear_2.weight", "pc_conv_5.linear_2.bias", "pc_res_6.linear_1.weight", "pc_res_6.linear_1.bias", "pc_res_6.linear_2.weight", "pc_res_6.linear_2.bias", "pc_conv_6.linear_1.weight", "pc_conv_6.linear_1.bias", "pc_conv_6.linear_2.weight", "pc_conv_6.linear_2.bias", "pc_res_7.linear_1.weight", "pc_res_7.linear_1.bias", "pc_res_7.linear_2.weight", "pc_res_7.linear_2.bias", "conv_1.weight", "conv_1.bias", "conv_2.weight", "conv_2.bias", "conv_3.weight", "conv_3.bias", "conv_4.weight", "conv_4.bias", "conv_5.weight", "conv_5.bias", "pc_conv_out_bool.weight", "pc_conv_out_bool.bias", "pc_conv_out_float.weight", "pc_conv_out_float.bias". 
	Unexpected key(s) in state_dict: "epoch", "global_step", "pytorch-lightning_version", "state_dict", "loops", "callbacks", "optimizer_states", "lr_schedulers", "hparams_name", "hyper_parameters", "datamodule_hparams_name", "datamodule_hyper_parameters". 

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 72, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 339, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.models.undc_module2.UNDCLitModule':
RuntimeError('Error(s) in loading state_dict for local_pointnet:\n\tMissing key(s) in state_dict: "pc_conv_0.linear_1.weight", "pc_conv_0.linear_1.bias", "pc_conv_0.linear_2.weight", "pc_conv_0.linear_2.bias", "pc_res_1.linear_1.weight", "pc_res_1.linear_1.bias", "pc_res_1.linear_2.weight", "pc_res_1.linear_2.bias", "pc_conv_1.linear_1.weight", "pc_conv_1.linear_1.bias", "pc_conv_1.linear_2.weight", "pc_conv_1.linear_2.bias", "pc_res_2.linear_1.weight", "pc_res_2.linear_1.bias", "pc_res_2.linear_2.weight", "pc_res_2.linear_2.bias", "pc_conv_2.linear_1.weight", "pc_conv_2.linear_1.bias", "pc_conv_2.linear_2.weight", "pc_conv_2.linear_2.bias", "pc_res_3.linear_1.weight", "pc_res_3.linear_1.bias", "pc_res_3.linear_2.weight", "pc_res_3.linear_2.bias", "pc_conv_3.linear_1.weight", "pc_conv_3.linear_1.bias", "pc_conv_3.linear_2.weight", "pc_conv_3.linear_2.bias", "pc_res_4.linear_1.weight", "pc_res_4.linear_1.bias", "pc_res_4.linear_2.weight", "pc_res_4.linear_2.bias", "pc_conv_4.linear_1.weight", "pc_conv_4.linear_1.bias", "pc_conv_4.linear_2.weight", "pc_conv_4.linear_2.bias", "pc_res_5.linear_1.weight", "pc_res_5.linear_1.bias", "pc_res_5.linear_2.weight", "pc_res_5.linear_2.bias", "pc_conv_5.linear_1.weight", "pc_conv_5.linear_1.bias", "pc_conv_5.linear_2.weight", "pc_conv_5.linear_2.bias", "pc_res_6.linear_1.weight", "pc_res_6.linear_1.bias", "pc_res_6.linear_2.weight", "pc_res_6.linear_2.bias", "pc_conv_6.linear_1.weight", "pc_conv_6.linear_1.bias", "pc_conv_6.linear_2.weight", "pc_conv_6.linear_2.bias", "pc_res_7.linear_1.weight", "pc_res_7.linear_1.bias", "pc_res_7.linear_2.weight", "pc_res_7.linear_2.bias", "conv_1.weight", "conv_1.bias", "conv_2.weight", "conv_2.bias", "conv_3.weight", "conv_3.bias", "conv_4.weight", "conv_4.bias", "conv_5.weight", "conv_5.bias", "pc_conv_out_bool.weight", "pc_conv_out_bool.bias", "pc_conv_out_float.weight", "pc_conv_out_float.bias". \n\tUnexpected key(s) in state_dict: "epoch", "global_step", "pytorch-lightning_version", "state_dict", "loops", "callbacks", "optimizer_states", "lr_schedulers", "hparams_name", "hyper_parameters", "datamodule_hparams_name", "datamodule_hyper_parameters". ')
full_key: model
[2022-12-08 18:39:23,208][src.utils.utils][INFO] - Closing loggers...
[2022-12-08 18:39:53,877][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-08 18:39:53,884][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-08 18:39:53,885][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-08 18:39:53,954][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-08 18:39:54,612][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2022-12-08 18:39:57,049][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "/home/fubao/dev/my-ndc/src/models/undc_module2.py", line 42, in __init__
    self.net_bool.load_state_dict(torch.load(bool_ckpt))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1604, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for local_pointnet:
	Missing key(s) in state_dict: "pc_conv_0.linear_1.weight", "pc_conv_0.linear_1.bias", "pc_conv_0.linear_2.weight", "pc_conv_0.linear_2.bias", "pc_res_1.linear_1.weight", "pc_res_1.linear_1.bias", "pc_res_1.linear_2.weight", "pc_res_1.linear_2.bias", "pc_conv_1.linear_1.weight", "pc_conv_1.linear_1.bias", "pc_conv_1.linear_2.weight", "pc_conv_1.linear_2.bias", "pc_res_2.linear_1.weight", "pc_res_2.linear_1.bias", "pc_res_2.linear_2.weight", "pc_res_2.linear_2.bias", "pc_conv_2.linear_1.weight", "pc_conv_2.linear_1.bias", "pc_conv_2.linear_2.weight", "pc_conv_2.linear_2.bias", "pc_res_3.linear_1.weight", "pc_res_3.linear_1.bias", "pc_res_3.linear_2.weight", "pc_res_3.linear_2.bias", "pc_conv_3.linear_1.weight", "pc_conv_3.linear_1.bias", "pc_conv_3.linear_2.weight", "pc_conv_3.linear_2.bias", "pc_res_4.linear_1.weight", "pc_res_4.linear_1.bias", "pc_res_4.linear_2.weight", "pc_res_4.linear_2.bias", "pc_conv_4.linear_1.weight", "pc_conv_4.linear_1.bias", "pc_conv_4.linear_2.weight", "pc_conv_4.linear_2.bias", "pc_res_5.linear_1.weight", "pc_res_5.linear_1.bias", "pc_res_5.linear_2.weight", "pc_res_5.linear_2.bias", "pc_conv_5.linear_1.weight", "pc_conv_5.linear_1.bias", "pc_conv_5.linear_2.weight", "pc_conv_5.linear_2.bias", "pc_res_6.linear_1.weight", "pc_res_6.linear_1.bias", "pc_res_6.linear_2.weight", "pc_res_6.linear_2.bias", "pc_conv_6.linear_1.weight", "pc_conv_6.linear_1.bias", "pc_conv_6.linear_2.weight", "pc_conv_6.linear_2.bias", "pc_res_7.linear_1.weight", "pc_res_7.linear_1.bias", "pc_res_7.linear_2.weight", "pc_res_7.linear_2.bias", "conv_1.weight", "conv_1.bias", "conv_2.weight", "conv_2.bias", "conv_3.weight", "conv_3.bias", "conv_4.weight", "conv_4.bias", "conv_5.weight", "conv_5.bias", "pc_conv_out_bool.weight", "pc_conv_out_bool.bias", "pc_conv_out_float.weight", "pc_conv_out_float.bias". 
	Unexpected key(s) in state_dict: "epoch", "global_step", "pytorch-lightning_version", "state_dict", "loops", "callbacks", "optimizer_states", "lr_schedulers", "hparams_name", "hyper_parameters", "datamodule_hparams_name", "datamodule_hyper_parameters". 

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 72, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 339, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.models.undc_module2.UNDCLitModule':
RuntimeError('Error(s) in loading state_dict for local_pointnet:\n\tMissing key(s) in state_dict: "pc_conv_0.linear_1.weight", "pc_conv_0.linear_1.bias", "pc_conv_0.linear_2.weight", "pc_conv_0.linear_2.bias", "pc_res_1.linear_1.weight", "pc_res_1.linear_1.bias", "pc_res_1.linear_2.weight", "pc_res_1.linear_2.bias", "pc_conv_1.linear_1.weight", "pc_conv_1.linear_1.bias", "pc_conv_1.linear_2.weight", "pc_conv_1.linear_2.bias", "pc_res_2.linear_1.weight", "pc_res_2.linear_1.bias", "pc_res_2.linear_2.weight", "pc_res_2.linear_2.bias", "pc_conv_2.linear_1.weight", "pc_conv_2.linear_1.bias", "pc_conv_2.linear_2.weight", "pc_conv_2.linear_2.bias", "pc_res_3.linear_1.weight", "pc_res_3.linear_1.bias", "pc_res_3.linear_2.weight", "pc_res_3.linear_2.bias", "pc_conv_3.linear_1.weight", "pc_conv_3.linear_1.bias", "pc_conv_3.linear_2.weight", "pc_conv_3.linear_2.bias", "pc_res_4.linear_1.weight", "pc_res_4.linear_1.bias", "pc_res_4.linear_2.weight", "pc_res_4.linear_2.bias", "pc_conv_4.linear_1.weight", "pc_conv_4.linear_1.bias", "pc_conv_4.linear_2.weight", "pc_conv_4.linear_2.bias", "pc_res_5.linear_1.weight", "pc_res_5.linear_1.bias", "pc_res_5.linear_2.weight", "pc_res_5.linear_2.bias", "pc_conv_5.linear_1.weight", "pc_conv_5.linear_1.bias", "pc_conv_5.linear_2.weight", "pc_conv_5.linear_2.bias", "pc_res_6.linear_1.weight", "pc_res_6.linear_1.bias", "pc_res_6.linear_2.weight", "pc_res_6.linear_2.bias", "pc_conv_6.linear_1.weight", "pc_conv_6.linear_1.bias", "pc_conv_6.linear_2.weight", "pc_conv_6.linear_2.bias", "pc_res_7.linear_1.weight", "pc_res_7.linear_1.bias", "pc_res_7.linear_2.weight", "pc_res_7.linear_2.bias", "conv_1.weight", "conv_1.bias", "conv_2.weight", "conv_2.bias", "conv_3.weight", "conv_3.bias", "conv_4.weight", "conv_4.bias", "conv_5.weight", "conv_5.bias", "pc_conv_out_bool.weight", "pc_conv_out_bool.bias", "pc_conv_out_float.weight", "pc_conv_out_float.bias". \n\tUnexpected key(s) in state_dict: "epoch", "global_step", "pytorch-lightning_version", "state_dict", "loops", "callbacks", "optimizer_states", "lr_schedulers", "hparams_name", "hyper_parameters", "datamodule_hparams_name", "datamodule_hyper_parameters". ')
full_key: model
[2022-12-08 18:39:57,052][src.utils.utils][INFO] - Closing loggers...
[2022-12-08 22:47:59,759][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-08 22:47:59,770][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-08 22:47:59,770][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-08 22:47:59,844][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-08 22:48:00,596][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2022-12-08 22:48:03,093][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "/home/fubao/dev/my-ndc/src/models/undc_module2.py", line 44, in __init__
    self.net_bool.load_state_dict(torch.load(bool_ckpt))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1604, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for local_pointnet:
	Missing key(s) in state_dict: "pc_conv_0.linear_1.weight", "pc_conv_0.linear_1.bias", "pc_conv_0.linear_2.weight", "pc_conv_0.linear_2.bias", "pc_res_1.linear_1.weight", "pc_res_1.linear_1.bias", "pc_res_1.linear_2.weight", "pc_res_1.linear_2.bias", "pc_conv_1.linear_1.weight", "pc_conv_1.linear_1.bias", "pc_conv_1.linear_2.weight", "pc_conv_1.linear_2.bias", "pc_res_2.linear_1.weight", "pc_res_2.linear_1.bias", "pc_res_2.linear_2.weight", "pc_res_2.linear_2.bias", "pc_conv_2.linear_1.weight", "pc_conv_2.linear_1.bias", "pc_conv_2.linear_2.weight", "pc_conv_2.linear_2.bias", "pc_res_3.linear_1.weight", "pc_res_3.linear_1.bias", "pc_res_3.linear_2.weight", "pc_res_3.linear_2.bias", "pc_conv_3.linear_1.weight", "pc_conv_3.linear_1.bias", "pc_conv_3.linear_2.weight", "pc_conv_3.linear_2.bias", "pc_res_4.linear_1.weight", "pc_res_4.linear_1.bias", "pc_res_4.linear_2.weight", "pc_res_4.linear_2.bias", "pc_conv_4.linear_1.weight", "pc_conv_4.linear_1.bias", "pc_conv_4.linear_2.weight", "pc_conv_4.linear_2.bias", "pc_res_5.linear_1.weight", "pc_res_5.linear_1.bias", "pc_res_5.linear_2.weight", "pc_res_5.linear_2.bias", "pc_conv_5.linear_1.weight", "pc_conv_5.linear_1.bias", "pc_conv_5.linear_2.weight", "pc_conv_5.linear_2.bias", "pc_res_6.linear_1.weight", "pc_res_6.linear_1.bias", "pc_res_6.linear_2.weight", "pc_res_6.linear_2.bias", "pc_conv_6.linear_1.weight", "pc_conv_6.linear_1.bias", "pc_conv_6.linear_2.weight", "pc_conv_6.linear_2.bias", "pc_res_7.linear_1.weight", "pc_res_7.linear_1.bias", "pc_res_7.linear_2.weight", "pc_res_7.linear_2.bias", "conv_1.weight", "conv_1.bias", "conv_2.weight", "conv_2.bias", "conv_3.weight", "conv_3.bias", "conv_4.weight", "conv_4.bias", "conv_5.weight", "conv_5.bias", "pc_conv_out_bool.weight", "pc_conv_out_bool.bias", "pc_conv_out_float.weight", "pc_conv_out_float.bias". 
	Unexpected key(s) in state_dict: "epoch", "global_step", "pytorch-lightning_version", "state_dict", "loops", "callbacks", "optimizer_states", "lr_schedulers", "hparams_name", "hyper_parameters", "datamodule_hparams_name", "datamodule_hyper_parameters". 

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 72, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 339, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.models.undc_module2.UNDCLitModule':
RuntimeError('Error(s) in loading state_dict for local_pointnet:\n\tMissing key(s) in state_dict: "pc_conv_0.linear_1.weight", "pc_conv_0.linear_1.bias", "pc_conv_0.linear_2.weight", "pc_conv_0.linear_2.bias", "pc_res_1.linear_1.weight", "pc_res_1.linear_1.bias", "pc_res_1.linear_2.weight", "pc_res_1.linear_2.bias", "pc_conv_1.linear_1.weight", "pc_conv_1.linear_1.bias", "pc_conv_1.linear_2.weight", "pc_conv_1.linear_2.bias", "pc_res_2.linear_1.weight", "pc_res_2.linear_1.bias", "pc_res_2.linear_2.weight", "pc_res_2.linear_2.bias", "pc_conv_2.linear_1.weight", "pc_conv_2.linear_1.bias", "pc_conv_2.linear_2.weight", "pc_conv_2.linear_2.bias", "pc_res_3.linear_1.weight", "pc_res_3.linear_1.bias", "pc_res_3.linear_2.weight", "pc_res_3.linear_2.bias", "pc_conv_3.linear_1.weight", "pc_conv_3.linear_1.bias", "pc_conv_3.linear_2.weight", "pc_conv_3.linear_2.bias", "pc_res_4.linear_1.weight", "pc_res_4.linear_1.bias", "pc_res_4.linear_2.weight", "pc_res_4.linear_2.bias", "pc_conv_4.linear_1.weight", "pc_conv_4.linear_1.bias", "pc_conv_4.linear_2.weight", "pc_conv_4.linear_2.bias", "pc_res_5.linear_1.weight", "pc_res_5.linear_1.bias", "pc_res_5.linear_2.weight", "pc_res_5.linear_2.bias", "pc_conv_5.linear_1.weight", "pc_conv_5.linear_1.bias", "pc_conv_5.linear_2.weight", "pc_conv_5.linear_2.bias", "pc_res_6.linear_1.weight", "pc_res_6.linear_1.bias", "pc_res_6.linear_2.weight", "pc_res_6.linear_2.bias", "pc_conv_6.linear_1.weight", "pc_conv_6.linear_1.bias", "pc_conv_6.linear_2.weight", "pc_conv_6.linear_2.bias", "pc_res_7.linear_1.weight", "pc_res_7.linear_1.bias", "pc_res_7.linear_2.weight", "pc_res_7.linear_2.bias", "conv_1.weight", "conv_1.bias", "conv_2.weight", "conv_2.bias", "conv_3.weight", "conv_3.bias", "conv_4.weight", "conv_4.bias", "conv_5.weight", "conv_5.bias", "pc_conv_out_bool.weight", "pc_conv_out_bool.bias", "pc_conv_out_float.weight", "pc_conv_out_float.bias". \n\tUnexpected key(s) in state_dict: "epoch", "global_step", "pytorch-lightning_version", "state_dict", "loops", "callbacks", "optimizer_states", "lr_schedulers", "hparams_name", "hyper_parameters", "datamodule_hparams_name", "datamodule_hyper_parameters". ')
full_key: model
[2022-12-08 22:48:03,097][src.utils.utils][INFO] - Closing loggers...
[2022-12-08 22:48:29,678][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-08 22:48:29,685][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-08 22:48:29,685][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-08 22:48:29,756][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-08 22:48:30,413][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2022-12-08 22:48:30,476][__main__][INFO] - Instantiating callbacks...
[2022-12-08 22:48:30,477][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-08 22:48:30,481][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-08 22:48:30,483][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-08 22:48:30,484][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-08 22:48:30,484][__main__][INFO] - Instantiating loggers...
[2022-12-08 22:48:30,485][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-08 22:48:30,485][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-08 22:48:31,142][__main__][INFO] - Starting training!
[2022-12-08 22:49:22,162][__main__][INFO] - Starting testing!
[2022-12-08 22:49:22,163][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2022-12-08 22:49:22,649][__main__][INFO] - Best ckpt path: None
[2022-12-08 22:49:22,655][src.utils.utils][INFO] - Closing loggers...
[2022-12-08 22:49:22,657][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-08_22-48-29
[2022-12-08 22:49:22,658][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-12-08 22:50:32,800][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-08 22:50:32,807][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-08 22:50:32,807][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-08 22:50:32,877][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-08 22:50:33,497][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2022-12-08 22:50:33,545][__main__][INFO] - Instantiating callbacks...
[2022-12-08 22:50:33,546][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-08 22:50:33,550][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-08 22:50:33,552][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-08 22:50:33,552][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-08 22:50:33,553][__main__][INFO] - Instantiating loggers...
[2022-12-08 22:50:33,553][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-08 22:50:33,554][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-08 22:50:34,244][__main__][INFO] - Starting training!
[2022-12-08 22:54:37,470][__main__][INFO] - Starting testing!
[2022-12-08 22:54:37,470][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2022-12-08 22:54:38,642][__main__][INFO] - Best ckpt path: None
[2022-12-08 22:54:38,660][src.utils.utils][INFO] - Closing loggers...
[2022-12-08 22:54:38,663][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-08_22-50-32
[2022-12-08 22:54:38,664][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-12-08 22:56:13,094][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-08 22:56:13,101][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-08 22:56:13,101][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-08 22:56:13,174][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-08 22:56:13,822][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2022-12-08 22:56:17,309][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "/home/fubao/dev/my-ndc/src/models/undc_module2.py", line 44, in __init__
    self.net_bool.load_state_dict(torch.load(bool_ckpt))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1604, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for local_pointnet:
	Missing key(s) in state_dict: "pc_conv_0.linear_1.weight", "pc_conv_0.linear_1.bias", "pc_conv_0.linear_2.weight", "pc_conv_0.linear_2.bias", "pc_res_1.linear_1.weight", "pc_res_1.linear_1.bias", "pc_res_1.linear_2.weight", "pc_res_1.linear_2.bias", "pc_conv_1.linear_1.weight", "pc_conv_1.linear_1.bias", "pc_conv_1.linear_2.weight", "pc_conv_1.linear_2.bias", "pc_res_2.linear_1.weight", "pc_res_2.linear_1.bias", "pc_res_2.linear_2.weight", "pc_res_2.linear_2.bias", "pc_conv_2.linear_1.weight", "pc_conv_2.linear_1.bias", "pc_conv_2.linear_2.weight", "pc_conv_2.linear_2.bias", "pc_res_3.linear_1.weight", "pc_res_3.linear_1.bias", "pc_res_3.linear_2.weight", "pc_res_3.linear_2.bias", "pc_conv_3.linear_1.weight", "pc_conv_3.linear_1.bias", "pc_conv_3.linear_2.weight", "pc_conv_3.linear_2.bias", "pc_res_4.linear_1.weight", "pc_res_4.linear_1.bias", "pc_res_4.linear_2.weight", "pc_res_4.linear_2.bias", "pc_conv_4.linear_1.weight", "pc_conv_4.linear_1.bias", "pc_conv_4.linear_2.weight", "pc_conv_4.linear_2.bias", "pc_res_5.linear_1.weight", "pc_res_5.linear_1.bias", "pc_res_5.linear_2.weight", "pc_res_5.linear_2.bias", "pc_conv_5.linear_1.weight", "pc_conv_5.linear_1.bias", "pc_conv_5.linear_2.weight", "pc_conv_5.linear_2.bias", "pc_res_6.linear_1.weight", "pc_res_6.linear_1.bias", "pc_res_6.linear_2.weight", "pc_res_6.linear_2.bias", "pc_conv_6.linear_1.weight", "pc_conv_6.linear_1.bias", "pc_conv_6.linear_2.weight", "pc_conv_6.linear_2.bias", "pc_res_7.linear_1.weight", "pc_res_7.linear_1.bias", "pc_res_7.linear_2.weight", "pc_res_7.linear_2.bias", "conv_1.weight", "conv_1.bias", "conv_2.weight", "conv_2.bias", "conv_3.weight", "conv_3.bias", "conv_4.weight", "conv_4.bias", "conv_5.weight", "conv_5.bias", "pc_conv_out_bool.weight", "pc_conv_out_bool.bias", "pc_conv_out_float.weight", "pc_conv_out_float.bias". 
	Unexpected key(s) in state_dict: "epoch", "global_step", "pytorch-lightning_version", "state_dict", "loops", "callbacks", "optimizer_states", "lr_schedulers", "hparams_name", "hyper_parameters", "datamodule_hparams_name", "datamodule_hyper_parameters". 

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 72, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 339, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.models.undc_module2.UNDCLitModule':
RuntimeError('Error(s) in loading state_dict for local_pointnet:\n\tMissing key(s) in state_dict: "pc_conv_0.linear_1.weight", "pc_conv_0.linear_1.bias", "pc_conv_0.linear_2.weight", "pc_conv_0.linear_2.bias", "pc_res_1.linear_1.weight", "pc_res_1.linear_1.bias", "pc_res_1.linear_2.weight", "pc_res_1.linear_2.bias", "pc_conv_1.linear_1.weight", "pc_conv_1.linear_1.bias", "pc_conv_1.linear_2.weight", "pc_conv_1.linear_2.bias", "pc_res_2.linear_1.weight", "pc_res_2.linear_1.bias", "pc_res_2.linear_2.weight", "pc_res_2.linear_2.bias", "pc_conv_2.linear_1.weight", "pc_conv_2.linear_1.bias", "pc_conv_2.linear_2.weight", "pc_conv_2.linear_2.bias", "pc_res_3.linear_1.weight", "pc_res_3.linear_1.bias", "pc_res_3.linear_2.weight", "pc_res_3.linear_2.bias", "pc_conv_3.linear_1.weight", "pc_conv_3.linear_1.bias", "pc_conv_3.linear_2.weight", "pc_conv_3.linear_2.bias", "pc_res_4.linear_1.weight", "pc_res_4.linear_1.bias", "pc_res_4.linear_2.weight", "pc_res_4.linear_2.bias", "pc_conv_4.linear_1.weight", "pc_conv_4.linear_1.bias", "pc_conv_4.linear_2.weight", "pc_conv_4.linear_2.bias", "pc_res_5.linear_1.weight", "pc_res_5.linear_1.bias", "pc_res_5.linear_2.weight", "pc_res_5.linear_2.bias", "pc_conv_5.linear_1.weight", "pc_conv_5.linear_1.bias", "pc_conv_5.linear_2.weight", "pc_conv_5.linear_2.bias", "pc_res_6.linear_1.weight", "pc_res_6.linear_1.bias", "pc_res_6.linear_2.weight", "pc_res_6.linear_2.bias", "pc_conv_6.linear_1.weight", "pc_conv_6.linear_1.bias", "pc_conv_6.linear_2.weight", "pc_conv_6.linear_2.bias", "pc_res_7.linear_1.weight", "pc_res_7.linear_1.bias", "pc_res_7.linear_2.weight", "pc_res_7.linear_2.bias", "conv_1.weight", "conv_1.bias", "conv_2.weight", "conv_2.bias", "conv_3.weight", "conv_3.bias", "conv_4.weight", "conv_4.bias", "conv_5.weight", "conv_5.bias", "pc_conv_out_bool.weight", "pc_conv_out_bool.bias", "pc_conv_out_float.weight", "pc_conv_out_float.bias". \n\tUnexpected key(s) in state_dict: "epoch", "global_step", "pytorch-lightning_version", "state_dict", "loops", "callbacks", "optimizer_states", "lr_schedulers", "hparams_name", "hyper_parameters", "datamodule_hparams_name", "datamodule_hyper_parameters". ')
full_key: model
[2022-12-08 22:56:17,320][src.utils.utils][INFO] - Closing loggers...
[2022-12-08 23:00:22,657][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-08 23:00:22,663][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-08 23:00:22,664][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-08 23:00:22,749][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-08 23:00:23,355][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2022-12-08 23:00:23,413][__main__][INFO] - Instantiating callbacks...
[2022-12-08 23:00:23,413][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-08 23:00:23,418][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-08 23:00:23,420][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-08 23:00:23,421][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-08 23:00:23,422][__main__][INFO] - Instantiating loggers...
[2022-12-08 23:00:23,422][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-08 23:00:23,423][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-08 23:00:24,384][__main__][INFO] - Starting training!
[2022-12-08 23:01:29,634][__main__][INFO] - Starting testing!
[2022-12-08 23:01:29,635][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2022-12-08 23:01:30,122][__main__][INFO] - Best ckpt path: None
[2022-12-08 23:01:30,127][src.utils.utils][INFO] - Closing loggers...
[2022-12-08 23:01:30,129][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-08_23-00-22
[2022-12-08 23:01:30,130][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-12-08 23:01:35,955][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-08 23:01:35,962][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-08 23:01:35,962][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-08 23:01:36,032][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-08 23:01:36,884][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2022-12-08 23:01:36,985][__main__][INFO] - Instantiating callbacks...
[2022-12-08 23:01:36,986][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-08 23:01:36,994][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-08 23:01:36,997][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-08 23:01:36,999][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-08 23:01:37,000][__main__][INFO] - Instantiating loggers...
[2022-12-08 23:01:37,000][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-08 23:01:37,001][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-08 23:01:38,102][__main__][INFO] - Starting training!
[2022-12-08 23:02:42,731][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 98, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 648, in _call_and_handle_interrupt
    return self.strategy.launcher.launch(trainer_fn, *args, trainer=self, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 103, in launch
    mp.start_processes(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 198, in start_processes
    while not context.join():
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 160, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 5 terminated with the following error:
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 69, in _wrap
    fn(i, *args)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 129, in _wrapping_function
    results = function(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1285, in _run_train
    self.fit_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 201, in run
    self.on_advance_end()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/fit_loop.py", line 286, in on_advance_end
    epoch_end_outputs = self.trainer._call_lightning_module_hook("training_epoch_end", epoch_end_outputs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1552, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
  File "/home/fubao/dev/my-ndc/src/models/undc_module2.py", line 145, in training_epoch_end
    torch.save(self.net_bool.state_dict(),f"{self.hparams.out_dir}/ckpts/bool/epoch-{self.epoch_idx}.ckpt")
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/serialization.py", line 376, in save
    with _open_file_like(f, 'wb') as opened_file:
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/serialization.py", line 230, in _open_file_like
    return _open_file(name_or_buffer, mode)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/serialization.py", line 211, in __init__
    super(_open_file, self).__init__(open(name, mode))
FileNotFoundError: [Errno 2] No such file or directory: '/home/fubao/dev/my-ndc/logs/train/runs/2022-12-08_23-01-35/ckpts/bool/epoch-1.ckpt'

[2022-12-08 23:02:42,738][src.utils.utils][INFO] - Closing loggers...
[2022-12-08 23:03:41,001][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-08 23:03:41,012][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-08 23:03:41,013][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-08 23:03:41,163][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-08 23:03:41,807][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2022-12-08 23:03:41,861][__main__][INFO] - Instantiating callbacks...
[2022-12-08 23:03:41,862][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-08 23:03:41,866][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-08 23:03:41,868][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-08 23:03:41,869][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-08 23:03:41,869][__main__][INFO] - Instantiating loggers...
[2022-12-08 23:03:41,870][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-08 23:03:41,870][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-08 23:03:42,808][__main__][INFO] - Starting training!
[2022-12-08 23:05:01,546][__main__][INFO] - Starting testing!
[2022-12-08 23:05:01,546][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2022-12-08 23:05:02,112][__main__][INFO] - Best ckpt path: None
[2022-12-08 23:05:02,118][src.utils.utils][INFO] - Closing loggers...
[2022-12-08 23:05:02,121][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-08_23-03-40
[2022-12-08 23:05:02,122][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-12-08 23:06:09,371][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-08 23:06:09,378][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-08 23:06:09,379][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-08 23:06:09,475][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-08 23:06:10,151][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2022-12-08 23:06:14,126][__main__][INFO] - Instantiating callbacks...
[2022-12-08 23:06:14,128][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-08 23:06:14,141][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-08 23:06:14,144][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-08 23:06:14,146][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-08 23:06:14,147][__main__][INFO] - Instantiating loggers...
[2022-12-08 23:06:14,148][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-08 23:06:14,148][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-08 23:06:14,710][__main__][INFO] - Starting training!
[2022-12-08 23:07:19,417][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 98, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 648, in _call_and_handle_interrupt
    return self.strategy.launcher.launch(trainer_fn, *args, trainer=self, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 103, in launch
    mp.start_processes(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 198, in start_processes
    while not context.join():
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 160, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 6 terminated with the following error:
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 69, in _wrap
    fn(i, *args)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/launchers/multiprocessing.py", line 129, in _wrapping_function
    results = function(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1285, in _run_train
    self.fit_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/fit_loop.py", line 270, in advance
    self._outputs = self.epoch_loop.run(self._data_fetcher)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 203, in advance
    batch_output = self.batch_loop.run(kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 87, in advance
    outputs = self.optimizer_loop.run(optimizers, kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 201, in advance
    result = self._run_optimization(kwargs, self._optimizers[self.optim_progress.optimizer_position])
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 248, in _run_optimization
    self._optimizer_step(optimizer, opt_idx, kwargs.get("batch_idx", 0), closure)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 358, in _optimizer_step
    self.trainer._call_lightning_module_hook(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1552, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/core/module.py", line 1666, in optimizer_step
    optimizer.step(closure=optimizer_closure)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/core/optimizer.py", line 168, in step
    step_output = self._strategy.optimizer_step(self._optimizer, self._optimizer_idx, closure, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 216, in optimizer_step
    return self.precision_plugin.optimizer_step(model, optimizer, opt_idx, closure, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/plugins/precision/precision_plugin.py", line 153, in optimizer_step
    return optimizer.step(closure=closure, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/optim/optimizer.py", line 113, in wrapper
    return func(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/optim/adam.py", line 118, in step
    loss = closure()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/plugins/precision/precision_plugin.py", line 138, in _wrap_closure
    closure_result = closure()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 146, in __call__
    self._result = self.closure(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 132, in closure
    step_output = self._step_fn()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 407, in _training_step
    training_step_output = self.trainer._call_strategy_hook("training_step", *kwargs.values())
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1706, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/ddp_spawn.py", line 283, in training_step
    return self.model(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1008, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 969, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/overrides/base.py", line 79, in forward
    output = self.module.training_step(*inputs, **kwargs)
  File "/home/fubao/dev/my-ndc/src/models/undc_module2.py", line 120, in training_step
    bool_loss, bool_acc, pred_bool, float_loss, pred_float = self.step(batch)
  File "/home/fubao/dev/my-ndc/src/models/undc_module2.py", line 109, in step
    _, pred_output_float = self.net_float(pc_KNN_idx,pc_KNN_xyz, voxel_xyz_int,voxel_KNN_idx,voxel_KNN_xyz)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/fubao/dev/my-ndc/src/models/components/undc_pc_net.py", line 129, in forward
    out = self.pc_conv_6(out, voxel_KNN_idx, voxel_KNN_xyz)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/fubao/dev/my-ndc/src/models/components/undc_pc_net.py", line 60, in forward
    output = torch.max(output,1)[0]
RuntimeError: CUDA out of memory. Tried to allocate 26.00 MiB (GPU 6; 23.88 GiB total capacity; 1.56 GiB already allocated; 8.44 MiB free; 1.63 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF

[2022-12-08 23:07:19,427][src.utils.utils][INFO] - Closing loggers...
[2022-12-09 09:23:56,015][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-09 09:23:56,022][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-09 09:23:56,022][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-09 09:23:56,084][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-09 09:23:56,688][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2022-12-09 09:23:56,775][__main__][INFO] - Instantiating callbacks...
[2022-12-09 09:23:56,776][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-09 09:23:56,783][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-09 09:23:56,785][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-09 09:23:56,787][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-09 09:23:56,788][__main__][INFO] - Instantiating loggers...
[2022-12-09 09:23:56,789][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-09 09:23:56,789][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-09 09:24:36,041][__main__][INFO] - Starting training!
[2022-12-09 09:24:41,260][src.datamodules.undc_pc_datamodule][INFO] - Loading Train dataset...
[2022-12-09 09:24:41,262][src.datamodules.undc_pc_datamodule][INFO] - Train dataset [ABC_pc_hdf5] of size 106 had been created.
[2022-12-09 09:24:41,263][src.datamodules.undc_pc_datamodule][INFO] - Loading Val dataset...
[2022-12-09 09:24:41,264][src.datamodules.undc_pc_datamodule][INFO] - Val dataset [ABC_pc_hdf5] of size 54 had been created.
[2022-12-09 09:24:41,264][src.datamodules.undc_pc_datamodule][INFO] - Loading Test dataset...
[2022-12-09 09:24:41,265][src.datamodules.undc_pc_datamodule][INFO] - Test dataset [ABC_pc_hdf5] of size 54 had been created.
[2022-12-09 09:24:44,082][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 98, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_train
    self._run_sanity_check()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1345, in _run_sanity_check
    val_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 155, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 143, in advance
    output = self._evaluation_step(**kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 240, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1706, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 370, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/home/fubao/dev/my-ndc/src/models/undc_module2.py", line 119, in validation_step
    if self.val_float:
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1207, in __getattr__
    raise AttributeError("'{}' object has no attribute '{}'".format(
AttributeError: 'UNDCLitModule' object has no attribute 'val_float'
[2022-12-09 09:24:44,087][src.utils.utils][INFO] - Closing loggers...
[2022-12-09 09:25:19,139][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-09 09:25:19,145][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-09 09:25:19,146][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-09 09:25:19,206][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-09 09:25:19,825][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2022-12-09 09:25:19,910][__main__][INFO] - Instantiating callbacks...
[2022-12-09 09:25:19,911][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-09 09:25:19,918][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-09 09:25:19,920][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-09 09:25:19,922][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-09 09:25:19,923][__main__][INFO] - Instantiating loggers...
[2022-12-09 09:25:19,923][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-09 09:25:19,923][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-09 09:25:59,695][__main__][INFO] - Starting training!
[2022-12-09 09:26:05,280][src.datamodules.undc_pc_datamodule][INFO] - Loading Train dataset...
[2022-12-09 09:26:05,283][src.datamodules.undc_pc_datamodule][INFO] - Train dataset [ABC_pc_hdf5] of size 106 had been created.
[2022-12-09 09:26:05,283][src.datamodules.undc_pc_datamodule][INFO] - Loading Val dataset...
[2022-12-09 09:26:05,285][src.datamodules.undc_pc_datamodule][INFO] - Val dataset [ABC_pc_hdf5] of size 54 had been created.
[2022-12-09 09:26:05,285][src.datamodules.undc_pc_datamodule][INFO] - Loading Test dataset...
[2022-12-09 09:26:05,286][src.datamodules.undc_pc_datamodule][INFO] - Test dataset [ABC_pc_hdf5] of size 54 had been created.
[2022-12-09 09:26:43,809][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 98, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1285, in _run_train
    self.fit_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 201, in run
    self.on_advance_end()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/fit_loop.py", line 307, in on_advance_end
    self.epoch_loop.update_lr_schedulers("epoch", update_plateau_schedulers=True)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 421, in update_lr_schedulers
    self._update_learning_rates(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 466, in _update_learning_rates
    raise MisconfigurationException(
pytorch_lightning.utilities.exceptions.MisconfigurationException: ReduceLROnPlateau conditioned on metric val/float_loss which is not available. Available metrics are: ['val/bool_loss', 'val/bool_acc', 'val/acc_bool_best', 'train/bool_loss', 'train/bool_acc']. Condition can be set using `monitor` key in lr scheduler dict
[2022-12-09 09:26:43,813][src.utils.utils][INFO] - Closing loggers...
[2022-12-09 09:28:47,323][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-09 09:28:47,329][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-09 09:28:47,330][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-09 09:28:47,392][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-09 09:28:48,054][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2022-12-09 09:28:48,133][__main__][INFO] - Instantiating callbacks...
[2022-12-09 09:28:48,134][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-09 09:28:48,138][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-09 09:28:48,140][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-09 09:28:48,141][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-09 09:28:48,142][__main__][INFO] - Instantiating loggers...
[2022-12-09 09:28:48,142][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-09 09:28:48,142][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-09 09:29:28,766][__main__][INFO] - Starting training!
[2022-12-09 09:29:34,488][src.datamodules.undc_pc_datamodule][INFO] - Loading Train dataset...
[2022-12-09 09:29:34,492][src.datamodules.undc_pc_datamodule][INFO] - Train dataset [ABC_pc_hdf5] of size 106 had been created.
[2022-12-09 09:29:34,492][src.datamodules.undc_pc_datamodule][INFO] - Loading Val dataset...
[2022-12-09 09:29:34,494][src.datamodules.undc_pc_datamodule][INFO] - Val dataset [ABC_pc_hdf5] of size 54 had been created.
[2022-12-09 09:29:34,494][src.datamodules.undc_pc_datamodule][INFO] - Loading Test dataset...
[2022-12-09 09:29:34,496][src.datamodules.undc_pc_datamodule][INFO] - Test dataset [ABC_pc_hdf5] of size 54 had been created.
[2022-12-09 09:37:01,890][__main__][INFO] - Starting testing!
[2022-12-09 09:37:02,366][__main__][INFO] - Best ckpt path: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-09_09-28-47/checkpoints/epoch_011.ckpt
[2022-12-09 09:37:02,370][src.utils.utils][INFO] - Closing loggers...
[2022-12-09 09:37:02,372][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-09_09-28-47
[2022-12-09 09:37:02,372][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-12-09 09:37:23,680][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-09 09:37:23,686][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-09 09:37:23,687][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-09 09:37:23,747][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-09 09:37:24,276][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2022-12-09 09:37:24,340][__main__][INFO] - Instantiating callbacks...
[2022-12-09 09:37:24,341][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-09 09:37:24,344][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-09 09:37:24,346][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-09 09:37:24,347][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-09 09:37:24,347][__main__][INFO] - Instantiating loggers...
[2022-12-09 09:37:24,348][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-09 09:37:24,348][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-09 09:38:05,309][__main__][INFO] - Starting training!
[2022-12-09 09:38:11,163][src.datamodules.undc_pc_datamodule][INFO] - Loading Train dataset...
[2022-12-09 09:38:11,169][src.datamodules.undc_pc_datamodule][INFO] - Train dataset [ABC_pc_hdf5] of size 8560 had been created.
[2022-12-09 09:38:11,170][src.datamodules.undc_pc_datamodule][INFO] - Loading Val dataset...
[2022-12-09 09:38:11,173][src.datamodules.undc_pc_datamodule][INFO] - Val dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-12-09 09:38:11,173][src.datamodules.undc_pc_datamodule][INFO] - Loading Test dataset...
[2022-12-09 09:38:11,176][src.datamodules.undc_pc_datamodule][INFO] - Test dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-12-09 09:40:46,227][__main__][INFO] - Starting testing!
[2022-12-09 09:40:46,296][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2022-12-09 09:40:49,823][__main__][INFO] - Best ckpt path: None
[2022-12-09 09:40:49,832][src.utils.utils][INFO] - Closing loggers...
[2022-12-09 09:40:49,836][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-09_09-37-23
[2022-12-09 09:40:49,837][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-12-09 10:02:25,633][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-09 10:02:25,640][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-09 10:02:25,640][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-09 10:02:25,701][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-09 10:02:26,283][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2022-12-09 10:02:26,383][__main__][INFO] - Instantiating callbacks...
[2022-12-09 10:02:26,384][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-09 10:02:26,389][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-09 10:02:26,391][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-09 10:02:26,392][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-09 10:02:26,393][__main__][INFO] - Instantiating loggers...
[2022-12-09 10:02:26,394][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-09 10:02:26,394][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-09 10:02:37,884][src.utils.utils][INFO] - Closing loggers...
[2022-12-09 10:03:05,873][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-09 10:03:05,880][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-09 10:03:05,881][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-09 10:03:05,944][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-09 10:03:06,595][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2022-12-09 10:03:06,626][__main__][INFO] - Instantiating callbacks...
[2022-12-09 10:03:06,626][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-09 10:03:06,630][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-09 10:03:06,631][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-09 10:03:06,632][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-09 10:03:06,633][__main__][INFO] - Instantiating loggers...
[2022-12-09 10:03:06,633][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-09 10:03:06,633][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-09 10:03:47,577][__main__][INFO] - Starting training!
[2022-12-09 10:03:52,742][src.datamodules.undc_pc_datamodule][INFO] - Loading Train dataset...
[2022-12-09 10:03:52,745][src.datamodules.undc_pc_datamodule][INFO] - Train dataset [ABC_pc_hdf5] of size 8560 had been created.
[2022-12-09 10:03:52,746][src.datamodules.undc_pc_datamodule][INFO] - Loading Val dataset...
[2022-12-09 10:03:52,747][src.datamodules.undc_pc_datamodule][INFO] - Val dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-12-09 10:03:52,747][src.datamodules.undc_pc_datamodule][INFO] - Loading Test dataset...
[2022-12-09 10:03:52,748][src.datamodules.undc_pc_datamodule][INFO] - Test dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-12-09 10:22:01,931][__main__][INFO] - Starting testing!
[2022-12-09 10:22:02,368][__main__][INFO] - Best ckpt path: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-09_10-03-05/checkpoints/epoch_000.ckpt
[2022-12-09 10:22:02,372][src.utils.utils][INFO] - Closing loggers...
[2022-12-09 10:22:02,373][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-09_10-03-05
[2022-12-09 10:22:02,374][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-12-09 11:24:48,790][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-09 11:24:48,797][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-09 11:24:48,798][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-09 11:24:48,859][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-09 11:24:49,478][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2022-12-09 11:24:49,514][__main__][INFO] - Instantiating callbacks...
[2022-12-09 11:24:49,514][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-09 11:24:49,519][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-09 11:24:49,520][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-09 11:24:49,521][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-09 11:24:49,522][__main__][INFO] - Instantiating loggers...
[2022-12-09 11:24:49,522][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-09 11:24:49,523][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-09 11:25:29,251][__main__][INFO] - Starting training!
[2022-12-09 11:25:34,918][src.datamodules.undc_pc_datamodule][INFO] - Loading Train dataset...
[2022-12-09 11:25:34,923][src.datamodules.undc_pc_datamodule][INFO] - Train dataset [ABC_pc_hdf5] of size 8560 had been created.
[2022-12-09 11:25:34,923][src.datamodules.undc_pc_datamodule][INFO] - Loading Val dataset...
[2022-12-09 11:25:34,925][src.datamodules.undc_pc_datamodule][INFO] - Val dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-12-09 11:25:34,925][src.datamodules.undc_pc_datamodule][INFO] - Loading Test dataset...
[2022-12-09 11:25:34,926][src.datamodules.undc_pc_datamodule][INFO] - Test dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-12-09 11:25:39,849][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 98, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_train
    self._run_sanity_check()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1345, in _run_sanity_check
    val_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 155, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 143, in advance
    output = self._evaluation_step(**kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 240, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1706, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 370, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/home/fubao/dev/my-ndc/src/models/undc_module2.py", line 132, in validation_step
    self.gen_obj(pred_bool, pred_float, batch, batch_idx)
TypeError: gen_obj() takes 4 positional arguments but 5 were given
[2022-12-09 11:25:39,857][src.utils.utils][INFO] - Closing loggers...
[2022-12-09 11:26:59,909][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-09 11:26:59,916][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-09 11:26:59,917][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-09 11:26:59,976][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-09 11:27:00,611][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2022-12-09 11:27:00,646][__main__][INFO] - Instantiating callbacks...
[2022-12-09 11:27:00,646][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-09 11:27:00,651][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-09 11:27:00,652][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-09 11:27:00,653][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-09 11:27:00,654][__main__][INFO] - Instantiating loggers...
[2022-12-09 11:27:00,654][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-09 11:27:00,655][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-09 11:27:41,581][__main__][INFO] - Starting training!
[2022-12-09 11:27:46,790][src.datamodules.undc_pc_datamodule][INFO] - Loading Train dataset...
[2022-12-09 11:27:46,793][src.datamodules.undc_pc_datamodule][INFO] - Train dataset [ABC_pc_hdf5] of size 8560 had been created.
[2022-12-09 11:27:46,793][src.datamodules.undc_pc_datamodule][INFO] - Loading Val dataset...
[2022-12-09 11:27:46,795][src.datamodules.undc_pc_datamodule][INFO] - Val dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-12-09 11:27:46,795][src.datamodules.undc_pc_datamodule][INFO] - Loading Test dataset...
[2022-12-09 11:27:46,796][src.datamodules.undc_pc_datamodule][INFO] - Test dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-12-09 11:59:46,356][__main__][INFO] - Starting testing!
[2022-12-09 11:59:46,798][__main__][INFO] - Best ckpt path: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-09_11-26-59/checkpoints/epoch_001.ckpt
[2022-12-09 11:59:46,802][src.utils.utils][INFO] - Closing loggers...
[2022-12-09 11:59:46,804][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-09_11-26-59
[2022-12-09 11:59:46,805][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-12-09 12:00:29,481][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-09 12:00:29,487][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-09 12:00:29,488][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-09 12:00:29,563][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-09 12:00:30,159][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-12-09 12:00:30,164][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
TypeError: __init__() got an unexpected keyword argument 'out_bool'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 72, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 334, in instantiate_node
    value = instantiate_node(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 339, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.models.components.undc_pc_net.local_pointnet':
TypeError("__init__() got an unexpected keyword argument 'out_bool'")
full_key: model.net
[2022-12-09 12:00:30,166][src.utils.utils][INFO] - Closing loggers...
[2022-12-09 12:01:11,474][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-09 12:01:11,480][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-09 12:01:11,481][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-09 12:01:11,548][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-09 12:01:12,193][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-12-09 12:01:12,228][__main__][INFO] - Instantiating callbacks...
[2022-12-09 12:01:12,228][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-09 12:01:12,233][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-09 12:01:12,234][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-09 12:01:12,235][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-09 12:01:12,236][__main__][INFO] - Instantiating loggers...
[2022-12-09 12:01:12,236][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-09 12:01:12,237][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-09 12:01:53,299][__main__][INFO] - Starting training!
[2022-12-09 12:01:59,001][src.datamodules.undc_pc_datamodule][INFO] - Loading Train dataset...
[2022-12-09 12:01:59,007][src.datamodules.undc_pc_datamodule][INFO] - Train dataset [ABC_pc_hdf5] of size 8560 had been created.
[2022-12-09 12:01:59,007][src.datamodules.undc_pc_datamodule][INFO] - Loading Val dataset...
[2022-12-09 12:01:59,010][src.datamodules.undc_pc_datamodule][INFO] - Val dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-12-09 12:01:59,010][src.datamodules.undc_pc_datamodule][INFO] - Loading Test dataset...
[2022-12-09 12:01:59,012][src.datamodules.undc_pc_datamodule][INFO] - Test dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-12-09 12:50:34,063][__main__][INFO] - Starting testing!
[2022-12-09 12:50:34,630][__main__][INFO] - Best ckpt path: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-09_12-01-11/checkpoints/epoch_002.ckpt
[2022-12-09 12:50:34,634][src.utils.utils][INFO] - Closing loggers...
[2022-12-09 12:50:34,636][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-09_12-01-11
[2022-12-09 12:50:34,637][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-12-09 12:50:49,804][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-09 12:50:49,811][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-09 12:50:49,811][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-09 12:50:49,875][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-09 12:50:50,568][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2022-12-09 12:50:50,605][__main__][INFO] - Instantiating callbacks...
[2022-12-09 12:50:50,606][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-09 12:50:50,610][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-09 12:50:50,612][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-09 12:50:50,613][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-09 12:50:50,614][__main__][INFO] - Instantiating loggers...
[2022-12-09 12:50:50,614][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-09 12:50:50,614][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-09 12:51:30,633][__main__][INFO] - Starting training!
[2022-12-09 12:51:36,324][src.datamodules.undc_pc_datamodule][INFO] - Loading Train dataset...
[2022-12-09 12:51:36,330][src.datamodules.undc_pc_datamodule][INFO] - Train dataset [ABC_pc_hdf5] of size 8560 had been created.
[2022-12-09 12:51:36,330][src.datamodules.undc_pc_datamodule][INFO] - Loading Val dataset...
[2022-12-09 12:51:36,332][src.datamodules.undc_pc_datamodule][INFO] - Val dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-12-09 12:51:36,333][src.datamodules.undc_pc_datamodule][INFO] - Loading Test dataset...
[2022-12-09 12:51:36,335][src.datamodules.undc_pc_datamodule][INFO] - Test dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-12-09 12:51:41,112][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 98, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_train
    self._run_sanity_check()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1345, in _run_sanity_check
    val_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 155, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 143, in advance
    output = self._evaluation_step(**kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 240, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1706, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 370, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/home/fubao/dev/my-ndc/src/models/undc_module2.py", line 129, in validation_step
    self.gen_obj(pred_bool, pred_float, batch)
  File "/home/fubao/dev/my-ndc/src/models/undc_module2.py", line 215, in gen_obj
    self.generate_obj_test(voxel_xyz_int,gt_output_bool,gt_output_float, "gt")
  File "/home/fubao/dev/my-ndc/src/models/undc_module2.py", line 191, in generate_obj_test
    pred_bool_grid[voxel_xyz_int[:,0],voxel_xyz_int[:,1],voxel_xyz_int[:,2]] = pred_bool
RuntimeError: Index put requires the source and destination dtypes match, got Int for the destination and Float for the source.
[2022-12-09 12:51:41,118][src.utils.utils][INFO] - Closing loggers...
[2022-12-09 12:53:22,288][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-09 12:53:22,294][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-09 12:53:22,295][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-09 12:53:22,354][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-09 12:53:22,816][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2022-12-09 12:53:22,844][__main__][INFO] - Instantiating callbacks...
[2022-12-09 12:53:22,845][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-09 12:53:22,848][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-09 12:53:22,850][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-09 12:53:22,850][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-09 12:53:22,851][__main__][INFO] - Instantiating loggers...
[2022-12-09 12:53:22,852][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-09 12:53:22,852][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-09 12:54:02,610][__main__][INFO] - Starting training!
[2022-12-09 12:54:07,814][src.datamodules.undc_pc_datamodule][INFO] - Loading Train dataset...
[2022-12-09 12:54:07,818][src.datamodules.undc_pc_datamodule][INFO] - Train dataset [ABC_pc_hdf5] of size 8560 had been created.
[2022-12-09 12:54:07,818][src.datamodules.undc_pc_datamodule][INFO] - Loading Val dataset...
[2022-12-09 12:54:07,819][src.datamodules.undc_pc_datamodule][INFO] - Val dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-12-09 12:54:07,820][src.datamodules.undc_pc_datamodule][INFO] - Loading Test dataset...
[2022-12-09 12:54:07,821][src.datamodules.undc_pc_datamodule][INFO] - Test dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-12-09 13:10:40,748][__main__][INFO] - Starting testing!
[2022-12-09 13:10:41,404][__main__][INFO] - Best ckpt path: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-09_12-53-22/checkpoints/epoch_000.ckpt
[2022-12-09 13:10:41,410][src.utils.utils][INFO] - Closing loggers...
[2022-12-09 13:10:41,413][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-09_12-53-22
[2022-12-09 13:10:41,414][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-12-09 13:14:56,089][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-09 13:14:56,096][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-09 13:14:56,096][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-09 13:14:56,159][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-09 13:14:56,804][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2022-12-09 13:14:56,839][__main__][INFO] - Instantiating callbacks...
[2022-12-09 13:14:56,840][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-09 13:14:56,844][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-09 13:14:56,846][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-09 13:14:56,847][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-09 13:14:56,847][__main__][INFO] - Instantiating loggers...
[2022-12-09 13:14:56,848][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-09 13:14:56,848][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-09 13:15:37,427][__main__][INFO] - Starting training!
[2022-12-09 13:15:43,139][src.datamodules.undc_pc_datamodule][INFO] - Loading Train dataset...
[2022-12-09 13:15:43,144][src.datamodules.undc_pc_datamodule][INFO] - Train dataset [ABC_pc_hdf5] of size 8560 had been created.
[2022-12-09 13:15:43,145][src.datamodules.undc_pc_datamodule][INFO] - Loading Val dataset...
[2022-12-09 13:15:43,147][src.datamodules.undc_pc_datamodule][INFO] - Val dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-12-09 13:15:43,147][src.datamodules.undc_pc_datamodule][INFO] - Loading Test dataset...
[2022-12-09 13:15:43,149][src.datamodules.undc_pc_datamodule][INFO] - Test dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-12-09 13:15:48,008][src.utils.utils][INFO] - Closing loggers...
[2022-12-09 13:16:10,320][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-09 13:16:10,327][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-09 13:16:10,327][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-09 13:16:10,387][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-09 13:16:11,008][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-12-09 13:16:11,043][__main__][INFO] - Instantiating callbacks...
[2022-12-09 13:16:11,043][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-09 13:16:11,047][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-09 13:16:11,049][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-09 13:16:11,050][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-09 13:16:11,050][__main__][INFO] - Instantiating loggers...
[2022-12-09 13:16:11,051][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-09 13:16:11,051][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-09 13:16:52,206][__main__][INFO] - Starting training!
[2022-12-09 13:16:57,548][src.datamodules.undc_pc_datamodule][INFO] - Loading Train dataset...
[2022-12-09 13:16:57,552][src.datamodules.undc_pc_datamodule][INFO] - Train dataset [ABC_pc_hdf5] of size 8560 had been created.
[2022-12-09 13:16:57,552][src.datamodules.undc_pc_datamodule][INFO] - Loading Val dataset...
[2022-12-09 13:16:57,553][src.datamodules.undc_pc_datamodule][INFO] - Val dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-12-09 13:16:57,554][src.datamodules.undc_pc_datamodule][INFO] - Loading Test dataset...
[2022-12-09 13:16:57,555][src.datamodules.undc_pc_datamodule][INFO] - Test dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-12-09 13:17:02,048][src.utils.utils][INFO] - Closing loggers...
[2022-12-09 13:34:28,719][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-09 13:34:28,725][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-09 13:34:28,726][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-09 13:34:28,784][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-09 13:34:29,409][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2022-12-09 13:34:29,438][__main__][INFO] - Instantiating callbacks...
[2022-12-09 13:34:29,439][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-09 13:34:29,442][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-09 13:34:29,444][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-09 13:34:29,445][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-09 13:34:29,446][__main__][INFO] - Instantiating loggers...
[2022-12-09 13:34:29,446][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-09 13:34:29,446][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-09 13:35:10,183][__main__][INFO] - Starting training!
[2022-12-09 13:35:15,609][src.datamodules.undc_pc_datamodule][INFO] - Loading Train dataset...
[2022-12-09 13:35:15,612][src.datamodules.undc_pc_datamodule][INFO] - Train dataset [ABC_pc_hdf5] of size 106 had been created.
[2022-12-09 13:35:15,612][src.datamodules.undc_pc_datamodule][INFO] - Loading Val dataset...
[2022-12-09 13:35:15,613][src.datamodules.undc_pc_datamodule][INFO] - Val dataset [ABC_pc_hdf5] of size 54 had been created.
[2022-12-09 13:35:15,614][src.datamodules.undc_pc_datamodule][INFO] - Loading Test dataset...
[2022-12-09 13:35:15,615][src.datamodules.undc_pc_datamodule][INFO] - Test dataset [ABC_pc_hdf5] of size 54 had been created.
[2022-12-09 13:37:27,668][__main__][INFO] - Starting testing!
[2022-12-09 13:37:29,670][__main__][INFO] - Best ckpt path: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-09_13-34-28/checkpoints/epoch_005.ckpt
[2022-12-09 13:37:29,675][src.utils.utils][INFO] - Closing loggers...
[2022-12-09 13:37:29,677][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-09_13-34-28
[2022-12-09 13:37:29,677][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-12-09 13:40:27,481][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-09 13:40:27,488][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-09 13:40:27,488][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-09 13:40:27,549][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-09 13:40:28,128][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2022-12-09 13:40:28,163][__main__][INFO] - Instantiating callbacks...
[2022-12-09 13:40:28,164][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-09 13:40:28,168][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-09 13:40:28,169][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-09 13:40:28,170][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-09 13:40:28,171][__main__][INFO] - Instantiating loggers...
[2022-12-09 13:40:28,171][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-09 13:40:28,172][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-09 13:41:08,466][__main__][INFO] - Starting training!
[2022-12-09 13:41:13,537][src.datamodules.undc_pc_datamodule][INFO] - Loading Train dataset...
[2022-12-09 13:41:13,540][src.datamodules.undc_pc_datamodule][INFO] - Train dataset [ABC_pc_hdf5] of size 106 had been created.
[2022-12-09 13:41:13,540][src.datamodules.undc_pc_datamodule][INFO] - Loading Val dataset...
[2022-12-09 13:41:13,541][src.datamodules.undc_pc_datamodule][INFO] - Val dataset [ABC_pc_hdf5] of size 54 had been created.
[2022-12-09 13:41:13,541][src.datamodules.undc_pc_datamodule][INFO] - Loading Test dataset...
[2022-12-09 13:41:13,543][src.datamodules.undc_pc_datamodule][INFO] - Test dataset [ABC_pc_hdf5] of size 54 had been created.
[2022-12-09 13:42:40,909][__main__][INFO] - Starting testing!
[2022-12-09 13:42:42,649][__main__][INFO] - Best ckpt path: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-09_13-40-27/checkpoints/epoch_003.ckpt
[2022-12-09 13:42:42,658][src.utils.utils][INFO] - Closing loggers...
[2022-12-09 13:42:42,661][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-09_13-40-27
[2022-12-09 13:42:42,662][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-12-09 13:46:05,784][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-09 13:46:05,791][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-09 13:46:05,791][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-09 13:46:05,869][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-09 13:46:06,538][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2022-12-09 13:46:06,619][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "/home/fubao/dev/my-ndc/src/models/undc_module2.py", line 38, in __init__
    net_bool.load_state_dict("./weights/net_bool.pth")
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1559, in load_state_dict
    raise TypeError("Expected state_dict to be dict-like, got {}.".format(type(state_dict)))
TypeError: Expected state_dict to be dict-like, got <class 'str'>.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 72, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 339, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.models.undc_module2.UNDCLitModule':
TypeError("Expected state_dict to be dict-like, got <class 'str'>.")
full_key: model
[2022-12-09 13:46:06,624][src.utils.utils][INFO] - Closing loggers...
[2022-12-09 13:47:47,035][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-09 13:47:47,041][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-09 13:47:47,042][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-09 13:47:47,105][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-09 13:47:47,732][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2022-12-09 13:47:55,180][__main__][INFO] - Instantiating callbacks...
[2022-12-09 13:47:55,181][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-09 13:47:55,186][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-09 13:47:55,188][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-09 13:47:55,189][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-09 13:47:55,190][__main__][INFO] - Instantiating loggers...
[2022-12-09 13:47:55,190][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-09 13:47:55,190][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-09 13:47:55,586][__main__][INFO] - Starting training!
[2022-12-09 13:47:55,627][src.datamodules.undc_pc_datamodule][INFO] - Loading Train dataset...
[2022-12-09 13:47:55,630][src.datamodules.undc_pc_datamodule][INFO] - Train dataset [ABC_pc_hdf5] of size 106 had been created.
[2022-12-09 13:47:55,630][src.datamodules.undc_pc_datamodule][INFO] - Loading Val dataset...
[2022-12-09 13:47:55,632][src.datamodules.undc_pc_datamodule][INFO] - Val dataset [ABC_pc_hdf5] of size 54 had been created.
[2022-12-09 13:47:55,632][src.datamodules.undc_pc_datamodule][INFO] - Loading Test dataset...
[2022-12-09 13:47:55,633][src.datamodules.undc_pc_datamodule][INFO] - Test dataset [ABC_pc_hdf5] of size 54 had been created.
[2022-12-09 13:48:19,942][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 98, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1285, in _run_train
    self.fit_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 201, in run
    self.on_advance_end()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/fit_loop.py", line 298, in on_advance_end
    self.trainer._call_callback_hooks("on_train_epoch_end")
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1599, in _call_callback_hooks
    fn(self, self.lightning_module, *args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/callbacks/early_stopping.py", line 183, in on_train_epoch_end
    self._run_early_stopping_check(trainer)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/callbacks/early_stopping.py", line 194, in _run_early_stopping_check
    if trainer.fast_dev_run or not self._validate_condition_metric(  # disable early_stopping with fast_dev_run
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/callbacks/early_stopping.py", line 149, in _validate_condition_metric
    raise RuntimeError(error_msg)
RuntimeError: Early stopping conditioned on metric `val/bool_acc` which is not available. Pass in or modify your `EarlyStopping` callback to use any of the following: `val/float_loss`, `val/acc_bool_best`, `train/float_loss`
[2022-12-09 13:48:19,947][src.utils.utils][INFO] - Closing loggers...
[2022-12-09 13:49:53,972][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-09 13:49:53,979][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-09 13:49:53,979][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-09 13:49:54,041][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-09 13:49:54,616][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2022-12-09 13:50:02,252][__main__][INFO] - Instantiating callbacks...
[2022-12-09 13:50:02,253][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-09 13:50:02,259][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-09 13:50:02,261][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-09 13:50:02,261][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-09 13:50:02,262][__main__][INFO] - Instantiating loggers...
[2022-12-09 13:50:02,263][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-09 13:50:02,263][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-09 13:50:02,688][__main__][INFO] - Starting training!
[2022-12-09 13:50:02,725][src.datamodules.undc_pc_datamodule][INFO] - Loading Train dataset...
[2022-12-09 13:50:02,727][src.datamodules.undc_pc_datamodule][INFO] - Train dataset [ABC_pc_hdf5] of size 106 had been created.
[2022-12-09 13:50:02,728][src.datamodules.undc_pc_datamodule][INFO] - Loading Val dataset...
[2022-12-09 13:50:02,729][src.datamodules.undc_pc_datamodule][INFO] - Val dataset [ABC_pc_hdf5] of size 54 had been created.
[2022-12-09 13:50:02,729][src.datamodules.undc_pc_datamodule][INFO] - Loading Test dataset...
[2022-12-09 13:50:02,731][src.datamodules.undc_pc_datamodule][INFO] - Test dataset [ABC_pc_hdf5] of size 54 had been created.
[2022-12-09 13:50:27,586][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 98, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1285, in _run_train
    self.fit_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 201, in run
    self.on_advance_end()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/fit_loop.py", line 298, in on_advance_end
    self.trainer._call_callback_hooks("on_train_epoch_end")
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1599, in _call_callback_hooks
    fn(self, self.lightning_module, *args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/callbacks/early_stopping.py", line 183, in on_train_epoch_end
    self._run_early_stopping_check(trainer)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/callbacks/early_stopping.py", line 194, in _run_early_stopping_check
    if trainer.fast_dev_run or not self._validate_condition_metric(  # disable early_stopping with fast_dev_run
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/callbacks/early_stopping.py", line 149, in _validate_condition_metric
    raise RuntimeError(error_msg)
RuntimeError: Early stopping conditioned on metric `val/float_acc` which is not available. Pass in or modify your `EarlyStopping` callback to use any of the following: `val/float_loss`, `val/acc_bool_best`, `train/float_loss`
[2022-12-09 13:50:27,592][src.utils.utils][INFO] - Closing loggers...
[2022-12-09 13:51:02,968][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-09 13:51:02,974][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-09 13:51:02,975][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-09 13:51:03,037][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-09 13:51:03,628][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2022-12-09 13:51:10,140][__main__][INFO] - Instantiating callbacks...
[2022-12-09 13:51:10,142][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-09 13:51:10,150][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-09 13:51:10,151][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-09 13:51:10,152][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-09 13:51:10,153][__main__][INFO] - Instantiating loggers...
[2022-12-09 13:51:10,153][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-09 13:51:10,154][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-09 13:51:10,525][__main__][INFO] - Starting training!
[2022-12-09 13:51:10,569][src.datamodules.undc_pc_datamodule][INFO] - Loading Train dataset...
[2022-12-09 13:51:10,571][src.datamodules.undc_pc_datamodule][INFO] - Train dataset [ABC_pc_hdf5] of size 106 had been created.
[2022-12-09 13:51:10,572][src.datamodules.undc_pc_datamodule][INFO] - Loading Val dataset...
[2022-12-09 13:51:10,573][src.datamodules.undc_pc_datamodule][INFO] - Val dataset [ABC_pc_hdf5] of size 54 had been created.
[2022-12-09 13:51:10,574][src.datamodules.undc_pc_datamodule][INFO] - Loading Test dataset...
[2022-12-09 13:51:10,575][src.datamodules.undc_pc_datamodule][INFO] - Test dataset [ABC_pc_hdf5] of size 54 had been created.
[2022-12-09 13:52:59,087][__main__][INFO] - Starting testing!
[2022-12-09 13:53:00,740][__main__][INFO] - Best ckpt path: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-09_13-51-02/checkpoints/epoch_000.ckpt
[2022-12-09 13:53:00,746][src.utils.utils][INFO] - Closing loggers...
[2022-12-09 13:53:00,748][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-09_13-51-02
[2022-12-09 13:53:00,748][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-12-09 13:58:55,268][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-09 13:58:55,275][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-09 13:58:55,275][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-09 13:58:55,340][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-09 13:58:55,964][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2022-12-09 13:59:03,494][__main__][INFO] - Instantiating callbacks...
[2022-12-09 13:59:03,496][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-09 13:59:03,501][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-09 13:59:03,503][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-09 13:59:03,504][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-09 13:59:03,504][__main__][INFO] - Instantiating loggers...
[2022-12-09 13:59:03,505][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-09 13:59:03,505][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-09 13:59:03,925][__main__][INFO] - Starting training!
[2022-12-09 13:59:03,931][src.datamodules.undc_pc_datamodule][INFO] - Loading Train dataset...
[2022-12-09 13:59:03,934][src.datamodules.undc_pc_datamodule][INFO] - Train dataset [ABC_pc_hdf5] of size 106 had been created.
[2022-12-09 13:59:03,935][src.datamodules.undc_pc_datamodule][INFO] - Loading Val dataset...
[2022-12-09 13:59:03,937][src.datamodules.undc_pc_datamodule][INFO] - Val dataset [ABC_pc_hdf5] of size 54 had been created.
[2022-12-09 13:59:03,938][src.datamodules.undc_pc_datamodule][INFO] - Loading Test dataset...
[2022-12-09 13:59:03,940][src.datamodules.undc_pc_datamodule][INFO] - Test dataset [ABC_pc_hdf5] of size 54 had been created.
[2022-12-09 14:00:06,093][__main__][INFO] - Starting testing!
[2022-12-09 14:00:08,221][__main__][INFO] - Best ckpt path: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-09_13-58-55/checkpoints/epoch_000.ckpt
[2022-12-09 14:00:08,230][src.utils.utils][INFO] - Closing loggers...
[2022-12-09 14:00:08,233][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-09_13-58-55
[2022-12-09 14:00:08,234][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-12-09 14:01:52,034][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-09 14:01:52,041][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-09 14:01:52,041][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-09 14:01:52,105][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-09 14:01:52,736][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2022-12-09 14:01:58,314][src.utils.utils][INFO] - Closing loggers...
[2022-12-09 14:05:14,744][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-09 14:05:14,751][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-09 14:05:14,751][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-09 14:05:14,813][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-09 14:05:15,400][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2022-12-09 14:05:22,247][__main__][INFO] - Instantiating callbacks...
[2022-12-09 14:05:22,249][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-09 14:05:22,257][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-09 14:05:22,258][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-09 14:05:22,259][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-09 14:05:22,260][__main__][INFO] - Instantiating loggers...
[2022-12-09 14:05:22,260][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-09 14:05:22,261][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-09 14:05:22,795][__main__][INFO] - Starting training!
[2022-12-09 14:05:22,801][src.datamodules.undc_pc_datamodule][INFO] - Loading Train dataset...
[2022-12-09 14:05:22,803][src.datamodules.undc_pc_datamodule][INFO] - Train dataset [ABC_pc_hdf5] of size 106 had been created.
[2022-12-09 14:05:22,804][src.datamodules.undc_pc_datamodule][INFO] - Loading Val dataset...
[2022-12-09 14:05:22,806][src.datamodules.undc_pc_datamodule][INFO] - Val dataset [ABC_pc_hdf5] of size 54 had been created.
[2022-12-09 14:05:22,806][src.datamodules.undc_pc_datamodule][INFO] - Loading Test dataset...
[2022-12-09 14:05:22,808][src.datamodules.undc_pc_datamodule][INFO] - Test dataset [ABC_pc_hdf5] of size 54 had been created.
[2022-12-09 14:06:57,034][__main__][INFO] - Starting testing!
[2022-12-09 14:06:58,593][__main__][INFO] - Best ckpt path: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-09_14-05-14/checkpoints/epoch_000.ckpt
[2022-12-09 14:06:58,599][src.utils.utils][INFO] - Closing loggers...
[2022-12-09 14:06:58,601][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-09_14-05-14
[2022-12-09 14:06:58,601][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-12-09 14:07:59,320][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-09 14:07:59,327][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-09 14:07:59,327][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-09 14:07:59,388][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-09 14:07:59,985][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2022-12-09 14:08:00,014][__main__][INFO] - Instantiating callbacks...
[2022-12-09 14:08:00,014][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-09 14:08:00,018][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-09 14:08:00,020][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-09 14:08:00,021][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-09 14:08:00,021][__main__][INFO] - Instantiating loggers...
[2022-12-09 14:08:00,022][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-09 14:08:00,022][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-09 14:08:40,030][__main__][INFO] - Starting training!
[2022-12-09 14:08:45,246][src.datamodules.undc_pc_datamodule][INFO] - Loading Train dataset...
[2022-12-09 14:08:45,250][src.datamodules.undc_pc_datamodule][INFO] - Train dataset [ABC_pc_hdf5] of size 8560 had been created.
[2022-12-09 14:08:45,250][src.datamodules.undc_pc_datamodule][INFO] - Loading Val dataset...
[2022-12-09 14:08:45,252][src.datamodules.undc_pc_datamodule][INFO] - Val dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-12-09 14:08:45,252][src.datamodules.undc_pc_datamodule][INFO] - Loading Test dataset...
[2022-12-09 14:08:45,253][src.datamodules.undc_pc_datamodule][INFO] - Test dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-12-09 14:24:57,358][__main__][INFO] - Starting testing!
[2022-12-09 14:25:05,941][__main__][INFO] - Best ckpt path: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-09_14-07-59/checkpoints/epoch_000.ckpt
[2022-12-09 14:25:05,946][src.utils.utils][INFO] - Closing loggers...
[2022-12-09 14:25:05,948][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-09_14-07-59
[2022-12-09 14:25:05,949][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-12-09 14:25:43,883][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-09 14:25:43,890][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-09 14:25:43,890][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-09 14:25:43,953][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-09 14:25:44,500][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2022-12-09 14:25:44,531][__main__][INFO] - Instantiating callbacks...
[2022-12-09 14:25:44,531][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-09 14:25:44,535][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-09 14:25:44,536][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-09 14:25:44,537][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-09 14:25:44,538][__main__][INFO] - Instantiating loggers...
[2022-12-09 14:25:44,538][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-09 14:25:44,539][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-09 14:26:24,461][__main__][INFO] - Starting training!
[2022-12-09 14:26:29,786][src.datamodules.undc_pc_datamodule][INFO] - Loading Train dataset...
[2022-12-09 14:26:29,790][src.datamodules.undc_pc_datamodule][INFO] - Train dataset [ABC_pc_hdf5] of size 8560 had been created.
[2022-12-09 14:26:29,790][src.datamodules.undc_pc_datamodule][INFO] - Loading Val dataset...
[2022-12-09 14:26:29,792][src.datamodules.undc_pc_datamodule][INFO] - Val dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-12-09 14:26:29,792][src.datamodules.undc_pc_datamodule][INFO] - Loading Test dataset...
[2022-12-09 14:26:29,793][src.datamodules.undc_pc_datamodule][INFO] - Test dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-12-09 14:27:23,289][__main__][INFO] - Starting testing!
[2022-12-09 14:27:25,843][__main__][INFO] - Best ckpt path: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-09_14-07-59/checkpoints/epoch_000.ckpt
[2022-12-09 14:27:25,850][src.utils.utils][INFO] - Closing loggers...
[2022-12-09 14:27:25,852][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-09_14-25-43
[2022-12-09 14:27:25,853][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-12-09 14:27:53,021][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-09 14:27:53,028][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-09 14:27:53,028][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-09 14:27:53,089][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-09 14:27:53,707][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2022-12-09 14:28:00,798][__main__][INFO] - Instantiating callbacks...
[2022-12-09 14:28:00,799][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-09 14:28:00,804][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-09 14:28:00,806][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-09 14:28:00,807][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-09 14:28:00,807][__main__][INFO] - Instantiating loggers...
[2022-12-09 14:28:00,808][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-09 14:28:00,808][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-09 14:28:01,260][__main__][INFO] - Starting training!
[2022-12-09 14:28:01,265][src.datamodules.undc_pc_datamodule][INFO] - Loading Train dataset...
[2022-12-09 14:28:01,269][src.datamodules.undc_pc_datamodule][INFO] - Train dataset [ABC_pc_hdf5] of size 8560 had been created.
[2022-12-09 14:28:01,269][src.datamodules.undc_pc_datamodule][INFO] - Loading Val dataset...
[2022-12-09 14:28:01,271][src.datamodules.undc_pc_datamodule][INFO] - Val dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-12-09 14:28:01,272][src.datamodules.undc_pc_datamodule][INFO] - Loading Test dataset...
[2022-12-09 14:28:01,273][src.datamodules.undc_pc_datamodule][INFO] - Test dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-12-09 14:28:01,361][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 98, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1112, in _run
    self._restore_modules_and_callbacks(ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1067, in _restore_modules_and_callbacks
    self._checkpoint_connector.restore_model()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/checkpoint_connector.py", line 182, in restore_model
    self.trainer.strategy.load_model_state_dict(self._loaded_checkpoint)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 343, in load_model_state_dict
    self.lightning_module.load_state_dict(checkpoint["state_dict"])
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1604, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for UNDCLitModule:
	Missing key(s) in state_dict: "net_bool.pc_conv_0.linear_1.weight", "net_bool.pc_conv_0.linear_1.bias", "net_bool.pc_conv_0.linear_2.weight", "net_bool.pc_conv_0.linear_2.bias", "net_bool.pc_res_1.linear_1.weight", "net_bool.pc_res_1.linear_1.bias", "net_bool.pc_res_1.linear_2.weight", "net_bool.pc_res_1.linear_2.bias", "net_bool.pc_conv_1.linear_1.weight", "net_bool.pc_conv_1.linear_1.bias", "net_bool.pc_conv_1.linear_2.weight", "net_bool.pc_conv_1.linear_2.bias", "net_bool.pc_res_2.linear_1.weight", "net_bool.pc_res_2.linear_1.bias", "net_bool.pc_res_2.linear_2.weight", "net_bool.pc_res_2.linear_2.bias", "net_bool.pc_conv_2.linear_1.weight", "net_bool.pc_conv_2.linear_1.bias", "net_bool.pc_conv_2.linear_2.weight", "net_bool.pc_conv_2.linear_2.bias", "net_bool.pc_res_3.linear_1.weight", "net_bool.pc_res_3.linear_1.bias", "net_bool.pc_res_3.linear_2.weight", "net_bool.pc_res_3.linear_2.bias", "net_bool.pc_conv_3.linear_1.weight", "net_bool.pc_conv_3.linear_1.bias", "net_bool.pc_conv_3.linear_2.weight", "net_bool.pc_conv_3.linear_2.bias", "net_bool.pc_res_4.linear_1.weight", "net_bool.pc_res_4.linear_1.bias", "net_bool.pc_res_4.linear_2.weight", "net_bool.pc_res_4.linear_2.bias", "net_bool.pc_conv_4.linear_1.weight", "net_bool.pc_conv_4.linear_1.bias", "net_bool.pc_conv_4.linear_2.weight", "net_bool.pc_conv_4.linear_2.bias", "net_bool.pc_res_5.linear_1.weight", "net_bool.pc_res_5.linear_1.bias", "net_bool.pc_res_5.linear_2.weight", "net_bool.pc_res_5.linear_2.bias", "net_bool.pc_conv_5.linear_1.weight", "net_bool.pc_conv_5.linear_1.bias", "net_bool.pc_conv_5.linear_2.weight", "net_bool.pc_conv_5.linear_2.bias", "net_bool.pc_res_6.linear_1.weight", "net_bool.pc_res_6.linear_1.bias", "net_bool.pc_res_6.linear_2.weight", "net_bool.pc_res_6.linear_2.bias", "net_bool.pc_conv_6.linear_1.weight", "net_bool.pc_conv_6.linear_1.bias", "net_bool.pc_conv_6.linear_2.weight", "net_bool.pc_conv_6.linear_2.bias", "net_bool.pc_res_7.linear_1.weight", "net_bool.pc_res_7.linear_1.bias", "net_bool.pc_res_7.linear_2.weight", "net_bool.pc_res_7.linear_2.bias", "net_bool.conv_1.weight", "net_bool.conv_1.bias", "net_bool.conv_2.weight", "net_bool.conv_2.bias", "net_bool.conv_3.weight", "net_bool.conv_3.bias", "net_bool.conv_4.weight", "net_bool.conv_4.bias", "net_bool.conv_5.weight", "net_bool.conv_5.bias", "net_bool.pc_conv_out_bool.weight", "net_bool.pc_conv_out_bool.bias", "net_bool.pc_conv_out_float.weight", "net_bool.pc_conv_out_float.bias". 
[2022-12-09 14:28:01,365][src.utils.utils][INFO] - Closing loggers...
[2022-12-09 14:28:17,541][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-09 14:28:17,548][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-09 14:28:17,548][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-09 14:28:17,609][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-09 14:28:18,249][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2022-12-09 14:28:25,063][__main__][INFO] - Instantiating callbacks...
[2022-12-09 14:28:25,065][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-09 14:28:25,072][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-09 14:28:25,073][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-09 14:28:25,074][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-09 14:28:25,075][__main__][INFO] - Instantiating loggers...
[2022-12-09 14:28:25,075][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-09 14:28:25,075][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-09 14:28:25,469][__main__][INFO] - Starting training!
[2022-12-09 14:28:25,474][src.datamodules.undc_pc_datamodule][INFO] - Loading Train dataset...
[2022-12-09 14:28:25,479][src.datamodules.undc_pc_datamodule][INFO] - Train dataset [ABC_pc_hdf5] of size 8560 had been created.
[2022-12-09 14:28:25,479][src.datamodules.undc_pc_datamodule][INFO] - Loading Val dataset...
[2022-12-09 14:28:25,481][src.datamodules.undc_pc_datamodule][INFO] - Val dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-12-09 14:28:25,482][src.datamodules.undc_pc_datamodule][INFO] - Loading Test dataset...
[2022-12-09 14:28:25,484][src.datamodules.undc_pc_datamodule][INFO] - Test dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-12-09 14:46:44,309][__main__][INFO] - Starting testing!
[2022-12-09 14:46:47,037][__main__][INFO] - Best ckpt path: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-09_14-28-17/checkpoints/epoch_000.ckpt
[2022-12-09 14:46:47,046][src.utils.utils][INFO] - Closing loggers...
[2022-12-09 14:46:47,049][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-09_14-28-17
[2022-12-09 14:46:47,050][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-12-09 14:48:01,433][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-09 14:48:01,440][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-09 14:48:01,441][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-09 14:48:01,508][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-09 14:48:02,175][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2022-12-09 14:48:02,205][__main__][INFO] - Instantiating callbacks...
[2022-12-09 14:48:02,205][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-09 14:48:02,209][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-09 14:48:02,211][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-09 14:48:02,212][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-09 14:48:02,212][__main__][INFO] - Instantiating loggers...
[2022-12-09 14:48:02,213][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-09 14:48:02,213][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-09 14:48:42,619][__main__][INFO] - Starting training!
[2022-12-09 14:48:47,890][src.datamodules.undc_pc_datamodule][INFO] - Loading Train dataset...
[2022-12-09 14:48:47,895][src.datamodules.undc_pc_datamodule][INFO] - Train dataset [ABC_pc_hdf5] of size 8560 had been created.
[2022-12-09 14:48:47,895][src.datamodules.undc_pc_datamodule][INFO] - Loading Val dataset...
[2022-12-09 14:48:47,897][src.datamodules.undc_pc_datamodule][INFO] - Val dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-12-09 14:48:47,897][src.datamodules.undc_pc_datamodule][INFO] - Loading Test dataset...
[2022-12-09 14:48:47,898][src.datamodules.undc_pc_datamodule][INFO] - Test dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-12-09 14:48:56,079][__main__][INFO] - Starting testing!
[2022-12-09 14:48:56,080][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2022-12-09 14:48:58,094][__main__][INFO] - Best ckpt path: None
[2022-12-09 14:48:58,102][src.utils.utils][INFO] - Closing loggers...
[2022-12-09 14:48:58,105][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-09_14-48-01
[2022-12-09 14:48:58,106][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-12-09 14:50:20,717][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-09 14:50:20,724][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-09 14:50:20,724][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-09 14:50:20,802][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-09 14:50:21,416][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2022-12-09 14:50:21,455][__main__][INFO] - Instantiating callbacks...
[2022-12-09 14:50:21,455][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-09 14:50:21,459][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-09 14:50:21,461][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-09 14:50:21,462][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-09 14:50:21,463][__main__][INFO] - Instantiating loggers...
[2022-12-09 14:50:21,463][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-09 14:50:21,463][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-09 14:51:01,737][__main__][INFO] - Starting training!
[2022-12-09 14:51:07,451][src.datamodules.undc_pc_datamodule][INFO] - Loading Train dataset...
[2022-12-09 14:51:07,456][src.datamodules.undc_pc_datamodule][INFO] - Train dataset [ABC_pc_hdf5] of size 8560 had been created.
[2022-12-09 14:51:07,457][src.datamodules.undc_pc_datamodule][INFO] - Loading Val dataset...
[2022-12-09 14:51:07,458][src.datamodules.undc_pc_datamodule][INFO] - Val dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-12-09 14:51:07,459][src.datamodules.undc_pc_datamodule][INFO] - Loading Test dataset...
[2022-12-09 14:51:07,460][src.datamodules.undc_pc_datamodule][INFO] - Test dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-12-09 17:37:25,454][__main__][INFO] - Starting testing!
[2022-12-09 17:37:28,979][__main__][INFO] - Best ckpt path: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-09_14-50-20/checkpoints/epoch_000.ckpt
[2022-12-09 17:37:28,987][src.utils.utils][INFO] - Closing loggers...
[2022-12-09 17:37:28,989][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-09_14-50-20
[2022-12-09 17:37:28,990][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-12-09 17:55:25,018][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-09 17:55:25,024][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-09 17:55:25,025][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-09 17:55:25,111][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-09 17:55:25,635][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2022-12-09 17:55:32,649][__main__][INFO] - Instantiating callbacks...
[2022-12-09 17:55:32,651][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-09 17:55:32,657][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-09 17:55:32,659][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-09 17:55:32,660][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-09 17:55:32,660][__main__][INFO] - Instantiating loggers...
[2022-12-09 17:55:32,661][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-09 17:55:32,661][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-09 17:55:33,079][__main__][INFO] - Starting training!
[2022-12-09 17:55:33,084][src.datamodules.undc_pc_datamodule][INFO] - Loading Train dataset...
[2022-12-09 17:55:33,090][src.datamodules.undc_pc_datamodule][INFO] - Train dataset [ABC_pc_hdf5] of size 8560 had been created.
[2022-12-09 17:55:33,090][src.datamodules.undc_pc_datamodule][INFO] - Loading Val dataset...
[2022-12-09 17:55:33,093][src.datamodules.undc_pc_datamodule][INFO] - Val dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-12-09 17:55:33,093][src.datamodules.undc_pc_datamodule][INFO] - Loading Test dataset...
[2022-12-09 17:55:33,095][src.datamodules.undc_pc_datamodule][INFO] - Test dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-12-09 22:43:51,002][__main__][INFO] - Starting testing!
[2022-12-09 22:43:54,052][__main__][INFO] - Best ckpt path: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-09_17-55-24/checkpoints/epoch_000.ckpt
[2022-12-09 22:43:54,062][src.utils.utils][INFO] - Closing loggers...
[2022-12-09 22:43:54,065][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-09_17-55-24
[2022-12-09 22:43:54,066][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-12-09 22:54:42,764][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-09 22:54:42,771][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-09 22:54:42,771][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-09 22:54:42,849][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-09 22:54:43,414][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2022-12-09 22:54:43,461][__main__][INFO] - Instantiating callbacks...
[2022-12-09 22:54:43,462][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-09 22:54:43,466][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-09 22:54:43,467][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-09 22:54:43,468][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-09 22:54:43,469][__main__][INFO] - Instantiating loggers...
[2022-12-09 22:54:43,469][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-09 22:54:43,469][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-09 22:55:25,323][__main__][INFO] - Starting training!
[2022-12-09 22:55:30,836][src.datamodules.undc_pc_datamodule][INFO] - Loading Train dataset...
[2022-12-09 22:55:30,840][src.datamodules.undc_pc_datamodule][INFO] - Train dataset [ABC_pc_hdf5] of size 8560 had been created.
[2022-12-09 22:55:30,840][src.datamodules.undc_pc_datamodule][INFO] - Loading Val dataset...
[2022-12-09 22:55:30,841][src.datamodules.undc_pc_datamodule][INFO] - Val dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-12-09 22:55:30,841][src.datamodules.undc_pc_datamodule][INFO] - Loading Test dataset...
[2022-12-09 22:55:30,842][src.datamodules.undc_pc_datamodule][INFO] - Test dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-12-09 22:56:14,972][__main__][INFO] - Starting testing!
[2022-12-09 22:56:14,974][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2022-12-09 22:56:18,656][__main__][INFO] - Best ckpt path: None
[2022-12-09 22:56:18,664][src.utils.utils][INFO] - Closing loggers...
[2022-12-09 22:56:18,667][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-09_22-54-42
[2022-12-09 22:56:18,668][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-12-09 23:15:55,866][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-09 23:15:55,873][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-09 23:15:55,873][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-09 23:15:55,936][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-09 23:15:56,476][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2022-12-09 23:15:56,479][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/utils.py", line 639, in _locate
    obj = getattr(obj, part)
AttributeError: module 'src.models' has no attribute 'undc_module2'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/utils.py", line 645, in _locate
    obj = import_module(mod)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1014, in _gcd_import
  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 973, in _find_and_load_unlocked
ModuleNotFoundError: No module named 'src.models.undc_module2'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/utils.py", line 648, in _locate
    raise ImportError(
ImportError: Error loading 'src.models.undc_module2.UNDCLitModule':
ModuleNotFoundError("No module named 'src.models.undc_module2'")
Are you sure that 'undc_module2' is importable from module 'src.models'?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 72, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 325, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'src.models.undc_module2.UNDCLitModule', see chained exception above.
full_key: model
[2022-12-09 23:15:56,481][src.utils.utils][INFO] - Closing loggers...
[2022-12-09 23:16:38,224][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-09 23:16:38,231][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-09 23:16:38,231][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-09 23:16:38,295][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-09 23:16:38,916][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-12-09 23:16:46,163][__main__][INFO] - Instantiating callbacks...
[2022-12-09 23:16:46,165][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-09 23:16:46,170][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-09 23:16:46,172][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-09 23:16:46,173][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-09 23:16:46,174][__main__][INFO] - Instantiating loggers...
[2022-12-09 23:16:46,174][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-09 23:16:46,174][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-09 23:16:46,600][__main__][INFO] - Starting training!
[2022-12-09 23:16:46,607][src.datamodules.undc_pc_datamodule][INFO] - Loading Train dataset...
[2022-12-09 23:16:46,612][src.datamodules.undc_pc_datamodule][INFO] - Train dataset [ABC_pc_hdf5] of size 8560 had been created.
[2022-12-09 23:16:46,612][src.datamodules.undc_pc_datamodule][INFO] - Loading Val dataset...
[2022-12-09 23:16:46,615][src.datamodules.undc_pc_datamodule][INFO] - Val dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-12-09 23:16:46,615][src.datamodules.undc_pc_datamodule][INFO] - Loading Test dataset...
[2022-12-09 23:16:46,617][src.datamodules.undc_pc_datamodule][INFO] - Test dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-12-09 23:17:32,845][__main__][INFO] - Starting testing!
[2022-12-09 23:17:32,848][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2022-12-09 23:17:34,563][__main__][INFO] - Best ckpt path: None
[2022-12-09 23:17:34,573][src.utils.utils][INFO] - Closing loggers...
[2022-12-09 23:17:34,576][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-09_23-16-38
[2022-12-09 23:17:34,577][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-12-10 17:14:09,998][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-10 17:14:10,006][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-10 17:14:10,006][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-10 17:14:10,084][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-10 17:14:10,781][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-12-10 17:14:10,856][__main__][INFO] - Instantiating callbacks...
[2022-12-10 17:14:10,856][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-10 17:14:10,861][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-10 17:14:10,863][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-10 17:14:10,864][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-10 17:14:10,865][__main__][INFO] - Instantiating loggers...
[2022-12-10 17:14:10,865][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-10 17:14:10,865][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-10 17:14:51,901][__main__][INFO] - Starting training!
[2022-12-10 17:14:57,004][src.datamodules.undc_pc_datamodule][INFO] - Loading Train dataset...
[2022-12-10 17:14:57,008][src.datamodules.undc_pc_datamodule][INFO] - Train dataset [ABC_pc_hdf5] of size 8560 had been created.
[2022-12-10 17:14:57,008][src.datamodules.undc_pc_datamodule][INFO] - Loading Val dataset...
[2022-12-10 17:14:57,010][src.datamodules.undc_pc_datamodule][INFO] - Val dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-12-10 17:14:57,010][src.datamodules.undc_pc_datamodule][INFO] - Loading Test dataset...
[2022-12-10 17:14:57,011][src.datamodules.undc_pc_datamodule][INFO] - Test dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-12-10 17:59:54,471][__main__][INFO] - Starting testing!
[2022-12-10 18:01:26,302][__main__][INFO] - Best ckpt path: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-10_17-14-09/checkpoints/epoch_000.ckpt
[2022-12-10 18:01:26,305][src.utils.utils][INFO] - Closing loggers...
[2022-12-10 18:01:26,307][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-10_17-14-09
[2022-12-10 18:01:26,307][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-12-10 18:02:33,873][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-10 18:02:33,880][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-10 18:02:33,880][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-10 18:02:33,941][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-10 18:02:34,608][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-12-10 18:02:41,355][__main__][INFO] - Instantiating callbacks...
[2022-12-10 18:02:41,357][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-10 18:02:41,363][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-10 18:02:41,365][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-10 18:02:41,365][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-10 18:02:41,366][__main__][INFO] - Instantiating loggers...
[2022-12-10 18:02:41,366][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-10 18:02:41,367][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-10 18:02:41,799][__main__][INFO] - Starting training!
[2022-12-10 18:02:41,805][src.datamodules.undc_pc_datamodule][INFO] - Loading Train dataset...
[2022-12-10 18:02:41,809][src.datamodules.undc_pc_datamodule][INFO] - Train dataset [ABC_pc_hdf5] of size 8560 had been created.
[2022-12-10 18:02:41,809][src.datamodules.undc_pc_datamodule][INFO] - Loading Val dataset...
[2022-12-10 18:02:41,811][src.datamodules.undc_pc_datamodule][INFO] - Val dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-12-10 18:02:41,811][src.datamodules.undc_pc_datamodule][INFO] - Loading Test dataset...
[2022-12-10 18:02:41,813][src.datamodules.undc_pc_datamodule][INFO] - Test dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-12-10 18:49:01,689][__main__][INFO] - Starting testing!
[2022-12-10 18:51:22,934][__main__][INFO] - Best ckpt path: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-10_18-02-33/checkpoints/epoch_000.ckpt
[2022-12-10 18:51:22,939][src.utils.utils][INFO] - Closing loggers...
[2022-12-10 18:51:22,941][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-10_18-02-33
[2022-12-10 18:51:22,941][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-12-10 18:57:21,971][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-10 18:57:21,978][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-10 18:57:21,978][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-10 18:57:22,041][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-10 18:57:22,046][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/utils.py", line 639, in _locate
    obj = getattr(obj, part)
AttributeError: module 'src.datamodules' has no attribute 'undc_pc_datamodule'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/utils.py", line 645, in _locate
    obj = import_module(mod)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1014, in _gcd_import
  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 975, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 671, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/home/fubao/dev/my-ndc/src/datamodules/undc_pc_datamodule.py", line 8, in <module>
    from src.datamodules.components.npc_dataset import ABC_pc_hdf5
ModuleNotFoundError: No module named 'src.datamodules.components.npc_dataset'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/utils.py", line 648, in _locate
    raise ImportError(
ImportError: Error loading 'src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule':
ModuleNotFoundError("No module named 'src.datamodules.components.npc_dataset'")
Are you sure that 'undc_pc_datamodule' is importable from module 'src.datamodules'?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 69, in train
    datamodule: LightningDataModule = hydra.utils.instantiate(cfg.datamodule)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 325, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule', see chained exception above.
full_key: datamodule
[2022-12-10 18:57:22,048][src.utils.utils][INFO] - Closing loggers...
[2022-12-10 18:58:34,959][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-10 18:58:34,966][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-10 18:58:34,967][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-10 18:58:35,031][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-10 18:58:35,036][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/utils.py", line 639, in _locate
    obj = getattr(obj, part)
AttributeError: module 'src.datamodules' has no attribute 'undc_pc_datamodule'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/utils.py", line 645, in _locate
    obj = import_module(mod)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1014, in _gcd_import
  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 975, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 671, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/home/fubao/dev/my-ndc/src/datamodules/undc_pc_datamodule.py", line 8, in <module>
    from src.datamodules.components.npc_dataset import ABC_pc_hdf5
ModuleNotFoundError: No module named 'src.datamodules.components.npc_dataset'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/utils.py", line 648, in _locate
    raise ImportError(
ImportError: Error loading 'src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule':
ModuleNotFoundError("No module named 'src.datamodules.components.npc_dataset'")
Are you sure that 'undc_pc_datamodule' is importable from module 'src.datamodules'?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 69, in train
    datamodule: LightningDataModule = hydra.utils.instantiate(cfg.datamodule)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 325, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule', see chained exception above.
full_key: datamodule
[2022-12-10 18:58:35,038][src.utils.utils][INFO] - Closing loggers...
[2022-12-10 18:59:37,193][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-10 18:59:37,199][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-10 18:59:37,200][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-10 18:59:37,260][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-10 18:59:37,263][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/utils.py", line 639, in _locate
    obj = getattr(obj, part)
AttributeError: module 'src.datamodules' has no attribute 'undc_pc_datamodule'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/utils.py", line 645, in _locate
    obj = import_module(mod)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1014, in _gcd_import
  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 975, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 671, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/home/fubao/dev/my-ndc/src/datamodules/undc_pc_datamodule.py", line 8, in <module>
    from src.datamodules.components.npc_dataset import ABC_pc_hdf5
ModuleNotFoundError: No module named 'src.datamodules.components.npc_dataset'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/utils.py", line 648, in _locate
    raise ImportError(
ImportError: Error loading 'src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule':
ModuleNotFoundError("No module named 'src.datamodules.components.npc_dataset'")
Are you sure that 'undc_pc_datamodule' is importable from module 'src.datamodules'?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 69, in train
    datamodule: LightningDataModule = hydra.utils.instantiate(cfg.datamodule)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 325, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule', see chained exception above.
full_key: datamodule
[2022-12-10 18:59:37,265][src.utils.utils][INFO] - Closing loggers...
[2022-12-10 19:01:20,993][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-10 19:01:21,000][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-10 19:01:21,000][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-10 19:01:21,059][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-10 19:01:21,682][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-12-10 19:01:21,690][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
TypeError: __init__() missing 2 required positional arguments: 'out_bool' and 'out_float'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 72, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 334, in instantiate_node
    value = instantiate_node(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 339, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.models.components.undc_npc_net.local_pointnet_larger':
TypeError("__init__() missing 2 required positional arguments: 'out_bool' and 'out_float'")
full_key: model.net
[2022-12-10 19:01:21,692][src.utils.utils][INFO] - Closing loggers...
[2022-12-10 19:03:00,645][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-10 19:03:00,651][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-10 19:03:00,651][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-10 19:03:00,712][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-10 19:03:01,378][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-12-10 19:03:01,388][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
TypeError: __init__() missing 2 required positional arguments: 'out_bool' and 'out_float'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 72, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 334, in instantiate_node
    value = instantiate_node(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 339, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.models.components.undc_npc_net.local_pointnet_larger':
TypeError("__init__() missing 2 required positional arguments: 'out_bool' and 'out_float'")
full_key: model.net
[2022-12-10 19:03:01,391][src.utils.utils][INFO] - Closing loggers...
[2022-12-10 19:03:20,430][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-10 19:03:20,438][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-10 19:03:20,438][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-10 19:03:20,523][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-10 19:03:21,229][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-12-10 19:03:21,281][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "/home/fubao/dev/my-ndc/src/models/components/undc_npc_net.py", line 121, in __init__
    if self.out_bool:
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1207, in __getattr__
    raise AttributeError("'{}' object has no attribute '{}'".format(
AttributeError: 'local_pointnet_larger' object has no attribute 'out_bool'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 72, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 334, in instantiate_node
    value = instantiate_node(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 339, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.models.components.undc_npc_net.local_pointnet_larger':
AttributeError("'local_pointnet_larger' object has no attribute 'out_bool'")
full_key: model.net
[2022-12-10 19:03:21,283][src.utils.utils][INFO] - Closing loggers...
[2022-12-10 19:04:14,803][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-10 19:04:14,810][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-10 19:04:14,810][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-10 19:04:14,874][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-10 19:04:15,531][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-12-10 19:04:15,622][__main__][INFO] - Instantiating callbacks...
[2022-12-10 19:04:15,623][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-10 19:04:15,627][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-10 19:04:15,628][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-10 19:04:15,629][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-10 19:04:15,630][__main__][INFO] - Instantiating loggers...
[2022-12-10 19:04:15,630][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-10 19:04:15,630][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-10 19:04:56,261][__main__][INFO] - Starting training!
[2022-12-10 19:05:01,663][src.datamodules.undc_pc_datamodule][INFO] - Loading Train dataset...
[2022-12-10 19:05:02,004][src.datamodules.undc_pc_datamodule][INFO] - Train dataset [ABC_npc_hdf5] of size 205440 had been created.
[2022-12-10 19:05:02,004][src.datamodules.undc_pc_datamodule][INFO] - Loading Val dataset...
[2022-12-10 19:05:02,006][src.datamodules.undc_pc_datamodule][INFO] - Val dataset [ABC_npc_hdf5] of size 1071 had been created.
[2022-12-10 19:05:02,006][src.datamodules.undc_pc_datamodule][INFO] - Loading Test dataset...
[2022-12-10 19:05:02,007][src.datamodules.undc_pc_datamodule][INFO] - Test dataset [ABC_npc_hdf5] of size 1071 had been created.
[2022-12-10 19:05:11,741][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 98, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1285, in _run_train
    self.fit_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/fit_loop.py", line 270, in advance
    self._outputs = self.epoch_loop.run(self._data_fetcher)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 174, in advance
    batch = next(data_fetcher)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 185, in __next__
    return self.fetching_function()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 264, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 278, in _fetch_next_batch
    batch = next(iterator)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/supporters.py", line 558, in __next__
    return self.request_next_batch(self.loader_iters)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/supporters.py", line 570, in request_next_batch
    return apply_to_collection(loader_iters, Iterator, next)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/apply_func.py", line 100, in apply_to_collection
    return function(data, *args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 681, in __next__
    data = self._next_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1376, in _next_data
    return self._process_data(data)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1402, in _process_data
    data.reraise()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/_utils.py", line 461, in reraise
    raise exception
FileNotFoundError: Caught FileNotFoundError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/fubao/dev/my-ndc/src/datamodules/components/pc_dataset.py", line 187, in __getitem__
    gt_output_bool_, gt_output_float_, gt_input_ = read_and_augment_data_undc(
  File "/home/fubao/dev/my-ndc/src/utils/ndc_utils.py", line 237, in read_and_augment_data_undc
    LOD_gt_int, LOD_gt_float, LOD_input = read_data(hdf5_dir,grid_size,input_type,out_bool,out_float,is_undc=True)
  File "/home/fubao/dev/my-ndc/src/utils/ndc_utils.py", line 78, in read_data
    hdf5_file = h5py.File(hdf5_dir, 'r')
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/h5py/_hl/files.py", line 533, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, fcpl, swmr=swmr)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/h5py/_hl/files.py", line 226, in make_fid
    fid = h5f.open(name, flags, fapl=fapl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 106, in h5py.h5f.open
FileNotFoundError: [Errno 2] Unable to open file (unable to open file: name = '/home/fubao/dev/my-ndc/data/groundtruth/gt_UNDC/00006555_5_0_0_1.hdf5', errno = 2, error message = 'No such file or directory', flags = 0, o_flags = 0)

[2022-12-10 19:05:11,755][src.utils.utils][INFO] - Closing loggers...
[2022-12-10 19:47:46,121][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-10 19:47:46,127][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-10 19:47:46,128][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-10 19:47:46,188][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-10 19:47:46,818][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-12-10 19:47:46,875][__main__][INFO] - Instantiating callbacks...
[2022-12-10 19:47:46,875][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-10 19:47:46,880][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-10 19:47:46,881][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-10 19:47:46,882][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-10 19:47:46,883][__main__][INFO] - Instantiating loggers...
[2022-12-10 19:47:46,883][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-10 19:47:46,884][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-10 19:48:27,633][__main__][INFO] - Starting training!
[2022-12-10 19:48:32,948][src.datamodules.undc_pc_datamodule][INFO] - Loading Train dataset...
[2022-12-10 19:48:33,200][src.datamodules.undc_pc_datamodule][INFO] - Train dataset [ABC_npc_hdf5] of size 205440 had been created.
[2022-12-10 19:48:33,201][src.datamodules.undc_pc_datamodule][INFO] - Loading Val dataset...
[2022-12-10 19:48:33,202][src.datamodules.undc_pc_datamodule][INFO] - Val dataset [ABC_npc_hdf5] of size 1071 had been created.
[2022-12-10 19:48:33,202][src.datamodules.undc_pc_datamodule][INFO] - Loading Test dataset...
[2022-12-10 19:48:33,203][src.datamodules.undc_pc_datamodule][INFO] - Test dataset [ABC_npc_hdf5] of size 1071 had been created.
[2022-12-10 19:48:42,137][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 72, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1285, in _run_train
    self.fit_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/fit_loop.py", line 270, in advance
    self._outputs = self.epoch_loop.run(self._data_fetcher)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 174, in advance
    batch = next(data_fetcher)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 185, in __next__
    return self.fetching_function()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 264, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 278, in _fetch_next_batch
    batch = next(iterator)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/supporters.py", line 558, in __next__
    return self.request_next_batch(self.loader_iters)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/supporters.py", line 570, in request_next_batch
    return apply_to_collection(loader_iters, Iterator, next)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/apply_func.py", line 100, in apply_to_collection
    return function(data, *args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 681, in __next__
    data = self._next_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1376, in _next_data
    return self._process_data(data)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1402, in _process_data
    data.reraise()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/_utils.py", line 461, in reraise
    raise exception
FileNotFoundError: Caught FileNotFoundError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/fubao/dev/my-ndc/src/datamodules/components/pc_dataset.py", line 187, in __getitem__
    gt_output_bool_, gt_output_float_, gt_input_ = read_and_augment_data_undc(
  File "/home/fubao/dev/my-ndc/src/utils/ndc_utils.py", line 237, in read_and_augment_data_undc
    LOD_gt_int, LOD_gt_float, LOD_input = read_data(hdf5_dir,grid_size,input_type,out_bool,out_float,is_undc=True)
  File "/home/fubao/dev/my-ndc/src/utils/ndc_utils.py", line 78, in read_data
    hdf5_file = h5py.File(hdf5_dir, 'r')
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/h5py/_hl/files.py", line 533, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, fcpl, swmr=swmr)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/h5py/_hl/files.py", line 226, in make_fid
    fid = h5f.open(name, flags, fapl=fapl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 106, in h5py.h5f.open
FileNotFoundError: [Errno 2] Unable to open file (unable to open file: name = '/home/fubao/dev/my-ndc/data/groundtruth/gt_UNDC/00002850_8_1_0_1.hdf5', errno = 2, error message = 'No such file or directory', flags = 0, o_flags = 0)

[2022-12-10 19:48:42,151][src.utils.utils][INFO] - Closing loggers...
[2022-12-10 19:53:20,988][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-10 19:53:20,995][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-10 19:53:20,996][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-10 19:53:21,077][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-10 19:53:21,675][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-12-10 19:53:21,722][__main__][INFO] - Instantiating callbacks...
[2022-12-10 19:53:21,722][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-10 19:53:21,726][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-10 19:53:21,728][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-10 19:53:21,729][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-10 19:53:21,729][__main__][INFO] - Instantiating loggers...
[2022-12-10 19:53:21,730][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-10 19:53:21,730][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-10 19:54:02,155][__main__][INFO] - Starting training!
[2022-12-10 19:54:07,648][src.datamodules.undc_pc_datamodule][INFO] - Loading Train dataset...
[2022-12-10 19:54:07,653][src.datamodules.undc_pc_datamodule][INFO] - Train dataset [ABC_pc_hdf5] of size 8560 had been created.
[2022-12-10 19:54:07,653][src.datamodules.undc_pc_datamodule][INFO] - Loading Val dataset...
[2022-12-10 19:54:07,655][src.datamodules.undc_pc_datamodule][INFO] - Val dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-12-10 19:54:07,655][src.datamodules.undc_pc_datamodule][INFO] - Loading Test dataset...
[2022-12-10 19:54:07,657][src.datamodules.undc_pc_datamodule][INFO] - Test dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-12-10 20:40:17,001][__main__][INFO] - Starting testing!
[2022-12-10 20:41:49,163][__main__][INFO] - Best ckpt path: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-10_19-53-20/checkpoints/epoch_000.ckpt
[2022-12-10 20:41:49,166][src.utils.utils][INFO] - Closing loggers...
[2022-12-10 20:41:49,168][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-10_19-53-20
[2022-12-10 20:41:49,169][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-12-10 20:46:19,098][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-10 20:46:19,104][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-10 20:46:19,104][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-10 20:46:19,164][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-10 20:46:19,757][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-12-10 20:46:26,346][__main__][INFO] - Instantiating callbacks...
[2022-12-10 20:46:26,348][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-10 20:46:26,355][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-10 20:46:26,356][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-10 20:46:26,357][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-10 20:46:26,358][__main__][INFO] - Instantiating loggers...
[2022-12-10 20:46:26,358][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-10 20:46:26,359][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-10 20:46:26,633][__main__][INFO] - Starting training!
[2022-12-10 20:46:26,639][src.datamodules.undc_pc_datamodule][INFO] - Loading Train dataset...
[2022-12-10 20:46:26,644][src.datamodules.undc_pc_datamodule][INFO] - Train dataset [ABC_pc_hdf5] of size 8560 had been created.
[2022-12-10 20:46:26,644][src.datamodules.undc_pc_datamodule][INFO] - Loading Val dataset...
[2022-12-10 20:46:26,647][src.datamodules.undc_pc_datamodule][INFO] - Val dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-12-10 20:46:26,647][src.datamodules.undc_pc_datamodule][INFO] - Loading Test dataset...
[2022-12-10 20:46:26,649][src.datamodules.undc_pc_datamodule][INFO] - Test dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-12-10 20:49:46,194][__main__][INFO] - Starting testing!
[2022-12-10 20:49:46,195][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2022-12-10 20:49:48,652][__main__][INFO] - Best ckpt path: None
[2022-12-10 20:49:48,657][src.utils.utils][INFO] - Closing loggers...
[2022-12-10 20:49:48,658][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-10_20-46-18
[2022-12-10 20:49:48,659][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-12-10 20:52:09,386][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-10 20:52:09,392][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-10 20:52:09,393][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-10 20:52:09,458][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-10 20:52:10,091][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-12-10 20:52:17,217][__main__][INFO] - Instantiating callbacks...
[2022-12-10 20:52:17,218][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-10 20:52:17,224][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-10 20:52:17,225][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-10 20:52:17,226][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-10 20:52:17,227][__main__][INFO] - Instantiating loggers...
[2022-12-10 20:52:17,227][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-10 20:52:17,228][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-10 20:52:17,473][__main__][INFO] - Starting training!
[2022-12-10 20:52:17,477][src.datamodules.undc_pc_datamodule][INFO] - Loading Train dataset...
[2022-12-10 20:52:17,481][src.datamodules.undc_pc_datamodule][INFO] - Train dataset [ABC_pc_hdf5] of size 8560 had been created.
[2022-12-10 20:52:17,481][src.datamodules.undc_pc_datamodule][INFO] - Loading Val dataset...
[2022-12-10 20:52:17,482][src.datamodules.undc_pc_datamodule][INFO] - Val dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-12-10 20:52:17,483][src.datamodules.undc_pc_datamodule][INFO] - Loading Test dataset...
[2022-12-10 20:52:17,484][src.datamodules.undc_pc_datamodule][INFO] - Test dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-12-10 20:52:47,998][__main__][INFO] - Starting testing!
[2022-12-10 20:52:47,999][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2022-12-10 20:52:49,096][__main__][INFO] - Best ckpt path: None
[2022-12-10 20:52:49,105][src.utils.utils][INFO] - Closing loggers...
[2022-12-10 20:52:49,108][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-10_20-52-09
[2022-12-10 20:52:49,110][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2022-12-10 20:53:04,212][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-10 20:53:04,219][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-10 20:53:04,219][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-10 20:53:04,281][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2022-12-10 20:53:04,941][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2022-12-10 20:53:11,606][__main__][INFO] - Instantiating callbacks...
[2022-12-10 20:53:11,608][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-10 20:53:11,615][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-10 20:53:11,616][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-10 20:53:11,617][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-10 20:53:11,618][__main__][INFO] - Instantiating loggers...
[2022-12-10 20:53:11,619][src.utils.utils][WARNING] - Logger config is empty.
[2022-12-10 20:53:11,619][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-10 20:53:12,019][__main__][INFO] - Starting training!
[2022-12-10 20:53:12,023][src.datamodules.undc_pc_datamodule][INFO] - Loading Train dataset...
[2022-12-10 20:53:12,027][src.datamodules.undc_pc_datamodule][INFO] - Train dataset [ABC_pc_hdf5] of size 8560 had been created.
[2022-12-10 20:53:12,027][src.datamodules.undc_pc_datamodule][INFO] - Loading Val dataset...
[2022-12-10 20:53:12,028][src.datamodules.undc_pc_datamodule][INFO] - Val dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-12-10 20:53:12,029][src.datamodules.undc_pc_datamodule][INFO] - Loading Test dataset...
[2022-12-10 20:53:12,030][src.datamodules.undc_pc_datamodule][INFO] - Test dataset [ABC_pc_hdf5] of size 1071 had been created.
[2022-12-10 21:39:22,729][__main__][INFO] - Starting testing!
[2022-12-10 21:41:45,333][__main__][INFO] - Best ckpt path: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-10_20-53-04/checkpoints/epoch_000.ckpt
[2022-12-10 21:41:45,336][src.utils.utils][INFO] - Closing loggers...
[2022-12-10 21:41:45,338][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2022-12-10_20-53-04
[2022-12-10 21:41:45,338][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-01-03 13:33:44,194][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-03 13:33:44,202][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-03 13:33:44,202][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-03 13:33:44,281][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2023-01-03 13:33:45,292][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2023-01-03 13:33:45,385][__main__][INFO] - Instantiating callbacks...
[2023-01-03 13:33:45,386][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-03 13:33:45,391][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-03 13:33:45,393][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-03 13:33:45,394][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-03 13:33:45,395][__main__][INFO] - Instantiating loggers...
[2023-01-03 13:33:45,396][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-03 13:33:45,396][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-03 13:34:25,281][__main__][INFO] - Starting training!
[2023-01-03 13:34:30,926][src.datamodules.undc_pc_datamodule][INFO] - Loading Train dataset...
[2023-01-03 13:34:30,935][src.datamodules.undc_pc_datamodule][INFO] - Train dataset [ABC_pc_hdf5] of size 8560 had been created.
[2023-01-03 13:34:30,935][src.datamodules.undc_pc_datamodule][INFO] - Loading Val dataset...
[2023-01-03 13:34:30,937][src.datamodules.undc_pc_datamodule][INFO] - Val dataset [ABC_pc_hdf5] of size 1071 had been created.
[2023-01-03 13:34:30,938][src.datamodules.undc_pc_datamodule][INFO] - Loading Test dataset...
[2023-01-03 13:34:30,940][src.datamodules.undc_pc_datamodule][INFO] - Test dataset [ABC_pc_hdf5] of size 1071 had been created.
[2023-01-03 13:34:39,590][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1163, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/queue.py", line 178, in get
    raise Empty
_queue.Empty

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 72, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_train
    self._run_sanity_check()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1345, in _run_sanity_check
    val_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 155, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 127, in advance
    batch = next(data_fetcher)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 185, in __next__
    return self.fetching_function()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 264, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 278, in _fetch_next_batch
    batch = next(iterator)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 681, in __next__
    data = self._next_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1359, in _next_data
    idx, data = self._get_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1315, in _get_data
    success, data = self._try_get_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1176, in _try_get_data
    raise RuntimeError('DataLoader worker (pid(s) {}) exited unexpectedly'.format(pids_str)) from e
RuntimeError: DataLoader worker (pid(s) 3649, 3697, 3745, 3793, 3841, 3889, 3937, 3985, 4034, 4082, 4130, 4179, 4227, 4275, 4323, 4371, 4419, 4472, 4523, 4572, 4632, 4710, 4759, 4811) exited unexpectedly
[2023-01-03 13:34:39,602][src.utils.utils][INFO] - Closing loggers...
[2023-01-03 17:07:52,057][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-03 17:07:52,064][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-03 17:07:52,064][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-03 17:07:52,127][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2023-01-03 17:07:52,670][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2023-01-03 17:07:52,717][__main__][INFO] - Instantiating callbacks...
[2023-01-03 17:07:52,718][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-03 17:07:52,722][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-03 17:07:52,723][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-03 17:07:52,724][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-03 17:07:52,724][__main__][INFO] - Instantiating loggers...
[2023-01-03 17:07:52,725][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-03 17:07:52,725][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-03 17:08:32,675][__main__][INFO] - Starting training!
[2023-01-03 17:08:38,166][src.datamodules.undc_pc_datamodule][INFO] - Loading Train dataset...
[2023-01-03 17:08:38,174][src.datamodules.undc_pc_datamodule][INFO] - Train dataset [ABC_pc_hdf5] of size 8560 had been created.
[2023-01-03 17:08:38,174][src.datamodules.undc_pc_datamodule][INFO] - Loading Val dataset...
[2023-01-03 17:08:38,176][src.datamodules.undc_pc_datamodule][INFO] - Val dataset [ABC_pc_hdf5] of size 1071 had been created.
[2023-01-03 17:08:38,177][src.datamodules.undc_pc_datamodule][INFO] - Loading Test dataset...
[2023-01-03 17:08:38,179][src.datamodules.undc_pc_datamodule][INFO] - Test dataset [ABC_pc_hdf5] of size 1071 had been created.
[2023-01-03 17:08:41,171][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 72, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_train
    self._run_sanity_check()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1345, in _run_sanity_check
    val_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 155, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 127, in advance
    batch = next(data_fetcher)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 185, in __next__
    return self.fetching_function()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 264, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 278, in _fetch_next_batch
    batch = next(iterator)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 681, in __next__
    data = self._next_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1376, in _next_data
    return self._process_data(data)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1402, in _process_data
    data.reraise()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/_utils.py", line 461, in reraise
    raise exception
EOFError: Caught EOFError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/fubao/dev/my-ndc/src/datamodules/components/pc_dataset.py", line 137, in __getitem__
    input()
EOFError: EOF when reading a line

[2023-01-03 17:08:41,180][src.utils.utils][INFO] - Closing loggers...
[2023-01-03 17:10:22,851][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-03 17:10:22,858][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-03 17:10:22,858][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-03 17:10:22,919][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2023-01-03 17:10:23,436][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2023-01-03 17:10:23,478][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/serialization.py", line 308, in _check_seekable
    f.seek(f.tell())
AttributeError: 'NoneType' object has no attribute 'seek'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "/home/fubao/dev/my-ndc/src/models/undc_module.py", line 39, in __init__
    self.net_bool.load_state_dict(torch.load(net_bool_pth))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/serialization.py", line 699, in load
    with _open_file_like(f, 'rb') as opened_file:
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/serialization.py", line 235, in _open_file_like
    return _open_buffer_reader(name_or_buffer)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/serialization.py", line 220, in __init__
    _check_seekable(buffer)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/serialization.py", line 311, in _check_seekable
    raise_err_msg(["seek", "tell"], e)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/serialization.py", line 304, in raise_err_msg
    raise type(e)(msg)
AttributeError: 'NoneType' object has no attribute 'seek'. You can only torch.load from a file that is seekable. Please pre-load the data into a buffer like io.BytesIO and try to load from it instead.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 46, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 339, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.models.undc_module.UNDCLitModule':
AttributeError("'NoneType' object has no attribute 'seek'. You can only torch.load from a file that is seekable. Please pre-load the data into a buffer like io.BytesIO and try to load from it instead.")
full_key: model
[2023-01-03 17:10:23,480][src.utils.utils][INFO] - Closing loggers...
[2023-01-03 17:11:19,104][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-03 17:11:19,111][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-03 17:11:19,111][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-03 17:11:19,172][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2023-01-03 17:11:19,680][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2023-01-03 17:11:19,728][__main__][INFO] - Instantiating callbacks...
[2023-01-03 17:11:19,728][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-03 17:11:19,732][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-03 17:11:19,733][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-03 17:11:19,734][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-03 17:11:19,735][__main__][INFO] - Instantiating loggers...
[2023-01-03 17:11:19,735][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-03 17:11:19,736][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-03 17:12:00,678][__main__][INFO] - Starting training!
[2023-01-03 17:12:05,894][src.datamodules.undc_pc_datamodule][INFO] - Loading Train dataset...
[2023-01-03 17:12:05,897][src.datamodules.undc_pc_datamodule][INFO] - Train dataset [ABC_pc_hdf5] of size 8560 had been created.
[2023-01-03 17:12:05,898][src.datamodules.undc_pc_datamodule][INFO] - Loading Val dataset...
[2023-01-03 17:12:05,899][src.datamodules.undc_pc_datamodule][INFO] - Val dataset [ABC_pc_hdf5] of size 1071 had been created.
[2023-01-03 17:12:05,899][src.datamodules.undc_pc_datamodule][INFO] - Loading Test dataset...
[2023-01-03 17:12:05,900][src.datamodules.undc_pc_datamodule][INFO] - Test dataset [ABC_pc_hdf5] of size 1071 had been created.
[2023-01-03 17:12:08,870][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 72, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_train
    self._run_sanity_check()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1345, in _run_sanity_check
    val_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 155, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 127, in advance
    batch = next(data_fetcher)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 185, in __next__
    return self.fetching_function()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 264, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 278, in _fetch_next_batch
    batch = next(iterator)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 681, in __next__
    data = self._next_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1376, in _next_data
    return self._process_data(data)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1402, in _process_data
    data.reraise()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/_utils.py", line 461, in reraise
    raise exception
EOFError: Caught EOFError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/fubao/dev/my-ndc/src/datamodules/components/pc_dataset.py", line 137, in __getitem__
    input()
EOFError: EOF when reading a line

[2023-01-03 17:12:08,882][src.utils.utils][INFO] - Closing loggers...
[2023-01-03 17:12:25,681][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-03 17:12:25,688][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-03 17:12:25,688][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-03 17:12:25,750][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2023-01-03 17:12:26,325][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2023-01-03 17:12:26,382][__main__][INFO] - Instantiating callbacks...
[2023-01-03 17:12:26,383][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-03 17:12:26,387][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-03 17:12:26,389][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-03 17:12:26,390][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-03 17:12:26,390][__main__][INFO] - Instantiating loggers...
[2023-01-03 17:12:26,391][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-03 17:12:26,391][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-03 17:13:05,998][__main__][INFO] - Starting training!
[2023-01-03 17:13:11,746][src.datamodules.undc_pc_datamodule][INFO] - Loading Train dataset...
[2023-01-03 17:13:11,752][src.datamodules.undc_pc_datamodule][INFO] - Train dataset [ABC_pc_hdf5] of size 8560 had been created.
[2023-01-03 17:13:11,753][src.datamodules.undc_pc_datamodule][INFO] - Loading Val dataset...
[2023-01-03 17:13:11,755][src.datamodules.undc_pc_datamodule][INFO] - Val dataset [ABC_pc_hdf5] of size 1071 had been created.
[2023-01-03 17:13:11,755][src.datamodules.undc_pc_datamodule][INFO] - Loading Test dataset...
[2023-01-03 17:13:11,758][src.datamodules.undc_pc_datamodule][INFO] - Test dataset [ABC_pc_hdf5] of size 1071 had been created.
[2023-01-03 17:13:14,638][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 72, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_train
    self._run_sanity_check()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1345, in _run_sanity_check
    val_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 155, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 127, in advance
    batch = next(data_fetcher)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 185, in __next__
    return self.fetching_function()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 264, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 278, in _fetch_next_batch
    batch = next(iterator)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 681, in __next__
    data = self._next_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1376, in _next_data
    return self._process_data(data)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1402, in _process_data
    data.reraise()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/_utils.py", line 461, in reraise
    raise exception
EOFError: Caught EOFError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/fubao/dev/my-ndc/src/datamodules/components/pc_dataset.py", line 137, in __getitem__
    input()
EOFError: EOF when reading a line

[2023-01-03 17:13:14,647][src.utils.utils][INFO] - Closing loggers...
[2023-01-03 17:15:53,815][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-03 17:15:53,822][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-03 17:15:53,822][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-03 17:15:53,884][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2023-01-03 17:15:54,430][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2023-01-03 17:15:54,479][__main__][INFO] - Instantiating callbacks...
[2023-01-03 17:15:54,480][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-03 17:15:54,483][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-03 17:15:54,485][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-03 17:15:54,485][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-03 17:15:54,486][__main__][INFO] - Instantiating loggers...
[2023-01-03 17:15:54,486][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-03 17:15:54,487][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-03 17:16:35,601][__main__][INFO] - Starting training!
[2023-01-03 17:16:40,932][src.datamodules.undc_pc_datamodule][INFO] - Loading Train dataset...
[2023-01-03 17:16:40,935][src.datamodules.undc_pc_datamodule][INFO] - Train dataset [ABC_pc_hdf5] of size 8560 had been created.
[2023-01-03 17:16:40,936][src.datamodules.undc_pc_datamodule][INFO] - Loading Val dataset...
[2023-01-03 17:16:40,937][src.datamodules.undc_pc_datamodule][INFO] - Val dataset [ABC_pc_hdf5] of size 1071 had been created.
[2023-01-03 17:16:40,937][src.datamodules.undc_pc_datamodule][INFO] - Loading Test dataset...
[2023-01-03 17:16:40,938][src.datamodules.undc_pc_datamodule][INFO] - Test dataset [ABC_pc_hdf5] of size 1071 had been created.
[2023-01-03 17:17:52,170][__main__][INFO] - Starting testing!
[2023-01-03 17:17:52,172][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-01-03 17:17:57,259][__main__][INFO] - Best ckpt path: None
[2023-01-03 17:17:57,270][src.utils.utils][INFO] - Closing loggers...
[2023-01-03 17:17:57,274][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-03_17-15-53
[2023-01-03 17:17:57,275][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-01-03 17:23:21,746][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-03 17:23:21,752][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-03 17:23:21,753][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-03 17:23:21,816][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2023-01-03 17:23:22,485][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2023-01-03 17:23:22,532][__main__][INFO] - Instantiating callbacks...
[2023-01-03 17:23:22,533][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-03 17:23:22,536][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-03 17:23:22,538][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-03 17:23:22,538][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-03 17:23:22,539][__main__][INFO] - Instantiating loggers...
[2023-01-03 17:23:22,539][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-03 17:23:22,540][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-03 17:24:02,245][__main__][INFO] - Starting training!
[2023-01-03 17:24:07,858][src.datamodules.undc_pc_datamodule][INFO] - Loading Train dataset...
[2023-01-03 17:24:07,862][src.datamodules.undc_pc_datamodule][INFO] - Train dataset [ABC_pc_hdf5] of size 8560 had been created.
[2023-01-03 17:24:07,862][src.datamodules.undc_pc_datamodule][INFO] - Loading Val dataset...
[2023-01-03 17:24:07,864][src.datamodules.undc_pc_datamodule][INFO] - Val dataset [ABC_pc_hdf5] of size 1071 had been created.
[2023-01-03 17:24:07,864][src.datamodules.undc_pc_datamodule][INFO] - Loading Test dataset...
[2023-01-03 17:24:07,865][src.datamodules.undc_pc_datamodule][INFO] - Test dataset [ABC_pc_hdf5] of size 1071 had been created.
[2023-01-03 17:24:25,782][__main__][INFO] - Starting testing!
[2023-01-03 17:24:25,796][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-01-03 17:24:28,189][__main__][INFO] - Best ckpt path: None
[2023-01-03 17:24:28,194][src.utils.utils][INFO] - Closing loggers...
[2023-01-03 17:24:28,196][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-03_17-23-21
[2023-01-03 17:24:28,197][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-01-05 00:24:42,323][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-05 00:24:42,331][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-05 00:24:42,331][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-05 00:24:42,399][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-05 00:24:43,001][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2023-01-05 00:24:43,051][__main__][INFO] - Instantiating callbacks...
[2023-01-05 00:24:43,052][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-05 00:24:43,056][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-05 00:24:43,057][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-05 00:24:43,058][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-05 00:24:43,059][__main__][INFO] - Instantiating loggers...
[2023-01-05 00:24:43,059][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-05 00:24:43,059][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-05 00:25:23,718][__main__][INFO] - Starting training!
[2023-01-05 00:26:18,616][__main__][INFO] - Starting testing!
[2023-01-05 00:26:18,618][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-01-05 00:26:19,076][__main__][INFO] - Best ckpt path: None
[2023-01-05 00:26:19,082][src.utils.utils][INFO] - Closing loggers...
[2023-01-05 00:26:19,086][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-05_00-24-42
[2023-01-05 00:26:19,087][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-01-05 00:26:32,077][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-05 00:26:32,084][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-05 00:26:32,085][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-05 00:26:32,152][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-05 00:26:32,772][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2023-01-05 00:26:32,847][__main__][INFO] - Instantiating callbacks...
[2023-01-05 00:26:32,848][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-05 00:26:32,855][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-05 00:26:32,857][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-05 00:26:32,858][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-05 00:26:32,859][__main__][INFO] - Instantiating loggers...
[2023-01-05 00:26:32,859][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-05 00:26:32,860][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-05 00:27:12,962][__main__][INFO] - Starting training!
[2023-01-05 00:27:18,582][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-05 00:27:18,605][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 46302 had been created.
[2023-01-05 00:27:18,606][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-05 00:27:18,619][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 5788 had been created.
[2023-01-05 00:27:18,619][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-05 00:27:18,631][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 5788 had been created.
[2023-01-05 00:27:31,222][__main__][INFO] - Starting testing!
[2023-01-05 00:27:31,240][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-01-05 00:27:33,045][__main__][INFO] - Best ckpt path: None
[2023-01-05 00:27:33,052][src.utils.utils][INFO] - Closing loggers...
[2023-01-05 00:27:33,056][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-05_00-26-31
[2023-01-05 00:27:33,057][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-01-05 00:29:48,588][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-05 00:29:48,595][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-05 00:29:48,596][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-05 00:29:48,673][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-05 00:29:49,387][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2023-01-05 00:29:49,477][__main__][INFO] - Instantiating callbacks...
[2023-01-05 00:29:49,478][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-05 00:29:49,484][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-05 00:29:49,486][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-05 00:29:49,487][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-05 00:29:49,488][__main__][INFO] - Instantiating loggers...
[2023-01-05 00:29:49,489][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-05 00:29:49,489][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-05 00:30:29,643][__main__][INFO] - Starting training!
[2023-01-05 00:30:35,181][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-05 00:30:35,197][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 46302 had been created.
[2023-01-05 00:30:35,198][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-05 00:30:35,206][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 5788 had been created.
[2023-01-05 00:30:35,206][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-05 00:30:35,214][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 5788 had been created.
[2023-01-05 02:56:20,506][__main__][INFO] - Starting testing!
[2023-01-05 03:01:52,760][__main__][INFO] - Best ckpt path: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-05_00-29-48/checkpoints/epoch_000.ckpt
[2023-01-05 03:01:52,764][src.utils.utils][INFO] - Closing loggers...
[2023-01-05 03:01:52,766][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-05_00-29-48
[2023-01-05 03:01:52,767][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-01-06 14:12:17,737][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-06 14:12:17,750][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-06 14:12:17,751][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-06 14:12:17,873][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-06 14:12:18,546][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2023-01-06 14:12:18,596][__main__][INFO] - Instantiating callbacks...
[2023-01-06 14:12:18,597][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-06 14:12:18,601][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-06 14:12:18,602][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-06 14:12:18,603][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-06 14:12:18,604][__main__][INFO] - Instantiating loggers...
[2023-01-06 14:12:18,604][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-06 14:12:18,604][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-06 14:12:58,274][__main__][INFO] - Starting training!
[2023-01-06 14:13:03,587][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-06 14:13:03,605][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 46302 had been created.
[2023-01-06 14:13:03,605][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-06 14:13:03,614][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 5788 had been created.
[2023-01-06 14:13:03,615][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-06 14:13:03,623][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 5788 had been created.
[2023-01-06 14:13:19,676][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 72, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1285, in _run_train
    self.fit_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/fit_loop.py", line 270, in advance
    self._outputs = self.epoch_loop.run(self._data_fetcher)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 174, in advance
    batch = next(data_fetcher)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 185, in __next__
    return self.fetching_function()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 264, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 278, in _fetch_next_batch
    batch = next(iterator)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/supporters.py", line 558, in __next__
    return self.request_next_batch(self.loader_iters)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/supporters.py", line 570, in request_next_batch
    return apply_to_collection(loader_iters, Iterator, next)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/apply_func.py", line 100, in apply_to_collection
    return function(data, *args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 681, in __next__
    data = self._next_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1356, in _next_data
    return self._process_data(data)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1402, in _process_data
    data.reraise()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/_utils.py", line 461, in reraise
    raise exception
FileNotFoundError: Caught FileNotFoundError in DataLoader worker process 2.
Original Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/fubao/dev/my-ndc/src/datamodules/components/pc_dataset2.py", line 60, in __getitem__
    gt_output_bool_, gt_output_float_, gt_input_ = read_and_augment_data_undc(
  File "/home/fubao/dev/my-ndc/src/utils/ndc_utils.py", line 237, in read_and_augment_data_undc
    LOD_gt_int, LOD_gt_float, LOD_input = read_data(hdf5_dir,grid_size,input_type,out_bool,out_float,is_undc=True)
  File "/home/fubao/dev/my-ndc/src/utils/ndc_utils.py", line 78, in read_data
    hdf5_file = h5py.File(hdf5_dir, 'r')
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/h5py/_hl/files.py", line 533, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, fcpl, swmr=swmr)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/h5py/_hl/files.py", line 226, in make_fid
    fid = h5f.open(name, flags, fapl=fapl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 106, in h5py.h5f.open
FileNotFoundError: [Errno 2] Unable to open file (unable to open file: name = '/home/fubao/dev/my-ndc/src/utils/data_preprocessing/get_groundtruth_UNDC/my_gt_UNDC2/trashcan/11951_s11_p00_f09_00.hdf5', errno = 2, error message = 'No such file or directory', flags = 0, o_flags = 0)

[2023-01-06 14:13:19,689][src.utils.utils][INFO] - Closing loggers...
[2023-01-06 14:20:57,554][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-06 14:20:57,562][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-06 14:20:57,562][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-06 14:20:57,637][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-06 14:20:58,252][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2023-01-06 14:20:58,303][__main__][INFO] - Instantiating callbacks...
[2023-01-06 14:20:58,304][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-06 14:20:58,308][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-06 14:20:58,309][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-06 14:20:58,310][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-06 14:20:58,311][__main__][INFO] - Instantiating loggers...
[2023-01-06 14:20:58,311][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-06 14:20:58,311][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-06 14:21:37,338][__main__][INFO] - Starting training!
[2023-01-06 14:21:42,754][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-06 14:21:42,777][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 42760 had been created.
[2023-01-06 14:21:42,777][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-06 14:21:42,790][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 5345 had been created.
[2023-01-06 14:21:42,790][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-06 14:21:42,802][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 5345 had been created.
[2023-01-06 14:23:35,617][__main__][INFO] - Starting testing!
[2023-01-06 14:23:35,621][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-01-06 14:23:38,348][__main__][INFO] - Best ckpt path: None
[2023-01-06 14:23:38,354][src.utils.utils][INFO] - Closing loggers...
[2023-01-06 14:23:38,357][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-06_14-20-57
[2023-01-06 14:23:38,358][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-01-06 14:23:57,774][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-06 14:23:57,782][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-06 14:23:57,783][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-06 14:23:57,852][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-06 14:23:58,493][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2023-01-06 14:23:58,545][__main__][INFO] - Instantiating callbacks...
[2023-01-06 14:23:58,546][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-06 14:23:58,550][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-06 14:23:58,552][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-06 14:23:58,553][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-06 14:23:58,553][__main__][INFO] - Instantiating loggers...
[2023-01-06 14:23:58,554][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-06 14:23:58,554][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-06 14:24:37,858][__main__][INFO] - Starting training!
[2023-01-06 14:24:43,207][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-06 14:24:43,235][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 42760 had been created.
[2023-01-06 14:24:43,236][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-06 14:24:43,253][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 5345 had been created.
[2023-01-06 14:24:43,254][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-06 14:24:43,270][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 5345 had been created.
[2023-01-06 14:28:57,152][__main__][INFO] - Starting testing!
[2023-01-06 14:28:57,155][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-01-06 14:28:58,687][__main__][INFO] - Best ckpt path: None
[2023-01-06 14:28:58,707][src.utils.utils][INFO] - Closing loggers...
[2023-01-06 14:28:58,711][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-06_14-23-57
[2023-01-06 14:28:58,712][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-01-06 15:37:31,067][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-06 15:37:31,076][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-06 15:37:31,076][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-06 15:37:31,147][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-06 15:37:31,848][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2023-01-06 15:37:31,901][__main__][INFO] - Instantiating callbacks...
[2023-01-06 15:37:31,902][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-06 15:37:31,906][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-06 15:37:31,908][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-06 15:37:31,908][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-06 15:37:31,909][__main__][INFO] - Instantiating loggers...
[2023-01-06 15:37:31,910][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-06 15:37:31,910][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-06 15:38:11,166][__main__][INFO] - Starting training!
[2023-01-06 15:38:16,492][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-06 15:38:16,502][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 72, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1107, in _run
    self._call_setup_hook()  # allow user to setup lightning_module in accelerator environment
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1449, in _call_setup_hook
    self._call_lightning_datamodule_hook("setup", stage=fn)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1571, in _call_lightning_datamodule_hook
    return fn(*args, **kwargs)
  File "/home/fubao/dev/my-ndc/src/datamodules/undc_pc_datamodule2.py", line 48, in setup
    self.data_train = ABC_pc_hdf5(
  File "/home/fubao/dev/my-ndc/src/datamodules/components/pc_dataset2.py", line 25, in __init__
    with open(f"{data_dir}/my_obj_list.txt", "r") as fp:
FileNotFoundError: [Errno 2] No such file or directory: '/home/fubao/dev/my-ndc/src/utils/data_preprocessing/get_groundtruth_UNDC/my_gt_UNDC_test/my_obj_list.txt'
[2023-01-06 15:38:16,509][src.utils.utils][INFO] - Closing loggers...
[2023-01-06 15:38:59,327][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-06 15:38:59,335][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-06 15:38:59,336][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-06 15:38:59,407][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-06 15:39:00,096][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2023-01-06 15:39:00,148][__main__][INFO] - Instantiating callbacks...
[2023-01-06 15:39:00,149][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-06 15:39:00,153][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-06 15:39:00,155][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-06 15:39:00,156][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-06 15:39:00,156][__main__][INFO] - Instantiating loggers...
[2023-01-06 15:39:00,157][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-06 15:39:00,157][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-06 15:39:39,642][__main__][INFO] - Starting training!
[2023-01-06 15:39:44,955][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-06 15:39:44,957][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 12 had been created.
[2023-01-06 15:39:44,957][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-06 15:39:44,957][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 2 had been created.
[2023-01-06 15:39:44,957][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-06 15:39:44,958][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 2 had been created.
[2023-01-06 15:40:14,302][__main__][INFO] - Starting testing!
[2023-01-06 15:40:18,098][__main__][INFO] - Best ckpt path: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-06_15-38-59/checkpoints/epoch_000.ckpt
[2023-01-06 15:40:18,102][src.utils.utils][INFO] - Closing loggers...
[2023-01-06 15:40:18,104][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-06_15-38-59
[2023-01-06 15:40:18,105][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-01-06 15:56:56,427][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-06 15:56:56,435][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-06 15:56:56,436][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-06 15:56:56,506][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-06 15:56:57,144][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2023-01-06 15:56:57,196][__main__][INFO] - Instantiating callbacks...
[2023-01-06 15:56:57,197][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-06 15:56:57,201][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-06 15:56:57,203][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-06 15:56:57,204][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-06 15:56:57,204][__main__][INFO] - Instantiating loggers...
[2023-01-06 15:56:57,205][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-06 15:56:57,205][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-06 15:57:36,487][__main__][INFO] - Starting training!
[2023-01-06 15:57:41,719][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-06 15:57:41,721][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 64 had been created.
[2023-01-06 15:57:41,721][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-06 15:57:41,721][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 8 had been created.
[2023-01-06 15:57:41,721][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-06 15:57:41,722][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 8 had been created.
[2023-01-06 15:58:29,540][__main__][INFO] - Starting testing!
[2023-01-06 15:58:33,928][__main__][INFO] - Best ckpt path: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-06_15-56-56/checkpoints/epoch_000.ckpt
[2023-01-06 15:58:33,932][src.utils.utils][INFO] - Closing loggers...
[2023-01-06 15:58:33,934][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-06_15-56-56
[2023-01-06 15:58:33,935][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-01-06 16:02:03,546][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-06 16:02:03,554][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-06 16:02:03,555][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-06 16:02:03,624][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-06 16:02:04,352][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2023-01-06 16:02:04,409][__main__][INFO] - Instantiating callbacks...
[2023-01-06 16:02:04,410][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-06 16:02:04,414][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-06 16:02:04,416][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-06 16:02:04,417][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-06 16:02:04,418][__main__][INFO] - Instantiating loggers...
[2023-01-06 16:02:04,418][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-06 16:02:04,418][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-06 16:02:43,714][__main__][INFO] - Starting training!
[2023-01-06 16:02:49,082][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-06 16:02:49,083][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 64 had been created.
[2023-01-06 16:02:49,084][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-06 16:02:49,084][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 8 had been created.
[2023-01-06 16:02:49,084][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-06 16:02:49,084][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 8 had been created.
[2023-01-06 16:04:47,017][__main__][INFO] - Starting testing!
[2023-01-06 16:05:14,925][__main__][INFO] - Best ckpt path: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-06_16-02-03/checkpoints/epoch_000.ckpt
[2023-01-06 16:05:14,929][src.utils.utils][INFO] - Closing loggers...
[2023-01-06 16:05:14,931][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-06_16-02-03
[2023-01-06 16:05:14,932][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-01-06 16:14:56,783][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-06 16:14:56,792][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-06 16:14:56,792][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-06 16:14:56,861][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-06 16:14:57,552][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2023-01-06 16:14:57,607][__main__][INFO] - Instantiating callbacks...
[2023-01-06 16:14:57,607][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-06 16:14:57,611][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-06 16:14:57,613][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-06 16:14:57,614][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-06 16:14:57,615][__main__][INFO] - Instantiating loggers...
[2023-01-06 16:14:57,615][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-06 16:14:57,615][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-06 16:15:37,234][__main__][INFO] - Starting training!
[2023-01-06 16:15:42,620][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-06 16:15:42,631][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 3294 had been created.
[2023-01-06 16:15:42,632][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-06 16:15:42,641][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 412 had been created.
[2023-01-06 16:15:42,641][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-06 16:15:42,650][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 412 had been created.
[2023-01-06 16:32:09,564][__main__][INFO] - Starting testing!
[2023-01-06 16:32:44,055][__main__][INFO] - Best ckpt path: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-06_16-14-56/checkpoints/epoch_000.ckpt
[2023-01-06 16:32:44,058][src.utils.utils][INFO] - Closing loggers...
[2023-01-06 16:32:44,060][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-06_16-14-56
[2023-01-06 16:32:44,061][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-01-06 16:36:14,654][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-06 16:36:14,662][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-06 16:36:14,663][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-06 16:36:14,735][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-06 16:36:15,357][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2023-01-06 16:36:22,678][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "/home/fubao/dev/my-ndc/src/models/undc_module.py", line 39, in __init__
    self.net_bool.load_state_dict(torch.load(net_bool_pth))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1604, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for local_pointnet:
	Missing key(s) in state_dict: "pc_conv_0.linear_1.weight", "pc_conv_0.linear_1.bias", "pc_conv_0.linear_2.weight", "pc_conv_0.linear_2.bias", "pc_res_1.linear_1.weight", "pc_res_1.linear_1.bias", "pc_res_1.linear_2.weight", "pc_res_1.linear_2.bias", "pc_conv_1.linear_1.weight", "pc_conv_1.linear_1.bias", "pc_conv_1.linear_2.weight", "pc_conv_1.linear_2.bias", "pc_res_2.linear_1.weight", "pc_res_2.linear_1.bias", "pc_res_2.linear_2.weight", "pc_res_2.linear_2.bias", "pc_conv_2.linear_1.weight", "pc_conv_2.linear_1.bias", "pc_conv_2.linear_2.weight", "pc_conv_2.linear_2.bias", "pc_res_3.linear_1.weight", "pc_res_3.linear_1.bias", "pc_res_3.linear_2.weight", "pc_res_3.linear_2.bias", "pc_conv_3.linear_1.weight", "pc_conv_3.linear_1.bias", "pc_conv_3.linear_2.weight", "pc_conv_3.linear_2.bias", "pc_res_4.linear_1.weight", "pc_res_4.linear_1.bias", "pc_res_4.linear_2.weight", "pc_res_4.linear_2.bias", "pc_conv_4.linear_1.weight", "pc_conv_4.linear_1.bias", "pc_conv_4.linear_2.weight", "pc_conv_4.linear_2.bias", "pc_res_5.linear_1.weight", "pc_res_5.linear_1.bias", "pc_res_5.linear_2.weight", "pc_res_5.linear_2.bias", "pc_conv_5.linear_1.weight", "pc_conv_5.linear_1.bias", "pc_conv_5.linear_2.weight", "pc_conv_5.linear_2.bias", "pc_res_6.linear_1.weight", "pc_res_6.linear_1.bias", "pc_res_6.linear_2.weight", "pc_res_6.linear_2.bias", "pc_conv_6.linear_1.weight", "pc_conv_6.linear_1.bias", "pc_conv_6.linear_2.weight", "pc_conv_6.linear_2.bias", "pc_res_7.linear_1.weight", "pc_res_7.linear_1.bias", "pc_res_7.linear_2.weight", "pc_res_7.linear_2.bias", "conv_1.weight", "conv_1.bias", "conv_2.weight", "conv_2.bias", "conv_3.weight", "conv_3.bias", "conv_4.weight", "conv_4.bias", "conv_5.weight", "conv_5.bias", "pc_conv_out_bool.weight", "pc_conv_out_bool.bias", "pc_conv_out_float.weight", "pc_conv_out_float.bias". 
	Unexpected key(s) in state_dict: "epoch", "global_step", "pytorch-lightning_version", "state_dict", "loops", "callbacks", "optimizer_states", "lr_schedulers", "hparams_name", "hyper_parameters", "datamodule_hparams_name", "datamodule_hyper_parameters". 

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 46, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 339, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.models.undc_module.UNDCLitModule':
RuntimeError('Error(s) in loading state_dict for local_pointnet:\n\tMissing key(s) in state_dict: "pc_conv_0.linear_1.weight", "pc_conv_0.linear_1.bias", "pc_conv_0.linear_2.weight", "pc_conv_0.linear_2.bias", "pc_res_1.linear_1.weight", "pc_res_1.linear_1.bias", "pc_res_1.linear_2.weight", "pc_res_1.linear_2.bias", "pc_conv_1.linear_1.weight", "pc_conv_1.linear_1.bias", "pc_conv_1.linear_2.weight", "pc_conv_1.linear_2.bias", "pc_res_2.linear_1.weight", "pc_res_2.linear_1.bias", "pc_res_2.linear_2.weight", "pc_res_2.linear_2.bias", "pc_conv_2.linear_1.weight", "pc_conv_2.linear_1.bias", "pc_conv_2.linear_2.weight", "pc_conv_2.linear_2.bias", "pc_res_3.linear_1.weight", "pc_res_3.linear_1.bias", "pc_res_3.linear_2.weight", "pc_res_3.linear_2.bias", "pc_conv_3.linear_1.weight", "pc_conv_3.linear_1.bias", "pc_conv_3.linear_2.weight", "pc_conv_3.linear_2.bias", "pc_res_4.linear_1.weight", "pc_res_4.linear_1.bias", "pc_res_4.linear_2.weight", "pc_res_4.linear_2.bias", "pc_conv_4.linear_1.weight", "pc_conv_4.linear_1.bias", "pc_conv_4.linear_2.weight", "pc_conv_4.linear_2.bias", "pc_res_5.linear_1.weight", "pc_res_5.linear_1.bias", "pc_res_5.linear_2.weight", "pc_res_5.linear_2.bias", "pc_conv_5.linear_1.weight", "pc_conv_5.linear_1.bias", "pc_conv_5.linear_2.weight", "pc_conv_5.linear_2.bias", "pc_res_6.linear_1.weight", "pc_res_6.linear_1.bias", "pc_res_6.linear_2.weight", "pc_res_6.linear_2.bias", "pc_conv_6.linear_1.weight", "pc_conv_6.linear_1.bias", "pc_conv_6.linear_2.weight", "pc_conv_6.linear_2.bias", "pc_res_7.linear_1.weight", "pc_res_7.linear_1.bias", "pc_res_7.linear_2.weight", "pc_res_7.linear_2.bias", "conv_1.weight", "conv_1.bias", "conv_2.weight", "conv_2.bias", "conv_3.weight", "conv_3.bias", "conv_4.weight", "conv_4.bias", "conv_5.weight", "conv_5.bias", "pc_conv_out_bool.weight", "pc_conv_out_bool.bias", "pc_conv_out_float.weight", "pc_conv_out_float.bias". \n\tUnexpected key(s) in state_dict: "epoch", "global_step", "pytorch-lightning_version", "state_dict", "loops", "callbacks", "optimizer_states", "lr_schedulers", "hparams_name", "hyper_parameters", "datamodule_hparams_name", "datamodule_hyper_parameters". ')
full_key: model
[2023-01-06 16:36:22,683][src.utils.utils][INFO] - Closing loggers...
[2023-01-06 16:39:33,509][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-06 16:39:33,517][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-06 16:39:33,517][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-06 16:39:33,587][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-06 16:39:34,307][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2023-01-06 16:39:41,558][__main__][INFO] - Instantiating callbacks...
[2023-01-06 16:39:41,559][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-06 16:39:41,565][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-06 16:39:41,567][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-06 16:39:41,568][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-06 16:39:41,569][__main__][INFO] - Instantiating loggers...
[2023-01-06 16:39:41,570][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-06 16:39:41,570][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-06 16:39:41,955][__main__][INFO] - Starting training!
[2023-01-06 16:39:41,960][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-06 16:39:41,969][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 3294 had been created.
[2023-01-06 16:39:41,969][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-06 16:39:41,977][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 412 had been created.
[2023-01-06 16:39:41,978][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-06 16:39:41,985][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 412 had been created.
[2023-01-06 16:41:30,124][__main__][INFO] - Starting testing!
[2023-01-06 16:41:30,125][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-01-06 16:41:32,587][__main__][INFO] - Best ckpt path: None
[2023-01-06 16:41:32,593][src.utils.utils][INFO] - Closing loggers...
[2023-01-06 16:41:32,596][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-06_16-39-33
[2023-01-06 16:41:32,597][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-01-06 16:45:51,220][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-06 16:45:51,228][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-06 16:45:51,228][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-06 16:45:51,303][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-06 16:45:52,023][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2023-01-06 16:45:52,079][__main__][INFO] - Instantiating callbacks...
[2023-01-06 16:45:52,080][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-06 16:45:52,084][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-06 16:45:52,086][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-06 16:45:52,087][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-06 16:45:52,088][__main__][INFO] - Instantiating loggers...
[2023-01-06 16:45:52,088][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-06 16:45:52,088][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-06 16:46:31,293][__main__][INFO] - Starting training!
[2023-01-06 16:46:36,620][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-06 16:46:36,631][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 3294 had been created.
[2023-01-06 16:46:36,632][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-06 16:46:36,642][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 412 had been created.
[2023-01-06 16:46:36,643][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-06 16:46:36,653][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 412 had been created.
[2023-01-06 16:52:11,771][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 72, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1285, in _run_train
    self.fit_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 201, in run
    self.on_advance_end()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/fit_loop.py", line 286, in on_advance_end
    epoch_end_outputs = self.trainer._call_lightning_module_hook("training_epoch_end", epoch_end_outputs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1552, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
  File "/home/fubao/dev/my-ndc/src/models/undc_module.py", line 133, in training_epoch_end
    torch.save(self.net.state_dict(),f"{self.out_dir}/weights/net_bool-{self.epoch_idx}.pth")
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/serialization.py", line 376, in save
    with _open_file_like(f, 'wb') as opened_file:
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/serialization.py", line 230, in _open_file_like
    return _open_file(name_or_buffer, mode)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/serialization.py", line 211, in __init__
    super(_open_file, self).__init__(open(name, mode))
FileNotFoundError: [Errno 2] No such file or directory: '/home/fubao/dev/my-ndc/logs/train/runs/2023-01-06_16-45-51/weights/net_bool-1.pth'
[2023-01-06 16:52:11,777][src.utils.utils][INFO] - Closing loggers...
[2023-01-06 16:52:51,540][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-06 16:52:51,549][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-06 16:52:51,550][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-06 16:52:51,620][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-06 16:52:52,323][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2023-01-06 16:52:52,379][__main__][INFO] - Instantiating callbacks...
[2023-01-06 16:52:52,380][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-06 16:52:52,385][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-06 16:52:52,386][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-06 16:52:52,387][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-06 16:52:52,388][__main__][INFO] - Instantiating loggers...
[2023-01-06 16:52:52,388][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-06 16:52:52,389][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-06 16:53:31,606][__main__][INFO] - Starting training!
[2023-01-06 16:53:37,072][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-06 16:53:37,080][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 3294 had been created.
[2023-01-06 16:53:37,081][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-06 16:53:37,088][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 412 had been created.
[2023-01-06 16:53:37,088][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-06 16:53:37,095][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 412 had been created.
[2023-01-06 17:12:29,729][__main__][INFO] - Starting testing!
[2023-01-06 17:12:32,399][__main__][INFO] - Best ckpt path: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-06_16-52-51/checkpoints/epoch_002.ckpt
[2023-01-06 17:12:32,409][src.utils.utils][INFO] - Closing loggers...
[2023-01-06 17:12:32,412][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-06_16-52-51
[2023-01-06 17:12:32,413][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-01-06 17:13:06,296][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-06 17:13:06,304][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-06 17:13:06,304][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-06 17:13:06,373][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-06 17:13:07,016][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2023-01-06 17:13:07,074][__main__][INFO] - Instantiating callbacks...
[2023-01-06 17:13:07,075][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-06 17:13:07,080][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-06 17:13:07,082][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-06 17:13:07,082][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-06 17:13:07,083][__main__][INFO] - Instantiating loggers...
[2023-01-06 17:13:07,084][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-06 17:13:07,084][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-06 17:13:47,039][__main__][INFO] - Starting training!
[2023-01-06 17:13:52,354][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-06 17:13:52,364][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 3294 had been created.
[2023-01-06 17:13:52,364][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-06 17:13:52,377][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 412 had been created.
[2023-01-06 17:13:52,377][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-06 17:13:52,388][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 412 had been created.
[2023-01-06 17:37:16,421][__main__][INFO] - Starting testing!
[2023-01-06 17:37:18,443][__main__][INFO] - Best ckpt path: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-06_17-13-06/checkpoints/epoch_000.ckpt
[2023-01-06 17:37:18,460][src.utils.utils][INFO] - Closing loggers...
[2023-01-06 17:37:18,464][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-06_17-13-06
[2023-01-06 17:37:18,466][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-01-06 17:38:12,467][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-06 17:38:12,474][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-06 17:38:12,474][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-06 17:38:12,554][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-06 17:38:13,240][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2023-01-06 17:38:20,783][__main__][INFO] - Instantiating callbacks...
[2023-01-06 17:38:20,784][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-06 17:38:20,789][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-06 17:38:20,791][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-06 17:38:20,792][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-06 17:38:20,793][__main__][INFO] - Instantiating loggers...
[2023-01-06 17:38:20,793][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-06 17:38:20,793][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-06 17:38:21,141][__main__][INFO] - Starting training!
[2023-01-06 17:38:21,147][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-06 17:38:21,160][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 3294 had been created.
[2023-01-06 17:38:21,161][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-06 17:38:21,170][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 412 had been created.
[2023-01-06 17:38:21,170][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-06 17:38:21,178][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 412 had been created.
[2023-01-06 20:36:54,634][__main__][INFO] - Starting testing!
[2023-01-06 20:38:11,828][__main__][INFO] - Best ckpt path: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-06_17-38-12/checkpoints/epoch_000.ckpt
[2023-01-06 20:38:11,832][src.utils.utils][INFO] - Closing loggers...
[2023-01-06 20:38:11,834][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-06_17-38-12
[2023-01-06 20:38:11,834][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-01-08 13:40:37,147][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-08 13:40:37,154][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-08 13:40:37,155][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-08 13:40:37,218][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-08 13:40:37,824][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2023-01-08 13:40:37,879][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "/home/fubao/dev/my-ndc/src/models/undc_module.py", line 39, in __init__
    self.net_bool.load_state_dict(torch.load(net_bool_pth),strict=False)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/serialization.py", line 699, in load
    with _open_file_like(f, 'rb') as opened_file:
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/serialization.py", line 230, in _open_file_like
    return _open_file(name_or_buffer, mode)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/serialization.py", line 211, in __init__
    super(_open_file, self).__init__(open(name, mode))
FileNotFoundError: [Errno 2] No such file or directory: '/home/fubao/dev/my-ndc/logs/train/runs/2023-01-06_17-13-06/net_bool-4.pth'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 46, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 339, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.models.undc_module.UNDCLitModule':
FileNotFoundError(2, 'No such file or directory')
full_key: model
[2023-01-08 13:40:37,881][src.utils.utils][INFO] - Closing loggers...
[2023-01-08 13:41:34,278][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-08 13:41:34,285][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-08 13:41:34,285][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-08 13:41:34,346][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-08 13:41:34,998][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2023-01-08 13:41:35,054][__main__][INFO] - Instantiating callbacks...
[2023-01-08 13:41:35,054][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-08 13:41:35,058][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-08 13:41:35,060][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-08 13:41:35,061][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-08 13:41:35,061][__main__][INFO] - Instantiating loggers...
[2023-01-08 13:41:35,062][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-08 13:41:35,062][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-08 13:42:16,721][__main__][INFO] - Starting training!
[2023-01-08 13:42:22,397][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-08 13:42:22,406][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 3294 had been created.
[2023-01-08 13:42:22,406][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-08 13:42:22,413][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 412 had been created.
[2023-01-08 13:42:22,413][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-08 13:42:22,419][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 412 had been created.
[2023-01-08 13:43:25,110][__main__][INFO] - Starting testing!
[2023-01-08 13:43:25,111][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-01-08 13:43:38,998][__main__][INFO] - Best ckpt path: None
[2023-01-08 13:43:39,009][src.utils.utils][INFO] - Closing loggers...
[2023-01-08 13:43:39,014][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-08_13-41-34
[2023-01-08 13:43:39,016][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-01-08 13:59:40,671][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-08 13:59:40,677][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-08 13:59:40,678][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-08 13:59:40,739][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-08 13:59:41,321][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2023-01-08 13:59:41,370][__main__][INFO] - Instantiating callbacks...
[2023-01-08 13:59:41,370][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-08 13:59:41,374][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-08 13:59:41,376][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-08 13:59:41,376][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-08 13:59:41,377][__main__][INFO] - Instantiating loggers...
[2023-01-08 13:59:41,378][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-08 13:59:41,378][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-08 14:00:23,561][__main__][INFO] - Starting training!
[2023-01-08 14:00:29,147][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-08 14:00:29,159][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 3294 had been created.
[2023-01-08 14:00:29,159][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-08 14:00:29,167][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 412 had been created.
[2023-01-08 14:00:29,168][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-08 14:00:29,176][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 412 had been created.
[2023-01-08 14:16:31,225][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-08 14:16:31,231][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-08 14:16:31,232][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-08 14:16:31,293][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-08 14:16:31,862][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2023-01-08 14:16:31,919][__main__][INFO] - Instantiating callbacks...
[2023-01-08 14:16:31,919][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-08 14:16:31,923][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-08 14:16:31,924][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-08 14:16:31,925][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-08 14:16:31,926][__main__][INFO] - Instantiating loggers...
[2023-01-08 14:16:31,927][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-08 14:16:31,927][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-08 14:17:16,763][__main__][INFO] - Starting training!
[2023-01-08 14:17:23,104][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-08 14:17:23,120][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 3294 had been created.
[2023-01-08 14:17:23,120][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-08 14:17:23,131][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 412 had been created.
[2023-01-08 14:17:23,131][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-08 14:17:23,140][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 412 had been created.
[2023-01-08 14:17:30,812][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1163, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/queue.py", line 178, in get
    raise Empty
_queue.Empty

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 72, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_train
    self._run_sanity_check()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1345, in _run_sanity_check
    val_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 155, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 127, in advance
    batch = next(data_fetcher)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 185, in __next__
    return self.fetching_function()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 264, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 278, in _fetch_next_batch
    batch = next(iterator)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 681, in __next__
    data = self._next_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1359, in _next_data
    idx, data = self._get_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1315, in _get_data
    success, data = self._try_get_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1176, in _try_get_data
    raise RuntimeError('DataLoader worker (pid(s) {}) exited unexpectedly'.format(pids_str)) from e
RuntimeError: DataLoader worker (pid(s) 44089, 44137, 44186, 44234, 44282, 44335, 44383, 44432, 44481, 44529, 44577, 44626, 44674, 44722, 44771, 44819, 44868, 44916, 44965, 45016, 45064, 45113, 45169, 45217) exited unexpectedly
[2023-01-08 14:17:30,821][src.utils.utils][INFO] - Closing loggers...
[2023-01-08 14:25:37,748][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-08 14:25:37,756][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-08 14:25:37,757][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-08 14:25:37,849][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-08 14:25:38,470][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2023-01-08 14:25:38,529][__main__][INFO] - Instantiating callbacks...
[2023-01-08 14:25:38,529][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-08 14:25:38,534][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-08 14:25:38,535][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-08 14:25:38,536][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-08 14:25:38,537][__main__][INFO] - Instantiating loggers...
[2023-01-08 14:25:38,537][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-08 14:25:38,538][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-08 14:25:42,851][src.utils.utils][INFO] - Closing loggers...
[2023-01-08 14:28:28,655][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-08 14:28:28,661][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-08 14:28:28,662][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-08 14:28:28,724][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-08 14:28:29,359][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2023-01-08 14:28:29,416][__main__][INFO] - Instantiating callbacks...
[2023-01-08 14:28:29,417][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-08 14:28:29,421][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-08 14:28:29,423][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-08 14:28:29,424][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-08 14:28:29,424][__main__][INFO] - Instantiating loggers...
[2023-01-08 14:28:29,425][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-08 14:28:29,425][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-08 14:29:13,755][__main__][INFO] - Starting training!
[2023-01-08 14:29:20,013][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-08 14:29:20,021][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 3294 had been created.
[2023-01-08 14:29:20,021][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-08 14:29:20,026][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 412 had been created.
[2023-01-08 14:29:20,026][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-08 14:29:20,032][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 412 had been created.
[2023-01-08 14:29:27,744][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1163, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/queue.py", line 178, in get
    raise Empty
_queue.Empty

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 72, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_train
    self._run_sanity_check()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1345, in _run_sanity_check
    val_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 155, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 127, in advance
    batch = next(data_fetcher)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 185, in __next__
    return self.fetching_function()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 264, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 278, in _fetch_next_batch
    batch = next(iterator)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 681, in __next__
    data = self._next_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1359, in _next_data
    idx, data = self._get_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1315, in _get_data
    success, data = self._try_get_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1176, in _try_get_data
    raise RuntimeError('DataLoader worker (pid(s) {}) exited unexpectedly'.format(pids_str)) from e
RuntimeError: DataLoader worker (pid(s) 3170, 3219, 3272, 3320, 3368, 3416, 3464, 3513, 3561, 3610, 3658, 3706, 3754, 3802, 3850, 3898, 3946, 3994, 4043, 4091, 4139, 4189, 4237, 4285) exited unexpectedly
[2023-01-08 14:29:27,754][src.utils.utils][INFO] - Closing loggers...
[2023-01-08 14:30:06,944][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-08 14:30:06,951][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-08 14:30:06,951][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-08 14:30:07,016][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-08 14:30:07,640][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2023-01-08 14:30:07,699][__main__][INFO] - Instantiating callbacks...
[2023-01-08 14:30:07,699][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-08 14:30:07,704][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-08 14:30:07,705][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-08 14:30:07,706][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-08 14:30:07,707][__main__][INFO] - Instantiating loggers...
[2023-01-08 14:30:07,707][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-08 14:30:07,708][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-08 14:30:51,789][__main__][INFO] - Starting training!
[2023-01-08 14:30:58,029][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-08 14:30:58,042][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 3294 had been created.
[2023-01-08 14:30:58,043][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-08 14:30:58,051][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 412 had been created.
[2023-01-08 14:30:58,052][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-08 14:30:58,060][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 412 had been created.
[2023-01-08 14:31:12,527][__main__][INFO] - Starting testing!
[2023-01-08 14:31:12,540][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-01-08 14:31:14,805][__main__][INFO] - Best ckpt path: None
[2023-01-08 14:31:14,812][src.utils.utils][INFO] - Closing loggers...
[2023-01-08 14:31:14,814][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-08_14-30-06
[2023-01-08 14:31:14,815][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-01-08 14:53:37,963][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-08 14:53:37,970][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-08 14:53:37,970][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-08 14:53:38,036][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-08 14:53:38,678][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2023-01-08 14:53:38,737][__main__][INFO] - Instantiating callbacks...
[2023-01-08 14:53:38,737][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-08 14:53:38,742][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-08 14:53:38,744][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-08 14:53:38,744][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-08 14:53:38,745][__main__][INFO] - Instantiating loggers...
[2023-01-08 14:53:38,745][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-08 14:53:38,746][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-08 14:54:22,969][__main__][INFO] - Starting training!
[2023-01-08 14:54:29,226][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-08 14:54:29,237][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 3294 had been created.
[2023-01-08 14:54:29,238][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-08 14:54:29,246][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 412 had been created.
[2023-01-08 14:54:29,246][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-08 14:54:29,254][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 412 had been created.
[2023-01-08 15:50:20,565][__main__][INFO] - Starting testing!
[2023-01-08 15:50:49,124][__main__][INFO] - Best ckpt path: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-08_14-53-37/checkpoints/epoch_000.ckpt
[2023-01-08 15:50:49,127][src.utils.utils][INFO] - Closing loggers...
[2023-01-08 15:50:49,128][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-08_14-53-37
[2023-01-08 15:50:49,129][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-01-08 17:35:05,550][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-08 17:35:05,556][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-08 17:35:05,557][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-08 17:35:05,620][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-08 17:35:06,238][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2023-01-08 17:35:13,769][__main__][INFO] - Instantiating callbacks...
[2023-01-08 17:35:13,771][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-08 17:35:13,776][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-08 17:35:13,778][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-08 17:35:13,779][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-08 17:35:13,779][__main__][INFO] - Instantiating loggers...
[2023-01-08 17:35:13,780][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-08 17:35:13,780][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-08 17:35:14,224][__main__][INFO] - Starting training!
[2023-01-08 17:35:14,230][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-08 17:35:14,243][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 3294 had been created.
[2023-01-08 17:35:14,244][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-08 17:35:14,254][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 412 had been created.
[2023-01-08 17:35:14,255][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-08 17:35:14,264][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 412 had been created.
[2023-01-08 19:01:47,900][__main__][INFO] - Starting testing!
[2023-01-08 19:02:31,817][__main__][INFO] - Best ckpt path: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-08_17-35-05/checkpoints/epoch_000.ckpt
[2023-01-08 19:02:31,820][src.utils.utils][INFO] - Closing loggers...
[2023-01-08 19:02:31,821][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-08_17-35-05
[2023-01-08 19:02:31,822][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-01-09 19:57:08,014][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-09 19:57:08,020][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-09 19:57:08,020][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-09 19:57:08,101][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-09 19:57:08,762][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/utils.py", line 639, in _locate
    obj = getattr(obj, part)
AttributeError: module 'src.datamodules' has no attribute 'undc_pc_datamodule2'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/utils.py", line 645, in _locate
    obj = import_module(mod)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1014, in _gcd_import
  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 975, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 671, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/home/fubao/dev/my-ndc/src/datamodules/undc_pc_datamodule2.py", line 8, in <module>
    from src.datamodules.components.pc_dataset4 import ABC_pc_hdf5
  File "/home/fubao/dev/my-ndc/src/datamodules/components/pc_dataset4.py", line 4, in <module>
    from src.utils.ndc_utils import read_data, read_and_augment_data_undc2, read_data_input_only
  File "/home/fubao/dev/my-ndc/src/utils/ndc_utils.py", line 4, in <module>
    import open3d as o3d
ModuleNotFoundError: No module named 'open3d'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/utils.py", line 648, in _locate
    raise ImportError(
ImportError: Error loading 'src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule':
ModuleNotFoundError("No module named 'open3d'")
Are you sure that 'undc_pc_datamodule2' is importable from module 'src.datamodules'?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 43, in train
    datamodule: LightningDataModule = hydra.utils.instantiate(cfg.datamodule)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 325, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule', see chained exception above.
full_key: datamodule
[2023-01-09 19:57:08,765][src.utils.utils][INFO] - Closing loggers...
[2023-01-09 19:59:18,510][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-09 19:59:18,517][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-09 19:59:18,517][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-09 19:59:18,580][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-09 19:59:19,236][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/utils.py", line 639, in _locate
    obj = getattr(obj, part)
AttributeError: module 'src.datamodules' has no attribute 'undc_pc_datamodule2'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/utils.py", line 645, in _locate
    obj = import_module(mod)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1014, in _gcd_import
  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 975, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 671, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/home/fubao/dev/my-ndc/src/datamodules/undc_pc_datamodule2.py", line 8, in <module>
    from src.datamodules.components.pc_dataset3 import ABC_pc_hdf5
  File "/home/fubao/dev/my-ndc/src/datamodules/components/pc_dataset3.py", line 4, in <module>
    from src.utils.ndc_utils import read_data, read_and_augment_data_undc2, read_data_input_only
  File "/home/fubao/dev/my-ndc/src/utils/ndc_utils.py", line 4, in <module>
    import open3d as o3d
ModuleNotFoundError: No module named 'open3d'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/utils.py", line 648, in _locate
    raise ImportError(
ImportError: Error loading 'src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule':
ModuleNotFoundError("No module named 'open3d'")
Are you sure that 'undc_pc_datamodule2' is importable from module 'src.datamodules'?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 43, in train
    datamodule: LightningDataModule = hydra.utils.instantiate(cfg.datamodule)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 325, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule', see chained exception above.
full_key: datamodule
[2023-01-09 19:59:19,238][src.utils.utils][INFO] - Closing loggers...
[2023-01-09 20:03:08,814][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-09 20:03:08,821][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-09 20:03:08,821][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-09 20:03:08,885][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-09 20:03:09,551][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2023-01-09 20:03:16,720][__main__][INFO] - Instantiating callbacks...
[2023-01-09 20:03:16,722][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-09 20:03:16,728][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-09 20:03:16,729][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-09 20:03:16,730][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-09 20:03:16,731][__main__][INFO] - Instantiating loggers...
[2023-01-09 20:03:16,732][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-09 20:03:16,732][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-09 20:03:17,144][__main__][INFO] - Starting training!
[2023-01-09 20:03:17,151][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-09 20:03:17,166][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 3592 had been created.
[2023-01-09 20:03:17,166][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-09 20:03:17,176][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 450 had been created.
[2023-01-09 20:03:17,177][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-09 20:03:17,186][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 450 had been created.
[2023-01-09 20:03:21,041][__main__][INFO] - Starting testing!
[2023-01-09 20:03:21,042][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-01-09 20:03:26,945][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1163, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/queue.py", line 178, in get
    raise Empty
_queue.Empty

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 82, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 864, in test
    return self._call_and_handle_interrupt(self._test_impl, model, dataloaders, ckpt_path, verbose, datamodule)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 911, in _test_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1251, in _run_stage
    return self._run_evaluate()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1297, in _run_evaluate
    eval_loop_results = self._evaluation_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 155, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 127, in advance
    batch = next(data_fetcher)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 185, in __next__
    return self.fetching_function()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 264, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 278, in _fetch_next_batch
    batch = next(iterator)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 681, in __next__
    data = self._next_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1359, in _next_data
    idx, data = self._get_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1315, in _get_data
    success, data = self._try_get_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1176, in _try_get_data
    raise RuntimeError('DataLoader worker (pid(s) {}) exited unexpectedly'.format(pids_str)) from e
RuntimeError: DataLoader worker (pid(s) 19101, 19102, 19103, 19104, 19105, 19106, 19107, 19108, 19109, 19110, 19111, 19112, 19113, 19114, 19115, 19116, 19117, 19118, 19119, 19120, 19226, 19227, 19234, 19235) exited unexpectedly
[2023-01-09 20:03:26,952][src.utils.utils][INFO] - Closing loggers...
[2023-01-10 16:17:48,986][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-10 16:17:48,992][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-10 16:17:48,992][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-10 16:17:49,053][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-10 16:17:49,734][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/utils.py", line 639, in _locate
    obj = getattr(obj, part)
AttributeError: module 'src.datamodules' has no attribute 'undc_pc_datamodule2'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/utils.py", line 645, in _locate
    obj = import_module(mod)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1014, in _gcd_import
  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 975, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 671, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/home/fubao/dev/my-ndc/src/datamodules/undc_pc_datamodule2.py", line 8, in <module>
    from src.datamodules.components.pc_dataset3 import ABC_pc_hdf5
  File "/home/fubao/dev/my-ndc/src/datamodules/components/pc_dataset3.py", line 5, in <module>
    from src.utils.ndc_utils import read_data, read_and_augment_data_undc2, read_data_input_only, read_data2,read_and_augment_data_undc
ImportError: cannot import name 'read_and_augment_data_undc' from 'src.utils.ndc_utils' (/home/fubao/dev/my-ndc/src/utils/ndc_utils.py)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/utils.py", line 653, in _locate
    raise ImportError(
ImportError: Error loading 'src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule':
ImportError("cannot import name 'read_and_augment_data_undc' from 'src.utils.ndc_utils' (/home/fubao/dev/my-ndc/src/utils/ndc_utils.py)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 43, in train
    datamodule: LightningDataModule = hydra.utils.instantiate(cfg.datamodule)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 325, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule', see chained exception above.
full_key: datamodule
[2023-01-10 16:17:49,738][src.utils.utils][INFO] - Closing loggers...
[2023-01-10 16:24:08,091][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-10 16:24:08,098][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-10 16:24:08,099][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-10 16:24:08,164][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-10 16:24:08,805][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2023-01-10 16:24:16,470][__main__][INFO] - Instantiating callbacks...
[2023-01-10 16:24:16,471][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-10 16:24:16,477][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-10 16:24:16,479][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-10 16:24:16,480][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-10 16:24:16,481][__main__][INFO] - Instantiating loggers...
[2023-01-10 16:24:16,481][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-10 16:24:16,481][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-10 16:24:16,947][__main__][INFO] - Starting training!
[2023-01-10 16:24:16,953][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-10 16:24:16,969][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 72, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1107, in _run
    self._call_setup_hook()  # allow user to setup lightning_module in accelerator environment
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1449, in _call_setup_hook
    self._call_lightning_datamodule_hook("setup", stage=fn)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1571, in _call_lightning_datamodule_hook
    return fn(*args, **kwargs)
  File "/home/fubao/dev/my-ndc/src/datamodules/undc_pc_datamodule2.py", line 48, in setup
    self.data_train = ABC_pc_hdf5(
  File "/home/fubao/dev/my-ndc/src/datamodules/components/pc_dataset3.py", line 46, in __init__
    valid_list_dict[cate] = motion_dict[cate][:].astype(np.int32)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/h5py/_hl/group.py", line 330, in __getitem__
    raise TypeError("Accessing a group is done with bytes or str, "
TypeError: Accessing a group is done with bytes or str,  not <class 'slice'>
[2023-01-10 16:24:16,976][src.utils.utils][INFO] - Closing loggers...
[2023-01-10 16:29:24,948][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-10 16:29:24,955][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-10 16:29:24,956][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-10 16:29:25,022][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-10 16:29:25,562][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2023-01-10 16:29:33,161][__main__][INFO] - Instantiating callbacks...
[2023-01-10 16:29:33,163][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-10 16:29:33,168][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-10 16:29:33,170][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-10 16:29:33,170][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-10 16:29:33,171][__main__][INFO] - Instantiating loggers...
[2023-01-10 16:29:33,172][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-10 16:29:33,172][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-10 16:29:33,668][__main__][INFO] - Starting training!
[2023-01-10 16:29:33,675][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-10 16:29:33,761][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 1806 had been created.
[2023-01-10 16:29:33,761][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-10 16:29:33,820][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-10 16:29:33,820][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-10 16:29:33,877][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-10 16:29:34,895][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 72, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_train
    self._run_sanity_check()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1345, in _run_sanity_check
    val_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 155, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 127, in advance
    batch = next(data_fetcher)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 185, in __next__
    return self.fetching_function()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 264, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 278, in _fetch_next_batch
    batch = next(iterator)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 681, in __next__
    data = self._next_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1376, in _next_data
    return self._process_data(data)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1402, in _process_data
    data.reraise()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/_utils.py", line 461, in reraise
    raise exception
TypeError: Caught TypeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/fubao/dev/my-ndc/src/datamodules/components/pc_dataset3.py", line 120, in __getitem__
    gt_output_bool_, gt_output_float_, gt_input_ = read_data2(
TypeError: read_data2() got an unexpected keyword argument 'is_undc'

[2023-01-10 16:29:34,902][src.utils.utils][INFO] - Closing loggers...
[2023-01-10 16:30:35,719][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-10 16:30:35,725][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-10 16:30:35,726][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-10 16:30:35,790][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-10 16:30:36,410][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2023-01-10 16:30:43,959][__main__][INFO] - Instantiating callbacks...
[2023-01-10 16:30:43,960][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-10 16:30:43,965][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-10 16:30:43,967][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-10 16:30:43,968][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-10 16:30:43,969][__main__][INFO] - Instantiating loggers...
[2023-01-10 16:30:43,969][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-10 16:30:43,969][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-10 16:30:44,362][__main__][INFO] - Starting training!
[2023-01-10 16:30:44,366][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-10 16:30:44,422][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 1806 had been created.
[2023-01-10 16:30:44,422][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-10 16:30:44,471][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-10 16:30:44,471][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-10 16:30:44,517][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-10 16:30:45,503][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 72, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_train
    self._run_sanity_check()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1345, in _run_sanity_check
    val_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 155, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 127, in advance
    batch = next(data_fetcher)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 185, in __next__
    return self.fetching_function()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 264, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 278, in _fetch_next_batch
    batch = next(iterator)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 681, in __next__
    data = self._next_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1376, in _next_data
    return self._process_data(data)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1402, in _process_data
    data.reraise()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/_utils.py", line 461, in reraise
    raise exception
FileNotFoundError: Caught FileNotFoundError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/fubao/dev/my-ndc/src/datamodules/components/pc_dataset3.py", line 120, in __getitem__
    gt_output_bool_, gt_output_float_, gt_input_ = read_data2(
  File "/home/fubao/dev/my-ndc/src/utils/ndc_utils.py", line 124, in read_data2
    LOD_input = read_pcs_txt(txt_path)
  File "/home/fubao/dev/my-ndc/src/utils/ndc_utils.py", line 100, in read_pcs_txt
    with open(txt_path, "r") as fp:
FileNotFoundError: [Errno 2] No such file or directory: '/home/fubao/dev/my-ndc/src/utils/data_preprocessing/pc_vscan_iter_part/storage/47701_1.txt'

[2023-01-10 16:30:45,510][src.utils.utils][INFO] - Closing loggers...
[2023-01-10 16:33:04,842][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-10 16:33:04,849][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-10 16:33:04,849][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-10 16:33:04,914][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-10 16:33:05,535][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2023-01-10 16:33:12,802][__main__][INFO] - Instantiating callbacks...
[2023-01-10 16:33:12,803][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-10 16:33:12,809][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-10 16:33:12,810][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-10 16:33:12,811][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-10 16:33:12,812][__main__][INFO] - Instantiating loggers...
[2023-01-10 16:33:12,812][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-10 16:33:12,813][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-10 16:33:13,232][__main__][INFO] - Starting training!
[2023-01-10 16:33:13,238][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-10 16:33:13,326][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 1806 had been created.
[2023-01-10 16:33:13,327][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-10 16:33:13,386][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-10 16:33:13,386][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-10 16:33:13,443][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-10 16:33:20,802][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 72, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1285, in _run_train
    self.fit_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/fit_loop.py", line 270, in advance
    self._outputs = self.epoch_loop.run(self._data_fetcher)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 174, in advance
    batch = next(data_fetcher)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 185, in __next__
    return self.fetching_function()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 264, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 278, in _fetch_next_batch
    batch = next(iterator)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/supporters.py", line 558, in __next__
    return self.request_next_batch(self.loader_iters)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/supporters.py", line 570, in request_next_batch
    return apply_to_collection(loader_iters, Iterator, next)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/apply_func.py", line 100, in apply_to_collection
    return function(data, *args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 681, in __next__
    data = self._next_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1376, in _next_data
    return self._process_data(data)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1402, in _process_data
    data.reraise()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/_utils.py", line 461, in reraise
    raise exception
IndexError: Caught IndexError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/fubao/dev/my-ndc/src/datamodules/components/pc_dataset3.py", line 108, in __getitem__
    pcs_txt_path = f"{PC_PATH}/{self.pcs_txt_path_list[index]}.txt"
IndexError: list index out of range

[2023-01-10 16:33:20,811][src.utils.utils][INFO] - Closing loggers...
[2023-01-10 16:36:53,106][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-10 16:36:53,112][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-10 16:36:53,112][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-10 16:36:53,182][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-10 16:36:53,760][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2023-01-10 16:37:01,149][__main__][INFO] - Instantiating callbacks...
[2023-01-10 16:37:01,151][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-10 16:37:01,156][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-10 16:37:01,157][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-10 16:37:01,158][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-10 16:37:01,159][__main__][INFO] - Instantiating loggers...
[2023-01-10 16:37:01,159][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-10 16:37:01,160][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-10 16:37:01,715][__main__][INFO] - Starting training!
[2023-01-10 16:37:01,722][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-10 16:37:01,820][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 72, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1107, in _run
    self._call_setup_hook()  # allow user to setup lightning_module in accelerator environment
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1449, in _call_setup_hook
    self._call_lightning_datamodule_hook("setup", stage=fn)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1571, in _call_lightning_datamodule_hook
    return fn(*args, **kwargs)
  File "/home/fubao/dev/my-ndc/src/datamodules/undc_pc_datamodule2.py", line 48, in setup
    self.data_train = ABC_pc_hdf5(
  File "/home/fubao/dev/my-ndc/src/datamodules/components/pc_dataset3.py", line 92, in __init__
    temp_pcs_paths.append(self.pcs_txt_path_list[index])
IndexError: list index out of range
[2023-01-10 16:37:01,824][src.utils.utils][INFO] - Closing loggers...
[2023-01-10 16:40:17,606][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-10 16:40:17,613][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-10 16:40:17,613][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-10 16:40:17,674][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-10 16:40:18,293][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2023-01-10 16:40:25,432][__main__][INFO] - Instantiating callbacks...
[2023-01-10 16:40:25,434][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-10 16:40:25,441][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-10 16:40:25,443][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-10 16:40:25,443][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-10 16:40:25,444][__main__][INFO] - Instantiating loggers...
[2023-01-10 16:40:25,445][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-10 16:40:25,445][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-10 16:40:25,916][__main__][INFO] - Starting training!
[2023-01-10 16:40:25,922][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-10 16:40:26,012][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 1806 had been created.
[2023-01-10 16:40:26,013][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-10 16:40:26,073][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-10 16:40:26,073][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-10 16:40:26,128][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-10 16:45:58,164][__main__][INFO] - Starting testing!
[2023-01-10 16:46:02,214][__main__][INFO] - Best ckpt path: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-10_16-40-17/checkpoints/epoch_000.ckpt
[2023-01-10 16:46:02,225][src.utils.utils][INFO] - Closing loggers...
[2023-01-10 16:46:02,228][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-10_16-40-17
[2023-01-10 16:46:02,229][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-01-10 16:47:03,237][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-10 16:47:03,244][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-10 16:47:03,244][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-10 16:47:03,325][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-10 16:47:04,050][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2023-01-10 16:47:11,058][__main__][INFO] - Instantiating callbacks...
[2023-01-10 16:47:11,060][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-10 16:47:11,068][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-10 16:47:11,069][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-10 16:47:11,070][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-10 16:47:11,071][__main__][INFO] - Instantiating loggers...
[2023-01-10 16:47:11,071][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-10 16:47:11,071][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-10 16:47:11,473][__main__][INFO] - Starting training!
[2023-01-10 16:47:11,479][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-10 16:47:11,570][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 1806 had been created.
[2023-01-10 16:47:11,570][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-10 16:47:11,629][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-10 16:47:11,629][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-10 16:47:11,683][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-10 16:47:15,007][__main__][INFO] - Starting testing!
[2023-01-10 16:47:15,008][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-01-10 16:47:18,355][__main__][INFO] - Best ckpt path: None
[2023-01-10 16:47:18,361][src.utils.utils][INFO] - Closing loggers...
[2023-01-10 16:47:18,363][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-10_16-47-03
[2023-01-10 16:47:18,363][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-01-10 16:48:01,827][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-10 16:48:01,833][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-10 16:48:01,834][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-10 16:48:01,897][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-10 16:48:02,484][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2023-01-10 16:48:10,023][__main__][INFO] - Instantiating callbacks...
[2023-01-10 16:48:10,025][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-10 16:48:10,031][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-10 16:48:10,033][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-10 16:48:10,034][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-10 16:48:10,034][__main__][INFO] - Instantiating loggers...
[2023-01-10 16:48:10,035][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-10 16:48:10,035][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-10 16:48:10,457][__main__][INFO] - Starting training!
[2023-01-10 16:48:10,462][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-10 16:48:10,543][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 1806 had been created.
[2023-01-10 16:48:10,543][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-10 16:48:10,612][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-10 16:48:10,612][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-10 16:48:10,667][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-10 16:48:14,984][__main__][INFO] - Starting testing!
[2023-01-10 16:48:14,985][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-01-10 16:48:17,275][__main__][INFO] - Best ckpt path: None
[2023-01-10 16:48:17,284][src.utils.utils][INFO] - Closing loggers...
[2023-01-10 16:48:17,287][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-10_16-48-01
[2023-01-10 16:48:17,288][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-01-10 16:59:09,020][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-10 16:59:09,027][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-10 16:59:09,028][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-10 16:59:09,092][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-10 16:59:09,691][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2023-01-10 16:59:17,077][__main__][INFO] - Instantiating callbacks...
[2023-01-10 16:59:17,079][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-10 16:59:17,084][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-10 16:59:17,086][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-10 16:59:17,086][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-10 16:59:17,087][__main__][INFO] - Instantiating loggers...
[2023-01-10 16:59:17,088][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-10 16:59:17,088][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-10 16:59:17,500][__main__][INFO] - Starting training!
[2023-01-10 16:59:17,506][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-10 16:59:17,588][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 1806 had been created.
[2023-01-10 16:59:17,589][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-10 16:59:17,647][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-10 16:59:17,647][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-10 16:59:17,703][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-10 16:59:20,047][__main__][INFO] - Starting testing!
[2023-01-10 16:59:20,048][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-01-10 16:59:21,130][__main__][INFO] - Best ckpt path: None
[2023-01-10 16:59:21,134][src.utils.utils][INFO] - Closing loggers...
[2023-01-10 16:59:21,136][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-10_16-59-08
[2023-01-10 16:59:21,137][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-01-10 17:26:56,911][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-10 17:26:56,918][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-10 17:26:56,919][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-10 17:26:56,986][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-10 17:26:57,662][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2023-01-10 17:27:05,211][__main__][INFO] - Instantiating callbacks...
[2023-01-10 17:27:05,212][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-10 17:27:05,218][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-10 17:27:05,220][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-10 17:27:05,221][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-10 17:27:05,222][__main__][INFO] - Instantiating loggers...
[2023-01-10 17:27:05,222][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-10 17:27:05,222][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-10 17:27:05,579][__main__][INFO] - Starting training!
[2023-01-10 17:27:05,583][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-10 17:27:05,591][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 3294 had been created.
[2023-01-10 17:27:05,591][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-10 17:27:05,597][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 412 had been created.
[2023-01-10 17:27:05,597][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-10 17:27:05,603][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 412 had been created.
[2023-01-10 17:27:10,900][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1163, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/queue.py", line 178, in get
    raise Empty
_queue.Empty

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 72, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_train
    self._run_sanity_check()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1345, in _run_sanity_check
    val_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 155, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 127, in advance
    batch = next(data_fetcher)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 185, in __next__
    return self.fetching_function()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 264, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 278, in _fetch_next_batch
    batch = next(iterator)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 681, in __next__
    data = self._next_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1359, in _next_data
    idx, data = self._get_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1315, in _get_data
    success, data = self._try_get_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1176, in _try_get_data
    raise RuntimeError('DataLoader worker (pid(s) {}) exited unexpectedly'.format(pids_str)) from e
RuntimeError: DataLoader worker (pid(s) 15861) exited unexpectedly
[2023-01-10 17:27:10,905][src.utils.utils][INFO] - Closing loggers...
[2023-01-10 17:30:02,611][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-10 17:30:02,618][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-10 17:30:02,618][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-10 17:30:02,686][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-10 17:30:03,291][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2023-01-10 17:30:10,112][__main__][INFO] - Instantiating callbacks...
[2023-01-10 17:30:10,114][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-10 17:30:10,119][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-10 17:30:10,121][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-10 17:30:10,122][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-10 17:30:10,123][__main__][INFO] - Instantiating loggers...
[2023-01-10 17:30:10,123][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-10 17:30:10,123][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-10 17:30:10,478][__main__][INFO] - Starting training!
[2023-01-10 17:30:10,482][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-10 17:30:10,493][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 3294 had been created.
[2023-01-10 17:30:10,493][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-10 17:30:10,502][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 412 had been created.
[2023-01-10 17:30:10,502][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-10 17:30:10,512][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 412 had been created.
[2023-01-10 17:30:15,798][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1163, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/queue.py", line 178, in get
    raise Empty
_queue.Empty

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 72, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_train
    self._run_sanity_check()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1345, in _run_sanity_check
    val_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 155, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 127, in advance
    batch = next(data_fetcher)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 185, in __next__
    return self.fetching_function()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 264, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 278, in _fetch_next_batch
    batch = next(iterator)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 681, in __next__
    data = self._next_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1359, in _next_data
    idx, data = self._get_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1315, in _get_data
    success, data = self._try_get_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1176, in _try_get_data
    raise RuntimeError('DataLoader worker (pid(s) {}) exited unexpectedly'.format(pids_str)) from e
RuntimeError: DataLoader worker (pid(s) 18102) exited unexpectedly
[2023-01-10 17:30:15,805][src.utils.utils][INFO] - Closing loggers...
[2023-01-10 17:53:20,588][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-10 17:53:20,595][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-10 17:53:20,595][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-10 17:53:20,655][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-10 17:53:21,327][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2023-01-10 17:53:29,187][__main__][INFO] - Instantiating callbacks...
[2023-01-10 17:53:29,189][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-10 17:53:29,194][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-10 17:53:29,196][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-10 17:53:29,197][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-10 17:53:29,197][__main__][INFO] - Instantiating loggers...
[2023-01-10 17:53:29,198][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-10 17:53:29,198][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-10 17:53:29,600][__main__][INFO] - Starting training!
[2023-01-10 17:53:29,605][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-10 17:53:29,618][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 3294 had been created.
[2023-01-10 17:53:29,619][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-10 17:53:29,629][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 412 had been created.
[2023-01-10 17:53:29,629][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-10 17:53:29,638][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 412 had been created.
[2023-01-10 17:53:35,015][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1163, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/queue.py", line 178, in get
    raise Empty
_queue.Empty

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 72, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_train
    self._run_sanity_check()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1345, in _run_sanity_check
    val_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 155, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 127, in advance
    batch = next(data_fetcher)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 185, in __next__
    return self.fetching_function()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 264, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 278, in _fetch_next_batch
    batch = next(iterator)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 681, in __next__
    data = self._next_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1359, in _next_data
    idx, data = self._get_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1315, in _get_data
    success, data = self._try_get_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1176, in _try_get_data
    raise RuntimeError('DataLoader worker (pid(s) {}) exited unexpectedly'.format(pids_str)) from e
RuntimeError: DataLoader worker (pid(s) 39591) exited unexpectedly
[2023-01-10 17:53:35,022][src.utils.utils][INFO] - Closing loggers...
[2023-01-10 17:53:59,638][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-10 17:53:59,645][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-10 17:53:59,645][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-10 17:53:59,726][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-10 17:54:00,361][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2023-01-10 17:54:07,849][__main__][INFO] - Instantiating callbacks...
[2023-01-10 17:54:07,850][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-10 17:54:07,856][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-10 17:54:07,857][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-10 17:54:07,858][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-10 17:54:07,859][__main__][INFO] - Instantiating loggers...
[2023-01-10 17:54:07,859][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-10 17:54:07,859][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-10 17:54:08,255][__main__][INFO] - Starting training!
[2023-01-10 17:54:08,261][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-10 17:54:08,339][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 1806 had been created.
[2023-01-10 17:54:08,340][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-10 17:54:08,396][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-10 17:54:08,396][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-10 17:54:08,452][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-10 17:54:40,004][__main__][INFO] - Starting testing!
[2023-01-10 17:54:40,006][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-01-10 17:54:40,993][__main__][INFO] - Best ckpt path: None
[2023-01-10 17:54:40,999][src.utils.utils][INFO] - Closing loggers...
[2023-01-10 17:54:41,001][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-10_17-53-59
[2023-01-10 17:54:41,001][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-01-10 17:56:15,631][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-10 17:56:15,638][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-10 17:56:15,638][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-10 17:56:15,701][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-10 17:56:16,307][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2023-01-10 17:56:23,911][__main__][INFO] - Instantiating callbacks...
[2023-01-10 17:56:23,912][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-10 17:56:23,918][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-10 17:56:23,920][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-10 17:56:23,921][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-10 17:56:23,921][__main__][INFO] - Instantiating loggers...
[2023-01-10 17:56:23,922][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-10 17:56:23,922][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-10 17:56:24,349][__main__][INFO] - Starting training!
[2023-01-10 17:56:24,355][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-10 17:56:24,424][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 1806 had been created.
[2023-01-10 17:56:24,424][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-10 17:56:24,472][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-10 17:56:24,472][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-10 17:56:24,519][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-10 17:56:29,040][__main__][INFO] - Starting testing!
[2023-01-10 17:56:29,041][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-01-10 17:56:30,692][__main__][INFO] - Best ckpt path: None
[2023-01-10 17:56:30,699][src.utils.utils][INFO] - Closing loggers...
[2023-01-10 17:56:30,702][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-10_17-56-15
[2023-01-10 17:56:30,706][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-01-10 18:04:09,795][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-10 18:04:09,806][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-10 18:04:09,807][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-10 18:04:09,910][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-10 18:04:10,530][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2023-01-10 18:04:17,957][__main__][INFO] - Instantiating callbacks...
[2023-01-10 18:04:17,958][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-10 18:04:17,964][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-10 18:04:17,965][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-10 18:04:17,966][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-10 18:04:17,967][__main__][INFO] - Instantiating loggers...
[2023-01-10 18:04:17,967][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-10 18:04:17,968][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-10 18:04:18,406][__main__][INFO] - Starting training!
[2023-01-10 18:04:18,411][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-10 18:04:18,493][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 1806 had been created.
[2023-01-10 18:04:18,493][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-10 18:04:18,551][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-10 18:04:18,551][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-10 18:04:18,606][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-10 18:04:27,449][__main__][INFO] - Starting testing!
[2023-01-10 18:04:27,450][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-01-10 18:04:30,481][__main__][INFO] - Best ckpt path: None
[2023-01-10 18:04:30,486][src.utils.utils][INFO] - Closing loggers...
[2023-01-10 18:04:30,488][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-10_18-04-09
[2023-01-10 18:04:30,489][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-01-10 18:18:08,145][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-10 18:18:08,151][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-10 18:18:08,152][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-10 18:18:08,212][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-10 18:18:08,815][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2023-01-10 18:18:16,391][__main__][INFO] - Instantiating callbacks...
[2023-01-10 18:18:16,392][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-10 18:18:16,398][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-10 18:18:16,400][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-10 18:18:16,401][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-10 18:18:16,402][__main__][INFO] - Instantiating loggers...
[2023-01-10 18:18:16,402][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-10 18:18:16,403][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-10 18:18:16,845][__main__][INFO] - Starting training!
[2023-01-10 18:18:16,851][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-10 18:18:16,938][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 1806 had been created.
[2023-01-10 18:18:16,938][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-10 18:18:16,997][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-10 18:18:16,997][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-10 18:18:17,052][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-10 18:18:27,080][__main__][INFO] - Starting testing!
[2023-01-10 18:18:27,081][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-01-10 18:18:28,550][__main__][INFO] - Best ckpt path: None
[2023-01-10 18:18:28,557][src.utils.utils][INFO] - Closing loggers...
[2023-01-10 18:18:28,559][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-10_18-18-08
[2023-01-10 18:18:28,560][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-01-10 23:31:11,706][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-10 23:31:11,714][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-10 23:31:11,715][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-10 23:31:11,789][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-10 23:31:11,792][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/utils.py", line 639, in _locate
    obj = getattr(obj, part)
AttributeError: module 'src.datamodules' has no attribute 'undc_pc_datamodule2'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/utils.py", line 645, in _locate
    obj = import_module(mod)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1014, in _gcd_import
  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 975, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 671, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/home/fubao/dev/my-ndc/src/datamodules/undc_pc_datamodule2.py", line 8, in <module>
    from src.datamodules.components.pc_dataset3 import ABC_pc_hdf5
  File "/home/fubao/dev/my-ndc/src/datamodules/components/pc_dataset3.py", line 119
    print(f"{OBJ_PATH}/{self.hdf
                               ^
SyntaxError: EOL while scanning string literal

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/utils.py", line 653, in _locate
    raise ImportError(
ImportError: Error loading 'src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule':
SyntaxError('EOL while scanning string literal', ('/home/fubao/dev/my-ndc/src/datamodules/components/pc_dataset3.py', 119, 37, '        print(f"{OBJ_PATH}/{self.hdf\n'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 43, in train
    datamodule: LightningDataModule = hydra.utils.instantiate(cfg.datamodule)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 325, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule', see chained exception above.
full_key: datamodule
[2023-01-10 23:31:11,795][src.utils.utils][INFO] - Closing loggers...
[2023-01-10 23:33:09,492][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-10 23:33:09,500][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-10 23:33:09,500][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-10 23:33:09,574][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-10 23:33:10,439][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2023-01-10 23:33:17,940][__main__][INFO] - Instantiating callbacks...
[2023-01-10 23:33:17,941][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-10 23:33:17,947][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-10 23:33:17,948][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-10 23:33:17,949][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-10 23:33:17,950][__main__][INFO] - Instantiating loggers...
[2023-01-10 23:33:17,950][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-10 23:33:17,951][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-10 23:33:18,277][__main__][INFO] - Starting training!
[2023-01-10 23:33:18,281][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-10 23:33:18,343][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 1806 had been created.
[2023-01-10 23:33:18,343][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-10 23:33:18,396][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-10 23:33:18,396][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-10 23:33:18,449][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-10 23:33:27,298][__main__][INFO] - Starting testing!
[2023-01-10 23:33:27,299][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-01-10 23:33:30,336][__main__][INFO] - Best ckpt path: None
[2023-01-10 23:33:30,343][src.utils.utils][INFO] - Closing loggers...
[2023-01-10 23:33:30,346][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-10_23-33-09
[2023-01-10 23:33:30,347][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-01-10 23:44:25,165][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-10 23:44:25,173][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-10 23:44:25,173][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-10 23:44:25,245][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-10 23:44:25,851][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2023-01-10 23:44:25,902][__main__][INFO] - Instantiating callbacks...
[2023-01-10 23:44:25,902][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-10 23:44:25,906][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-10 23:44:25,908][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-10 23:44:25,908][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-10 23:44:25,909][__main__][INFO] - Instantiating loggers...
[2023-01-10 23:44:25,909][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-10 23:44:25,910][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-10 23:45:05,238][__main__][INFO] - Starting training!
[2023-01-10 23:45:10,632][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-10 23:45:10,706][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 1806 had been created.
[2023-01-10 23:45:10,707][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-10 23:45:10,773][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-10 23:45:10,773][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-10 23:45:10,835][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-10 23:48:57,391][__main__][INFO] - Starting testing!
[2023-01-10 23:48:59,966][__main__][INFO] - Best ckpt path: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-10_23-44-25/checkpoints/epoch_000.ckpt
[2023-01-10 23:48:59,973][src.utils.utils][INFO] - Closing loggers...
[2023-01-10 23:48:59,976][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-10_23-44-25
[2023-01-10 23:48:59,977][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-01-10 23:49:57,858][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-10 23:49:57,866][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-10 23:49:57,867][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-10 23:49:57,946][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-10 23:49:58,624][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2023-01-10 23:49:58,684][__main__][INFO] - Instantiating callbacks...
[2023-01-10 23:49:58,684][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-10 23:49:58,689][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-10 23:49:58,691][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-10 23:49:58,692][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-10 23:49:58,692][__main__][INFO] - Instantiating loggers...
[2023-01-10 23:49:58,693][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-10 23:49:58,693][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-10 23:50:38,083][__main__][INFO] - Starting training!
[2023-01-10 23:50:43,433][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-10 23:50:43,521][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 1806 had been created.
[2023-01-10 23:50:43,521][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-10 23:50:43,600][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-10 23:50:43,600][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-10 23:50:43,666][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-10 23:50:48,829][__main__][INFO] - Starting testing!
[2023-01-10 23:50:48,830][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-01-10 23:50:50,555][__main__][INFO] - Best ckpt path: None
[2023-01-10 23:50:50,563][src.utils.utils][INFO] - Closing loggers...
[2023-01-10 23:50:50,566][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-10_23-49-57
[2023-01-10 23:50:50,567][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-01-10 23:51:14,112][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-10 23:51:14,120][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-10 23:51:14,120][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-10 23:51:14,191][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-10 23:51:14,857][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2023-01-10 23:51:14,909][__main__][INFO] - Instantiating callbacks...
[2023-01-10 23:51:14,909][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-10 23:51:14,913][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-10 23:51:14,915][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-10 23:51:14,916][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-10 23:51:14,916][__main__][INFO] - Instantiating loggers...
[2023-01-10 23:51:14,917][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-10 23:51:14,917][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-10 23:51:53,986][__main__][INFO] - Starting training!
[2023-01-10 23:51:59,335][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-10 23:51:59,399][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 1806 had been created.
[2023-01-10 23:51:59,399][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-10 23:51:59,454][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-10 23:51:59,454][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-10 23:51:59,508][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-10 23:52:03,356][__main__][INFO] - Starting testing!
[2023-01-10 23:52:03,357][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-01-10 23:52:05,094][__main__][INFO] - Best ckpt path: None
[2023-01-10 23:52:05,100][src.utils.utils][INFO] - Closing loggers...
[2023-01-10 23:52:05,102][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-10_23-51-13
[2023-01-10 23:52:05,103][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-01-11 19:54:38,753][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-11 19:54:38,760][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-11 19:54:38,760][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-11 19:54:38,820][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-11 19:54:39,426][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2023-01-11 19:54:39,474][__main__][INFO] - Instantiating callbacks...
[2023-01-11 19:54:39,475][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-11 19:54:39,479][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-11 19:54:39,480][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-11 19:54:39,481][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-11 19:54:39,482][__main__][INFO] - Instantiating loggers...
[2023-01-11 19:54:39,482][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-11 19:54:39,482][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-11 19:55:23,417][__main__][INFO] - Starting training!
[2023-01-11 19:55:29,587][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-11 19:55:29,662][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 1806 had been created.
[2023-01-11 19:55:29,662][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-11 19:55:29,720][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-11 19:55:29,720][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-11 19:55:29,777][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-11 20:36:23,277][__main__][INFO] - Starting testing!
[2023-01-11 20:36:24,316][__main__][INFO] - Best ckpt path: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-11_19-54-38/checkpoints/epoch_000.ckpt
[2023-01-11 20:36:24,322][src.utils.utils][INFO] - Closing loggers...
[2023-01-11 20:36:24,325][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-11_19-54-38
[2023-01-11 20:36:24,325][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-01-11 21:22:09,146][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-11 21:22:09,154][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-11 21:22:09,154][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-11 21:22:09,243][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-11 21:22:09,896][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2023-01-11 21:22:09,950][__main__][INFO] - Instantiating callbacks...
[2023-01-11 21:22:09,951][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-11 21:22:09,954][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-11 21:22:09,956][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-11 21:22:09,957][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-11 21:22:09,957][__main__][INFO] - Instantiating loggers...
[2023-01-11 21:22:09,958][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-11 21:22:09,958][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-11 21:22:51,150][__main__][INFO] - Starting training!
[2023-01-11 21:22:56,965][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-11 21:22:57,052][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 1806 had been created.
[2023-01-11 21:22:57,052][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-11 21:22:57,129][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-11 21:22:57,129][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-11 21:22:57,203][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-11 21:23:00,100][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 72, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_train
    self._run_sanity_check()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1345, in _run_sanity_check
    val_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 155, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 143, in advance
    output = self._evaluation_step(**kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 240, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1706, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 370, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/home/fubao/dev/my-ndc/src/models/undc_module.py", line 137, in validation_step
    bool_loss, bool_acc, pred_bool, float_loss, pred_float = self.step(batch,val=True)
  File "/home/fubao/dev/my-ndc/src/models/undc_module.py", line 77, in step
    pc_KNN_idx_,pc_KNN_xyz_, voxel_xyz_int_,voxel_KNN_idx_,voxel_KNN_xyz_, \
ValueError: too many values to unpack (expected 8)
[2023-01-11 21:23:00,109][src.utils.utils][INFO] - Closing loggers...
[2023-01-11 21:23:54,026][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-11 21:23:54,034][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-11 21:23:54,035][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-11 21:23:54,103][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-11 21:23:54,701][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2023-01-11 21:23:54,755][__main__][INFO] - Instantiating callbacks...
[2023-01-11 21:23:54,756][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-11 21:23:54,762][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-11 21:23:54,765][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-11 21:23:54,766][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-11 21:23:54,767][__main__][INFO] - Instantiating loggers...
[2023-01-11 21:23:54,767][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-11 21:23:54,767][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-11 21:24:35,777][__main__][INFO] - Starting training!
[2023-01-11 21:24:41,358][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-11 21:24:41,429][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 1806 had been created.
[2023-01-11 21:24:41,429][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-11 21:24:41,494][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-11 21:24:41,494][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-11 21:24:41,553][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-11 21:24:45,394][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 72, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_train
    self._run_sanity_check()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1345, in _run_sanity_check
    val_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 155, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 143, in advance
    output = self._evaluation_step(**kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 240, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1706, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 370, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/home/fubao/dev/my-ndc/src/models/undc_module2.py", line 152, in validation_step
    self.gen_obj(pred_bool, pred_float, batch)
  File "/home/fubao/dev/my-ndc/src/models/undc_module2.py", line 246, in gen_obj
    name_info_list = name_info_list[0].cpu()
AttributeError: 'str' object has no attribute 'cpu'
[2023-01-11 21:24:45,402][src.utils.utils][INFO] - Closing loggers...
[2023-01-11 21:25:11,356][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-11 21:25:11,363][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-11 21:25:11,364][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-11 21:25:11,435][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-11 21:25:12,052][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2023-01-11 21:25:12,106][__main__][INFO] - Instantiating callbacks...
[2023-01-11 21:25:12,107][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-11 21:25:12,110][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-11 21:25:12,112][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-11 21:25:12,113][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-11 21:25:12,113][__main__][INFO] - Instantiating loggers...
[2023-01-11 21:25:12,114][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-11 21:25:12,114][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-11 21:25:53,153][__main__][INFO] - Starting training!
[2023-01-11 21:25:58,930][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-11 21:25:59,001][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 1806 had been created.
[2023-01-11 21:25:59,002][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-11 21:25:59,058][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-11 21:25:59,058][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-11 21:25:59,115][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-11 21:26:03,057][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 72, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_train
    self._run_sanity_check()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1345, in _run_sanity_check
    val_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 155, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 143, in advance
    output = self._evaluation_step(**kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 240, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1706, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 370, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/home/fubao/dev/my-ndc/src/models/undc_module2.py", line 152, in validation_step
    self.gen_obj(pred_bool, pred_float, batch)
  File "/home/fubao/dev/my-ndc/src/models/undc_module2.py", line 253, in gen_obj
    self.generate_obj_test(voxel_xyz_int,gt_output_bool,gt_output_float, "gt")
TypeError: generate_obj_test() missing 2 required positional arguments: 'cate' and 'shape_id'
[2023-01-11 21:26:03,066][src.utils.utils][INFO] - Closing loggers...
[2023-01-11 21:26:25,522][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-11 21:26:25,530][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-11 21:26:25,530][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-11 21:26:25,601][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-11 21:26:26,152][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2023-01-11 21:26:26,206][__main__][INFO] - Instantiating callbacks...
[2023-01-11 21:26:26,207][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-11 21:26:26,211][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-11 21:26:26,212][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-11 21:26:26,213][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-11 21:26:26,214][__main__][INFO] - Instantiating loggers...
[2023-01-11 21:26:26,214][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-11 21:26:26,215][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-11 21:27:07,417][__main__][INFO] - Starting training!
[2023-01-11 21:27:13,054][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-11 21:27:13,114][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 1806 had been created.
[2023-01-11 21:27:13,115][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-11 21:27:13,166][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-11 21:27:13,167][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-11 21:27:13,219][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-11 21:27:19,358][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 72, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_train
    self._run_sanity_check()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1345, in _run_sanity_check
    val_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 155, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 143, in advance
    output = self._evaluation_step(**kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 240, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1706, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 370, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/home/fubao/dev/my-ndc/src/models/undc_module2.py", line 152, in validation_step
    self.gen_obj(pred_bool, pred_float, batch)
  File "/home/fubao/dev/my-ndc/src/models/undc_module2.py", line 253, in gen_obj
    self.generate_obj_test(voxel_xyz_int,gt_output_bool,gt_output_float, "gt",cate,shape_id)
  File "/home/fubao/dev/my-ndc/src/models/undc_module2.py", line 234, in generate_obj_test
    if not os.path.exists(f"{self.hparams.out_dir}/objs/{cate}/{shape_id}_{self.obj_id}"):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1207, in __getattr__
    raise AttributeError("'{}' object has no attribute '{}'".format(
AttributeError: 'UNDCLitModule' object has no attribute 'obj_id'
[2023-01-11 21:27:19,363][src.utils.utils][INFO] - Closing loggers...
[2023-01-11 21:28:30,946][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-11 21:28:30,954][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-11 21:28:30,954][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-11 21:28:31,029][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-11 21:28:31,633][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2023-01-11 21:28:31,687][__main__][INFO] - Instantiating callbacks...
[2023-01-11 21:28:31,688][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-11 21:28:31,692][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-11 21:28:31,694][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-11 21:28:31,695][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-11 21:28:31,695][__main__][INFO] - Instantiating loggers...
[2023-01-11 21:28:31,696][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-11 21:28:31,696][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-11 21:29:12,781][__main__][INFO] - Starting training!
[2023-01-11 21:29:18,515][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-11 21:29:18,572][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 1806 had been created.
[2023-01-11 21:29:18,573][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-11 21:29:18,621][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-11 21:29:18,621][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-11 21:29:18,671][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-11 21:29:26,773][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 72, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_train
    self._run_sanity_check()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1345, in _run_sanity_check
    val_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 155, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 143, in advance
    output = self._evaluation_step(**kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 240, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1706, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 370, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/home/fubao/dev/my-ndc/src/models/undc_module2.py", line 152, in validation_step
    self.gen_obj(pred_bool, pred_float, batch)
  File "/home/fubao/dev/my-ndc/src/models/undc_module2.py", line 259, in gen_obj
    self.save_pcs(pcs,cate,shape_id)
  File "/home/fubao/dev/my-ndc/src/models/undc_module2.py", line 204, in save_pcs
    save_path = f"{self.hparams.out_dir}/objs/{cate}/{shape_id}_{self.obj_id}/pcs.txt"
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1207, in __getattr__
    raise AttributeError("'{}' object has no attribute '{}'".format(
AttributeError: 'UNDCLitModule' object has no attribute 'obj_id'
[2023-01-11 21:29:26,779][src.utils.utils][INFO] - Closing loggers...
[2023-01-11 21:29:51,976][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-11 21:29:51,983][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-11 21:29:51,984][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-11 21:29:52,065][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-11 21:29:52,684][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2023-01-11 21:29:52,738][__main__][INFO] - Instantiating callbacks...
[2023-01-11 21:29:52,738][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-11 21:29:52,742][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-11 21:29:52,744][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-11 21:29:52,744][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-11 21:29:52,745][__main__][INFO] - Instantiating loggers...
[2023-01-11 21:29:52,745][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-11 21:29:52,745][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-11 21:30:33,963][__main__][INFO] - Starting training!
[2023-01-11 21:30:39,646][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-11 21:30:39,732][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 1806 had been created.
[2023-01-11 21:30:39,732][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-11 21:30:39,810][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-11 21:30:39,810][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-11 21:30:39,886][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-11 22:15:01,154][__main__][INFO] - Starting testing!
[2023-01-11 22:15:03,904][__main__][INFO] - Best ckpt path: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-11_21-29-51/checkpoints/epoch_000.ckpt
[2023-01-11 22:15:03,909][src.utils.utils][INFO] - Closing loggers...
[2023-01-11 22:15:03,911][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-11_21-29-51
[2023-01-11 22:15:03,912][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-01-12 11:53:07,708][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-12 11:53:07,714][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-12 11:53:07,715][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-12 11:53:07,778][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-12 11:53:08,361][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2023-01-12 11:53:08,418][__main__][INFO] - Instantiating callbacks...
[2023-01-12 11:53:08,418][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-12 11:53:08,422][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-12 11:53:08,424][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-12 11:53:08,425][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-12 11:53:08,426][__main__][INFO] - Instantiating loggers...
[2023-01-12 11:53:08,426][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-12 11:53:08,426][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-12 11:53:49,623][__main__][INFO] - Starting training!
[2023-01-12 11:53:55,210][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-12 11:53:55,222][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 3294 had been created.
[2023-01-12 11:53:55,222][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-12 11:53:55,230][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 412 had been created.
[2023-01-12 11:53:55,230][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-12 11:53:55,238][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 412 had been created.
[2023-01-12 11:57:30,069][__main__][INFO] - Starting testing!
[2023-01-12 11:57:30,071][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-01-12 11:57:30,555][__main__][INFO] - Best ckpt path: None
[2023-01-12 11:57:30,562][src.utils.utils][INFO] - Closing loggers...
[2023-01-12 11:57:30,564][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-12_11-53-07
[2023-01-12 11:57:30,565][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-01-12 11:58:53,523][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-12 11:58:53,531][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-12 11:58:53,532][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-12 11:58:53,601][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-12 11:58:54,167][__main__][INFO] - Instantiating model <src.models.undc_module.UNDCLitModule>
[2023-01-12 11:58:54,226][__main__][INFO] - Instantiating callbacks...
[2023-01-12 11:58:54,227][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-12 11:58:54,231][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-12 11:58:54,233][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-12 11:58:54,234][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-12 11:58:54,235][__main__][INFO] - Instantiating loggers...
[2023-01-12 11:58:54,235][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-12 11:58:54,235][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-12 11:59:34,037][__main__][INFO] - Starting training!
[2023-01-12 11:59:39,499][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-12 11:59:39,580][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 1806 had been created.
[2023-01-12 11:59:39,581][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-12 11:59:39,651][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-12 11:59:39,651][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-12 11:59:39,708][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-12 11:59:43,321][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 72, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_train
    self._run_sanity_check()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1345, in _run_sanity_check
    val_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 155, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 143, in advance
    output = self._evaluation_step(**kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 240, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1706, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 370, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/home/fubao/dev/my-ndc/src/models/undc_module.py", line 137, in validation_step
    bool_loss, bool_acc, pred_bool, float_loss, pred_float = self.step(batch,val=True)
  File "/home/fubao/dev/my-ndc/src/models/undc_module.py", line 77, in step
    pc_KNN_idx_,pc_KNN_xyz_, voxel_xyz_int_,voxel_KNN_idx_,voxel_KNN_xyz_, \
ValueError: too many values to unpack (expected 8)
[2023-01-12 11:59:43,330][src.utils.utils][INFO] - Closing loggers...
[2023-01-12 12:00:41,980][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-12 12:00:41,986][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-12 12:00:41,987][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-12 12:00:42,048][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-12 12:00:42,688][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2023-01-12 12:00:42,748][__main__][INFO] - Instantiating callbacks...
[2023-01-12 12:00:42,748][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-12 12:00:42,752][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-12 12:00:42,754][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-12 12:00:42,755][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-12 12:00:42,755][__main__][INFO] - Instantiating loggers...
[2023-01-12 12:00:42,756][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-12 12:00:42,756][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-12 12:01:22,361][__main__][INFO] - Starting training!
[2023-01-12 12:01:27,846][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-12 12:01:27,910][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 1806 had been created.
[2023-01-12 12:01:27,910][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-12 12:01:27,965][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-12 12:01:27,966][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-12 12:01:28,020][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-12 12:01:33,592][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 72, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_train
    self._run_sanity_check()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1345, in _run_sanity_check
    val_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 155, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 143, in advance
    output = self._evaluation_step(**kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 240, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1706, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 370, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/home/fubao/dev/my-ndc/src/models/undc_module2.py", line 137, in validation_step
    bool_loss, bool_acc, pred_bool, float_loss, pred_float = self.step(batch,val=True)
  File "/home/fubao/dev/my-ndc/src/models/undc_module2.py", line 110, in step
    bool_loss = self.criterion_bool(pred_output_bool, gt_output_bool)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/modules/loss.py", line 613, in forward
    return F.binary_cross_entropy(input, target, weight=self.weight, reduction=self.reduction)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/nn/functional.py", line 3074, in binary_cross_entropy
    raise ValueError(
ValueError: Using a target size (torch.Size([65, 65, 65, 3])) that is different to the input size (torch.Size([31858, 3])) is deprecated. Please ensure they have the same size.
[2023-01-12 12:01:33,601][src.utils.utils][INFO] - Closing loggers...
[2023-01-12 12:03:28,110][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-12 12:03:28,117][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-12 12:03:28,118][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-12 12:03:28,184][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-12 12:03:28,793][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2023-01-12 12:03:28,850][__main__][INFO] - Instantiating callbacks...
[2023-01-12 12:03:28,850][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-12 12:03:28,854][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-12 12:03:28,855][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-12 12:03:28,856][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-12 12:03:28,857][__main__][INFO] - Instantiating loggers...
[2023-01-12 12:03:28,857][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-12 12:03:28,858][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-12 12:04:09,349][__main__][INFO] - Starting training!
[2023-01-12 12:04:14,987][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-12 12:04:15,088][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 1806 had been created.
[2023-01-12 12:04:15,088][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-12 12:04:15,160][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-12 12:04:15,160][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-12 12:04:15,218][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-12 12:05:31,524][__main__][INFO] - Starting testing!
[2023-01-12 12:05:31,527][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-01-12 12:05:35,930][__main__][INFO] - Best ckpt path: None
[2023-01-12 12:05:35,940][src.utils.utils][INFO] - Closing loggers...
[2023-01-12 12:05:35,943][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-12_12-03-28
[2023-01-12 12:05:35,944][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-01-12 12:06:22,976][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-12 12:06:23,009][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-12 12:06:23,010][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-12 12:06:23,321][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-12 12:06:24,531][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2023-01-12 12:06:24,644][__main__][INFO] - Instantiating callbacks...
[2023-01-12 12:06:24,646][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-12 12:06:24,670][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-12 12:06:24,679][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-12 12:06:24,682][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-12 12:06:24,685][__main__][INFO] - Instantiating loggers...
[2023-01-12 12:06:24,686][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-12 12:06:24,687][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-12 12:06:50,255][__main__][INFO] - Starting training!
[2023-01-12 12:06:50,268][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-12 12:06:50,377][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 1806 had been created.
[2023-01-12 12:06:50,378][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-12 12:06:50,486][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-12 12:06:50,486][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-12 12:06:50,571][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-12 12:07:35,572][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-12 12:07:35,607][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-12 12:07:35,608][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-12 12:07:35,996][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-12 12:07:37,241][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2023-01-12 12:07:37,346][__main__][INFO] - Instantiating callbacks...
[2023-01-12 12:07:37,347][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-12 12:07:37,363][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-12 12:07:37,369][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-12 12:07:37,372][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-12 12:07:37,374][__main__][INFO] - Instantiating loggers...
[2023-01-12 12:07:37,375][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-12 12:07:37,375][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-12 12:08:03,432][__main__][INFO] - Starting training!
[2023-01-12 12:08:03,444][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-12 12:08:03,560][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 1806 had been created.
[2023-01-12 12:08:03,561][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-12 12:08:03,659][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-12 12:08:03,659][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-12 12:08:03,736][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-12 12:22:39,358][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-12 12:22:39,364][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-12 12:22:39,365][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-12 12:22:39,430][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-12 12:22:40,072][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2023-01-12 12:22:40,129][__main__][INFO] - Instantiating callbacks...
[2023-01-12 12:22:40,130][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-12 12:22:40,134][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-12 12:22:40,136][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-12 12:22:40,137][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-12 12:22:40,137][__main__][INFO] - Instantiating loggers...
[2023-01-12 12:22:40,138][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-12 12:22:40,138][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-12 12:23:20,498][__main__][INFO] - Starting training!
[2023-01-12 12:23:26,080][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-12 12:23:26,150][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 1806 had been created.
[2023-01-12 12:23:26,151][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-12 12:23:26,206][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-12 12:23:26,206][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-12 12:23:26,262][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-12 12:23:33,527][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1163, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/queue.py", line 178, in get
    raise Empty
_queue.Empty

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 72, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_train
    self._run_sanity_check()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1345, in _run_sanity_check
    val_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 155, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 127, in advance
    batch = next(data_fetcher)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 185, in __next__
    return self.fetching_function()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 264, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 278, in _fetch_next_batch
    batch = next(iterator)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 681, in __next__
    data = self._next_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1359, in _next_data
    idx, data = self._get_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1315, in _get_data
    success, data = self._try_get_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1176, in _try_get_data
    raise RuntimeError('DataLoader worker (pid(s) {}) exited unexpectedly'.format(pids_str)) from e
RuntimeError: DataLoader worker (pid(s) 14164) exited unexpectedly
[2023-01-12 12:23:33,539][src.utils.utils][INFO] - Closing loggers...
[2023-01-12 13:53:40,050][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-12 13:53:40,057][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-12 13:53:40,057][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-12 13:53:40,124][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-12 13:53:40,743][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2023-01-12 13:53:40,789][__main__][INFO] - Instantiating callbacks...
[2023-01-12 13:53:40,790][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-12 13:53:40,793][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-12 13:53:40,795][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-12 13:53:40,796][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-12 13:53:40,796][__main__][INFO] - Instantiating loggers...
[2023-01-12 13:53:40,797][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-12 13:53:40,797][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-12 13:54:20,279][__main__][INFO] - Starting training!
[2023-01-12 13:54:25,501][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-12 13:54:25,552][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 1806 had been created.
[2023-01-12 13:54:25,552][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-12 13:54:25,595][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-12 13:54:25,595][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-12 13:54:25,638][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-12 14:06:31,530][__main__][INFO] - Starting testing!
[2023-01-12 14:06:31,531][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-01-12 14:06:31,970][__main__][INFO] - Best ckpt path: None
[2023-01-12 14:06:31,978][src.utils.utils][INFO] - Closing loggers...
[2023-01-12 14:06:31,982][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-12_13-53-39
[2023-01-12 14:06:31,983][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-01-12 14:15:05,252][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-12 14:15:05,278][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-12 14:15:05,279][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-12 14:15:05,538][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-12 14:15:06,493][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2023-01-12 14:15:06,570][__main__][INFO] - Instantiating callbacks...
[2023-01-12 14:15:06,571][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-12 14:15:06,584][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-12 14:15:06,589][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-12 14:15:06,593][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-12 14:15:06,595][__main__][INFO] - Instantiating loggers...
[2023-01-12 14:15:06,596][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-12 14:15:06,596][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-12 14:15:33,093][__main__][INFO] - Starting training!
[2023-01-12 14:15:33,102][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-12 14:15:33,188][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 1806 had been created.
[2023-01-12 14:15:33,189][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-12 14:15:33,262][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-12 14:15:33,262][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-12 14:15:33,328][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-12 14:29:59,972][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-12 14:29:59,978][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-12 14:29:59,979][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-12 14:30:00,045][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-12 14:30:00,592][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2023-01-12 14:30:00,637][__main__][INFO] - Instantiating callbacks...
[2023-01-12 14:30:00,638][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-12 14:30:00,641][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-12 14:30:00,643][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-12 14:30:00,643][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-12 14:30:00,644][__main__][INFO] - Instantiating loggers...
[2023-01-12 14:30:00,644][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-12 14:30:00,645][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-12 14:30:41,261][__main__][INFO] - Starting training!
[2023-01-12 14:30:46,382][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-12 14:30:46,433][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 1806 had been created.
[2023-01-12 14:30:46,433][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-12 14:30:46,475][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-12 14:30:46,475][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-12 14:30:46,517][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-12 14:30:54,890][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 72, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_train
    self._run_sanity_check()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1345, in _run_sanity_check
    val_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 155, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 127, in advance
    batch = next(data_fetcher)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 185, in __next__
    return self.fetching_function()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 264, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 278, in _fetch_next_batch
    batch = next(iterator)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 681, in __next__
    data = self._next_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1376, in _next_data
    return self._process_data(data)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1402, in _process_data
    data.reraise()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/_utils.py", line 461, in reraise
    raise exception
ValueError: Caught ValueError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/fubao/dev/my-ndc/src/datamodules/components/pc_dataset4.py", line 176, in __getitem__
    tmp_grid[i:grid_size-pr+2+i, j:grid_size-pr+2+j, k:grid_size-pr+2 +k] = tmp_mask | tmp_grid[i:grid_size-pr+2+i, j:grid_size-pr+2+j, k:grid_size-pr+2+k]
ValueError: operands could not be broadcast together with shapes (0,0,0) (65,65,65) 

[2023-01-12 14:30:54,897][src.utils.utils][INFO] - Closing loggers...
[2023-01-12 14:34:51,408][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-12 14:34:51,415][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-12 14:34:51,415][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-12 14:34:51,481][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-12 14:34:52,156][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2023-01-12 14:34:52,214][__main__][INFO] - Instantiating callbacks...
[2023-01-12 14:34:52,214][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-12 14:34:52,219][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-12 14:34:52,220][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-12 14:34:52,221][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-12 14:34:52,222][__main__][INFO] - Instantiating loggers...
[2023-01-12 14:34:52,222][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-12 14:34:52,223][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-12 14:35:33,142][__main__][INFO] - Starting training!
[2023-01-12 14:35:38,361][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-12 14:35:38,413][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 1806 had been created.
[2023-01-12 14:35:38,414][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-12 14:35:38,457][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-12 14:35:38,458][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-12 14:35:38,500][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-12 14:36:19,582][__main__][INFO] - Starting testing!
[2023-01-12 14:36:19,584][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-01-12 14:36:20,049][__main__][INFO] - Best ckpt path: None
[2023-01-12 14:36:20,057][src.utils.utils][INFO] - Closing loggers...
[2023-01-12 14:36:20,060][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-12_14-34-51
[2023-01-12 14:36:20,061][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-01-12 14:37:36,196][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-12 14:37:36,203][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-12 14:37:36,204][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-12 14:37:36,271][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-12 14:37:36,873][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2023-01-12 14:37:36,931][__main__][INFO] - Instantiating callbacks...
[2023-01-12 14:37:36,931][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-12 14:37:36,936][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-12 14:37:36,937][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-12 14:37:36,938][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-12 14:37:36,939][__main__][INFO] - Instantiating loggers...
[2023-01-12 14:37:36,940][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-12 14:37:36,940][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-12 14:38:17,340][__main__][INFO] - Starting training!
[2023-01-12 14:38:22,872][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-12 14:38:22,936][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 1806 had been created.
[2023-01-12 14:38:22,936][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-12 14:38:22,990][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-12 14:38:22,991][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-12 14:38:23,045][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-12 14:45:19,016][__main__][INFO] - Starting testing!
[2023-01-12 14:45:19,017][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-01-12 14:45:19,739][__main__][INFO] - Best ckpt path: None
[2023-01-12 14:45:19,745][src.utils.utils][INFO] - Closing loggers...
[2023-01-12 14:45:19,747][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-12_14-37-36
[2023-01-12 14:45:19,748][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-01-12 14:45:55,089][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-12 14:45:55,096][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-12 14:45:55,096][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-12 14:45:55,162][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-12 14:45:55,748][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2023-01-12 14:45:55,793][__main__][INFO] - Instantiating callbacks...
[2023-01-12 14:45:55,793][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-12 14:45:55,797][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-12 14:45:55,798][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-12 14:45:55,799][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-12 14:45:55,800][__main__][INFO] - Instantiating loggers...
[2023-01-12 14:45:55,800][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-12 14:45:55,800][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-12 14:46:36,330][__main__][INFO] - Starting training!
[2023-01-12 14:46:41,586][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-12 14:46:41,641][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 1806 had been created.
[2023-01-12 14:46:41,642][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-12 14:46:41,690][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-12 14:46:41,690][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-12 14:46:41,737][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-12 14:48:55,833][__main__][INFO] - Starting testing!
[2023-01-12 14:48:55,834][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-01-12 14:48:58,271][__main__][INFO] - Best ckpt path: None
[2023-01-12 14:48:58,279][src.utils.utils][INFO] - Closing loggers...
[2023-01-12 14:48:58,281][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-12_14-45-54
[2023-01-12 14:48:58,282][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-01-12 14:49:09,168][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-12 14:49:09,175][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-12 14:49:09,175][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-12 14:49:09,238][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-12 14:49:09,806][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2023-01-12 14:49:09,864][__main__][INFO] - Instantiating callbacks...
[2023-01-12 14:49:09,864][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-12 14:49:09,869][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-12 14:49:09,870][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-12 14:49:09,871][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-12 14:49:09,872][__main__][INFO] - Instantiating loggers...
[2023-01-12 14:49:09,872][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-12 14:49:09,872][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-12 14:49:49,941][__main__][INFO] - Starting training!
[2023-01-12 14:49:55,307][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-12 14:49:55,388][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 1806 had been created.
[2023-01-12 14:49:55,389][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-12 14:49:55,447][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-12 14:49:55,447][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-12 14:49:55,506][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-12 14:50:46,331][__main__][INFO] - Starting testing!
[2023-01-12 14:50:46,332][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-01-12 14:50:53,036][__main__][INFO] - Best ckpt path: None
[2023-01-12 14:50:53,050][src.utils.utils][INFO] - Closing loggers...
[2023-01-12 14:50:53,055][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-12_14-49-09
[2023-01-12 14:50:53,056][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-01-12 14:51:04,259][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-12 14:51:04,266][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-12 14:51:04,266][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-12 14:51:04,327][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-12 14:51:04,841][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2023-01-12 14:51:04,886][__main__][INFO] - Instantiating callbacks...
[2023-01-12 14:51:04,887][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-12 14:51:04,890][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-12 14:51:04,892][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-12 14:51:04,892][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-12 14:51:04,893][__main__][INFO] - Instantiating loggers...
[2023-01-12 14:51:04,894][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-12 14:51:04,894][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-12 14:51:44,891][__main__][INFO] - Starting training!
[2023-01-12 14:51:50,331][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-12 14:51:50,382][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 1806 had been created.
[2023-01-12 14:51:50,382][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-12 14:51:50,425][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-12 14:51:50,425][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-12 14:51:50,466][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-12 15:07:42,351][__main__][INFO] - Starting testing!
[2023-01-12 15:07:42,352][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-01-12 15:07:44,473][__main__][INFO] - Best ckpt path: None
[2023-01-12 15:07:44,478][src.utils.utils][INFO] - Closing loggers...
[2023-01-12 15:07:44,480][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-12_14-51-04
[2023-01-12 15:07:44,481][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-01-12 15:14:28,831][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-12 15:14:28,838][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-12 15:14:28,838][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-12 15:14:28,900][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-12 15:14:29,530][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2023-01-12 15:14:29,588][__main__][INFO] - Instantiating callbacks...
[2023-01-12 15:14:29,588][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-12 15:14:29,593][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-12 15:14:29,594][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-12 15:14:29,595][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-12 15:14:29,596][__main__][INFO] - Instantiating loggers...
[2023-01-12 15:14:29,596][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-12 15:14:29,597][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-12 15:15:10,715][__main__][INFO] - Starting training!
[2023-01-12 15:15:16,456][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-12 15:15:16,529][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 1806 had been created.
[2023-01-12 15:15:16,529][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-12 15:15:16,589][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-12 15:15:16,589][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-12 15:15:16,648][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-12 15:15:31,234][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 72, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1285, in _run_train
    self.fit_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/fit_loop.py", line 270, in advance
    self._outputs = self.epoch_loop.run(self._data_fetcher)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 174, in advance
    batch = next(data_fetcher)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 185, in __next__
    return self.fetching_function()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 264, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 278, in _fetch_next_batch
    batch = next(iterator)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/supporters.py", line 558, in __next__
    return self.request_next_batch(self.loader_iters)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/supporters.py", line 570, in request_next_batch
    return apply_to_collection(loader_iters, Iterator, next)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/apply_func.py", line 100, in apply_to_collection
    return function(data, *args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 681, in __next__
    data = self._next_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1376, in _next_data
    return self._process_data(data)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1402, in _process_data
    data.reraise()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/_utils.py", line 461, in reraise
    raise exception
TypeError: Caught TypeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/fubao/dev/my-ndc/src/datamodules/components/pc_dataset4.py", line 122, in __getitem__
    gt_output_bool_, gt_output_float_, gt_input_gt = read_and_augment_data_undc(
TypeError: read_and_augment_data_undc() got multiple values for argument 'aug_permutation'

[2023-01-12 15:15:31,244][src.utils.utils][INFO] - Closing loggers...
[2023-01-12 15:16:43,513][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-12 15:16:43,519][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-12 15:16:43,520][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-12 15:16:43,581][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-12 15:16:44,140][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2023-01-12 15:16:44,197][__main__][INFO] - Instantiating callbacks...
[2023-01-12 15:16:44,198][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-12 15:16:44,202][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-12 15:16:44,203][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-12 15:16:44,204][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-12 15:16:44,205][__main__][INFO] - Instantiating loggers...
[2023-01-12 15:16:44,205][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-12 15:16:44,206][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-12 15:17:25,292][__main__][INFO] - Starting training!
[2023-01-12 15:17:30,608][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-12 15:17:30,671][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 1806 had been created.
[2023-01-12 15:17:30,671][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-12 15:17:30,726][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-12 15:17:30,727][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-12 15:17:30,782][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-12 15:18:32,288][__main__][INFO] - Starting testing!
[2023-01-12 15:18:32,289][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-01-12 15:18:37,190][__main__][INFO] - Best ckpt path: None
[2023-01-12 15:18:37,200][src.utils.utils][INFO] - Closing loggers...
[2023-01-12 15:18:37,204][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-12_15-16-43
[2023-01-12 15:18:37,205][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-01-12 15:21:23,133][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-12 15:21:23,140][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-12 15:21:23,140][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-12 15:21:23,202][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-12 15:21:23,778][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2023-01-12 15:21:23,822][__main__][INFO] - Instantiating callbacks...
[2023-01-12 15:21:23,823][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-12 15:21:23,826][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-12 15:21:23,827][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-12 15:21:23,828][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-12 15:21:23,829][__main__][INFO] - Instantiating loggers...
[2023-01-12 15:21:23,829][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-12 15:21:23,829][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-12 15:22:04,084][__main__][INFO] - Starting training!
[2023-01-12 15:22:09,312][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-12 15:22:09,362][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 1806 had been created.
[2023-01-12 15:22:09,362][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-12 15:22:09,405][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-12 15:22:09,405][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-12 15:22:09,448][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-12 15:26:25,804][__main__][INFO] - Starting testing!
[2023-01-12 15:26:25,805][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-01-12 15:26:33,913][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1163, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/queue.py", line 178, in get
    raise Empty
_queue.Empty

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 82, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 864, in test
    return self._call_and_handle_interrupt(self._test_impl, model, dataloaders, ckpt_path, verbose, datamodule)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 911, in _test_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1251, in _run_stage
    return self._run_evaluate()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1297, in _run_evaluate
    eval_loop_results = self._evaluation_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 155, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 127, in advance
    batch = next(data_fetcher)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 185, in __next__
    return self.fetching_function()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 264, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 278, in _fetch_next_batch
    batch = next(iterator)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 681, in __next__
    data = self._next_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1359, in _next_data
    idx, data = self._get_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1315, in _get_data
    success, data = self._try_get_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1176, in _try_get_data
    raise RuntimeError('DataLoader worker (pid(s) {}) exited unexpectedly'.format(pids_str)) from e
RuntimeError: DataLoader worker (pid(s) 1728, 1729, 1730, 1731, 1740, 1741, 1742, 1743, 1747, 1750, 1752) exited unexpectedly
[2023-01-12 15:26:33,922][src.utils.utils][INFO] - Closing loggers...
[2023-01-12 15:28:31,172][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-12 15:28:31,179][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-12 15:28:31,179][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-12 15:28:31,240][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-12 15:28:31,908][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2023-01-12 15:28:31,966][__main__][INFO] - Instantiating callbacks...
[2023-01-12 15:28:31,966][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-12 15:28:31,971][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-12 15:28:31,974][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-12 15:28:31,975][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-12 15:28:31,976][__main__][INFO] - Instantiating loggers...
[2023-01-12 15:28:31,977][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-12 15:28:31,977][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-12 15:29:12,929][__main__][INFO] - Starting training!
[2023-01-12 15:29:18,647][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-12 15:29:18,714][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 1806 had been created.
[2023-01-12 15:29:18,714][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-12 15:29:18,769][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-12 15:29:18,769][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-12 15:29:18,824][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-12 15:29:21,375][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 72, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_train
    self._run_sanity_check()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1345, in _run_sanity_check
    val_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 155, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 127, in advance
    batch = next(data_fetcher)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 185, in __next__
    return self.fetching_function()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 264, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 278, in _fetch_next_batch
    batch = next(iterator)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 681, in __next__
    data = self._next_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1376, in _next_data
    return self._process_data(data)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1402, in _process_data
    data.reraise()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/_utils.py", line 461, in reraise
    raise exception
TypeError: Caught TypeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/fubao/dev/my-ndc/src/datamodules/components/pc_dataset3.py", line 132, in __getitem__
    gt_output_bool_, gt_output_float_, gt_input_ = read_data(
TypeError: read_data() missing 1 required positional argument: 'is_undc'

[2023-01-12 15:29:21,392][src.utils.utils][INFO] - Closing loggers...
[2023-01-12 15:30:03,516][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-12 15:30:03,522][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-12 15:30:03,523][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-12 15:30:03,584][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-12 15:30:04,179][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2023-01-12 15:30:04,236][__main__][INFO] - Instantiating callbacks...
[2023-01-12 15:30:04,237][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-12 15:30:04,241][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-12 15:30:04,243][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-12 15:30:04,244][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-12 15:30:04,244][__main__][INFO] - Instantiating loggers...
[2023-01-12 15:30:04,245][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-12 15:30:04,245][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-12 15:30:44,869][__main__][INFO] - Starting training!
[2023-01-12 15:30:50,113][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-12 15:30:50,165][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 1806 had been created.
[2023-01-12 15:30:50,166][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-12 15:30:50,209][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-12 15:30:50,210][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-12 15:30:50,253][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-12 15:43:59,326][__main__][INFO] - Starting testing!
[2023-01-12 15:44:06,692][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1163, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/queue.py", line 178, in get
    raise Empty
_queue.Empty

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 82, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 864, in test
    return self._call_and_handle_interrupt(self._test_impl, model, dataloaders, ckpt_path, verbose, datamodule)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 911, in _test_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1251, in _run_stage
    return self._run_evaluate()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1297, in _run_evaluate
    eval_loop_results = self._evaluation_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 155, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 127, in advance
    batch = next(data_fetcher)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 185, in __next__
    return self.fetching_function()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 264, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 278, in _fetch_next_batch
    batch = next(iterator)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 681, in __next__
    data = self._next_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1359, in _next_data
    idx, data = self._get_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1315, in _get_data
    success, data = self._try_get_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1176, in _try_get_data
    raise RuntimeError('DataLoader worker (pid(s) {}) exited unexpectedly'.format(pids_str)) from e
RuntimeError: DataLoader worker (pid(s) 15321, 15322, 15323, 15324, 15325, 15326, 15327, 15329, 15330, 15331, 15332, 15333, 15334, 15335, 15336) exited unexpectedly
[2023-01-12 15:44:06,701][src.utils.utils][INFO] - Closing loggers...
[2023-01-12 15:44:16,372][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-12 15:44:16,379][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-12 15:44:16,379][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-12 15:44:16,463][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-12 15:44:17,129][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2023-01-12 15:44:17,189][__main__][INFO] - Instantiating callbacks...
[2023-01-12 15:44:17,190][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-12 15:44:17,194][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-12 15:44:17,196][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-12 15:44:17,196][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-12 15:44:17,197][__main__][INFO] - Instantiating loggers...
[2023-01-12 15:44:17,198][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-12 15:44:17,198][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-12 15:44:58,203][__main__][INFO] - Starting training!
[2023-01-12 15:45:03,580][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-12 15:45:03,635][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 1806 had been created.
[2023-01-12 15:45:03,636][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-12 15:45:03,682][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-12 15:45:03,683][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-12 15:45:03,729][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-12 15:45:10,146][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 72, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_train
    self._run_sanity_check()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1345, in _run_sanity_check
    val_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 155, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 143, in advance
    output = self._evaluation_step(**kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 240, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1706, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 370, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/home/fubao/dev/my-ndc/src/models/undc_module2.py", line 152, in validation_step
    self.gen_obj(pred_bool, pred_float, batch)
  File "/home/fubao/dev/my-ndc/src/models/undc_module2.py", line 254, in gen_obj
    self.generate_obj_test(voxel_xyz_int,gt_output_bool,gt_output_float, "gt",cate,shape_id)
  File "/home/fubao/dev/my-ndc/src/models/undc_module2.py", line 237, in generate_obj_test
    write_obj_triangle(f"{self.hparams.out_dir}/objs/{self.objs_id}/{cate}_{shape_id}/{name}.obj", vertices, triangles)
  File "/home/fubao/dev/my-ndc/src/utils/ndc_utils.py", line 1051, in write_obj_triangle
    fout = open(name, 'w')
FileNotFoundError: [Errno 2] No such file or directory: '/home/fubao/dev/my-ndc/logs/train/runs/2023-01-12_15-44-16/objs/0/trashcan_103013/gt.obj'
[2023-01-12 15:45:10,150][src.utils.utils][INFO] - Closing loggers...
[2023-01-12 15:45:53,039][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-12 15:45:53,046][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-12 15:45:53,046][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-12 15:45:53,109][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-12 15:45:53,777][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2023-01-12 15:45:53,836][__main__][INFO] - Instantiating callbacks...
[2023-01-12 15:45:53,837][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-12 15:45:53,841][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-12 15:45:53,843][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-12 15:45:53,843][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-12 15:45:53,844][__main__][INFO] - Instantiating loggers...
[2023-01-12 15:45:53,845][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-12 15:45:53,845][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-12 15:46:34,767][__main__][INFO] - Starting training!
[2023-01-12 15:46:40,232][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-12 15:46:40,309][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 1806 had been created.
[2023-01-12 15:46:40,309][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-12 15:46:40,368][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-12 15:46:40,368][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-12 15:46:40,427][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-12 15:46:48,385][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 72, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_train
    self._run_sanity_check()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1345, in _run_sanity_check
    val_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 155, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 143, in advance
    output = self._evaluation_step(**kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 240, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1706, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 370, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/home/fubao/dev/my-ndc/src/models/undc_module2.py", line 152, in validation_step
    self.gen_obj(pred_bool, pred_float, batch)
  File "/home/fubao/dev/my-ndc/src/models/undc_module2.py", line 260, in gen_obj
    self.save_pcs(pcs,cate,shape_id)
  File "/home/fubao/dev/my-ndc/src/models/undc_module2.py", line 206, in save_pcs
    np.savetxt(save_path,pcs.numpy())
  File "<__array_function__ internals>", line 180, in savetxt
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/numpy/lib/npyio.py", line 1503, in savetxt
    open(fname, 'wt').close()
FileNotFoundError: [Errno 2] No such file or directory: '/home/fubao/dev/my-ndc/logs/train/runs/2023-01-12_15-45-52/objs/0/trashcan/103013/pcs.txt'
[2023-01-12 15:46:48,391][src.utils.utils][INFO] - Closing loggers...
[2023-01-12 15:48:27,513][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-12 15:48:27,519][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-12 15:48:27,520][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-12 15:48:27,601][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-12 15:48:28,196][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2023-01-12 15:48:28,255][__main__][INFO] - Instantiating callbacks...
[2023-01-12 15:48:28,256][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-12 15:48:28,260][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-12 15:48:28,261][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-12 15:48:28,262][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-12 15:48:28,263][__main__][INFO] - Instantiating loggers...
[2023-01-12 15:48:28,263][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-12 15:48:28,264][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-12 15:48:32,180][src.utils.utils][INFO] - Closing loggers...
[2023-01-12 16:06:59,409][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-12 16:06:59,416][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-12 16:06:59,416][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-12 16:06:59,501][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-12 16:07:00,121][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2023-01-12 16:07:00,178][__main__][INFO] - Instantiating callbacks...
[2023-01-12 16:07:00,179][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-12 16:07:00,183][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-12 16:07:00,185][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-12 16:07:00,186][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-12 16:07:00,186][__main__][INFO] - Instantiating loggers...
[2023-01-12 16:07:00,187][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-12 16:07:00,187][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-12 16:07:41,131][__main__][INFO] - Starting training!
[2023-01-12 16:07:46,410][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-12 16:07:46,465][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 1806 had been created.
[2023-01-12 16:07:46,465][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-12 16:07:46,513][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-12 16:07:46,513][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-12 16:07:46,561][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-12 16:07:55,049][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 72, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_train
    self._run_sanity_check()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1345, in _run_sanity_check
    val_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 155, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 143, in advance
    output = self._evaluation_step(**kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 240, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1706, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 370, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/home/fubao/dev/my-ndc/src/models/undc_module2.py", line 152, in validation_step
    self.gen_obj(pred_bool, pred_float, batch)
  File "/home/fubao/dev/my-ndc/src/models/undc_module2.py", line 260, in gen_obj
    self.save_pcs(pcs,cate,shape_id)
  File "/home/fubao/dev/my-ndc/src/models/undc_module2.py", line 206, in save_pcs
    np.savetxt(save_path,pcs.numpy())
  File "<__array_function__ internals>", line 180, in savetxt
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/numpy/lib/npyio.py", line 1503, in savetxt
    open(fname, 'wt').close()
FileNotFoundError: [Errno 2] No such file or directory: '/home/fubao/dev/my-ndc/logs/train/runs/2023-01-12_16-06-59/objs/0/trashcan/103013/pcs.txt'
[2023-01-12 16:07:55,056][src.utils.utils][INFO] - Closing loggers...
[2023-01-12 16:08:39,503][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-12 16:08:39,510][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-12 16:08:39,510][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-12 16:08:39,572][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-12 16:08:40,178][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2023-01-12 16:08:40,230][__main__][INFO] - Instantiating callbacks...
[2023-01-12 16:08:40,230][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-12 16:08:40,234][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-12 16:08:40,235][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-12 16:08:40,236][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-12 16:08:40,237][__main__][INFO] - Instantiating loggers...
[2023-01-12 16:08:40,237][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-12 16:08:40,237][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-12 16:09:21,407][__main__][INFO] - Starting training!
[2023-01-12 16:09:26,715][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-12 16:09:26,771][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 1806 had been created.
[2023-01-12 16:09:26,771][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-12 16:09:26,817][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-12 16:09:26,817][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-12 16:09:26,862][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-12 16:09:35,748][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 72, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_train
    self._run_sanity_check()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1345, in _run_sanity_check
    val_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 155, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 143, in advance
    output = self._evaluation_step(**kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 240, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1706, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 370, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/home/fubao/dev/my-ndc/src/models/undc_module2.py", line 152, in validation_step
    self.gen_obj(pred_bool, pred_float, batch)
  File "/home/fubao/dev/my-ndc/src/models/undc_module2.py", line 260, in gen_obj
    self.save_pcs(pcs,cate,shape_id)
  File "/home/fubao/dev/my-ndc/src/models/undc_module2.py", line 206, in save_pcs
    np.savetxt(save_path,pcs.numpy())
  File "<__array_function__ internals>", line 180, in savetxt
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/numpy/lib/npyio.py", line 1503, in savetxt
    open(fname, 'wt').close()
FileNotFoundError: [Errno 2] No such file or directory: '/home/fubao/dev/my-ndc/logs/train/runs/2023-01-12_16-08-39/objs/epoch_0/trashcan/103013/pcs.txt'
[2023-01-12 16:09:35,752][src.utils.utils][INFO] - Closing loggers...
[2023-01-12 16:18:16,544][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-12 16:18:16,551][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-12 16:18:16,551][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-12 16:18:16,613][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-12 16:18:17,242][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2023-01-12 16:18:17,298][__main__][INFO] - Instantiating callbacks...
[2023-01-12 16:18:17,299][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-12 16:18:17,303][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-12 16:18:17,305][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-12 16:18:17,306][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-12 16:18:17,306][__main__][INFO] - Instantiating loggers...
[2023-01-12 16:18:17,307][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-12 16:18:17,307][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-12 16:18:58,965][__main__][INFO] - Starting training!
[2023-01-12 16:19:04,694][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-12 16:19:04,788][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 1806 had been created.
[2023-01-12 16:19:04,788][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-12 16:19:04,847][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-12 16:19:04,848][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-12 16:19:04,905][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-12 16:19:13,832][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 72, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_train
    self._run_sanity_check()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1345, in _run_sanity_check
    val_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 155, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 143, in advance
    output = self._evaluation_step(**kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 240, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1706, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 370, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/home/fubao/dev/my-ndc/src/models/undc_module2.py", line 152, in validation_step
    self.gen_obj(pred_bool, pred_float, batch)
  File "/home/fubao/dev/my-ndc/src/models/undc_module2.py", line 260, in gen_obj
    self.save_pcs(pcs,cate,shape_id)
  File "/home/fubao/dev/my-ndc/src/models/undc_module2.py", line 206, in save_pcs
    np.savetxt(save_path,pcs.numpy())
  File "<__array_function__ internals>", line 180, in savetxt
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/numpy/lib/npyio.py", line 1503, in savetxt
    open(fname, 'wt').close()
FileNotFoundError: [Errno 2] No such file or directory: '/home/fubao/dev/my-ndc/logs/train/runs/2023-01-12_16-18-16/objs/epoch_0/trashcan/103013/pcs.txt'
[2023-01-12 16:19:13,840][src.utils.utils][INFO] - Closing loggers...
[2023-01-12 16:19:34,426][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-12 16:19:34,433][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-12 16:19:34,433][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-12 16:19:34,498][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-12 16:19:35,072][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2023-01-12 16:19:35,129][__main__][INFO] - Instantiating callbacks...
[2023-01-12 16:19:35,130][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-12 16:19:35,133][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-12 16:19:35,135][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-12 16:19:35,135][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-12 16:19:35,136][__main__][INFO] - Instantiating loggers...
[2023-01-12 16:19:35,137][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-12 16:19:35,137][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-12 16:20:15,359][__main__][INFO] - Starting training!
[2023-01-12 16:20:21,095][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-12 16:20:21,178][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 1806 had been created.
[2023-01-12 16:20:21,178][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-12 16:20:21,249][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-12 16:20:21,249][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-12 16:20:21,310][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-12 16:46:31,268][__main__][INFO] - Starting testing!
[2023-01-12 16:46:33,113][__main__][INFO] - Best ckpt path: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-12_16-19-34/checkpoints/epoch_000.ckpt
[2023-01-12 16:46:33,122][src.utils.utils][INFO] - Closing loggers...
[2023-01-12 16:46:33,127][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-12_16-19-34
[2023-01-12 16:46:33,129][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-01-12 16:47:40,527][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-12 16:47:40,534][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-12 16:47:40,534][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-12 16:47:40,617][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-12 16:47:41,233][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2023-01-12 16:47:48,451][__main__][INFO] - Instantiating callbacks...
[2023-01-12 16:47:48,452][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-12 16:47:48,458][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-12 16:47:48,459][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-12 16:47:48,460][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-12 16:47:48,461][__main__][INFO] - Instantiating loggers...
[2023-01-12 16:47:48,461][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-12 16:47:48,462][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-12 16:47:48,850][__main__][INFO] - Starting training!
[2023-01-12 16:47:48,856][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-12 16:47:48,943][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 1806 had been created.
[2023-01-12 16:47:48,943][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-12 16:47:49,002][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-12 16:47:49,002][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-12 16:47:49,057][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-12 16:47:52,219][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 72, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_train
    self._run_sanity_check()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1345, in _run_sanity_check
    val_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 155, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 143, in advance
    output = self._evaluation_step(**kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 240, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1706, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 370, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/home/fubao/dev/my-ndc/src/models/undc_module2.py", line 137, in validation_step
    bool_loss, bool_acc, pred_bool, float_loss, pred_float = self.step(batch,val=True)
  File "/home/fubao/dev/my-ndc/src/models/undc_module2.py", line 106, in step
    distance = ((pred_output_float-gt_output_float)**2 )*gt_output_float_mask # MSE
RuntimeError: The size of tensor a (32331) must match the size of tensor b (65) at non-singleton dimension 2
[2023-01-12 16:47:52,226][src.utils.utils][INFO] - Closing loggers...
[2023-01-12 16:51:18,918][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-12 16:51:18,925][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-12 16:51:18,925][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-12 16:51:18,995][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-12 16:51:19,454][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2023-01-12 16:51:26,811][__main__][INFO] - Instantiating callbacks...
[2023-01-12 16:51:26,813][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-12 16:51:26,822][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-12 16:51:26,825][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-12 16:51:26,825][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-12 16:51:26,826][__main__][INFO] - Instantiating loggers...
[2023-01-12 16:51:26,827][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-12 16:51:26,827][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-12 16:51:27,283][__main__][INFO] - Starting training!
[2023-01-12 16:51:27,289][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-12 16:51:27,377][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 1806 had been created.
[2023-01-12 16:51:27,377][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-12 16:51:27,440][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-12 16:51:27,440][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-12 16:51:27,501][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 226 had been created.
[2023-01-12 19:12:06,041][__main__][INFO] - Starting testing!
[2023-01-12 19:23:21,761][__main__][INFO] - Best ckpt path: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-12_16-51-18/checkpoints/epoch_000.ckpt
[2023-01-12 19:23:21,764][src.utils.utils][INFO] - Closing loggers...
[2023-01-12 19:23:21,766][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-12_16-51-18
[2023-01-12 19:23:21,767][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-01-19 18:38:35,278][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-19 18:38:35,285][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-19 18:38:35,285][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-19 18:38:35,352][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-19 18:38:35,992][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2023-01-19 18:38:38,218][__main__][INFO] - Instantiating callbacks...
[2023-01-19 18:38:38,219][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-19 18:38:38,224][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-19 18:38:38,225][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-19 18:38:38,226][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-19 18:38:38,227][__main__][INFO] - Instantiating loggers...
[2023-01-19 18:38:38,227][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-19 18:38:38,228][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-19 18:38:38,730][__main__][INFO] - Starting training!
[2023-01-19 18:38:38,735][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-19 18:38:38,795][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 72, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1107, in _run
    self._call_setup_hook()  # allow user to setup lightning_module in accelerator environment
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1449, in _call_setup_hook
    self._call_lightning_datamodule_hook("setup", stage=fn)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1571, in _call_lightning_datamodule_hook
    return fn(*args, **kwargs)
  File "/home/fubao/dev/my-ndc/src/datamodules/undc_pc_datamodule2.py", line 48, in setup
    self.data_train = ABC_pc_hdf5(
  File "/home/fubao/dev/my-ndc/src/datamodules/components/pc_dataset3.py", line 63, in __init__
    with open(f"{data_dir}/my_obj_list.txt", "r") as fp:
FileNotFoundError: [Errno 2] No such file or directory: '/home/fubao/dev/InterRecon/gt_UNDC_onlys00/my_obj_list.txt'
[2023-01-19 18:38:38,798][src.utils.utils][INFO] - Closing loggers...
[2023-01-19 18:41:09,675][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-19 18:41:09,682][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-19 18:41:09,682][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-19 18:41:09,766][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-19 18:41:10,328][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2023-01-19 18:41:12,382][__main__][INFO] - Instantiating callbacks...
[2023-01-19 18:41:12,384][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-19 18:41:12,391][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-19 18:41:12,392][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-19 18:41:12,393][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-19 18:41:12,394][__main__][INFO] - Instantiating loggers...
[2023-01-19 18:41:12,394][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-19 18:41:12,395][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-19 18:41:12,824][__main__][INFO] - Starting training!
[2023-01-19 18:41:12,830][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-19 18:41:12,914][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 72, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1107, in _run
    self._call_setup_hook()  # allow user to setup lightning_module in accelerator environment
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1449, in _call_setup_hook
    self._call_lightning_datamodule_hook("setup", stage=fn)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1571, in _call_lightning_datamodule_hook
    return fn(*args, **kwargs)
  File "/home/fubao/dev/my-ndc/src/datamodules/undc_pc_datamodule2.py", line 48, in setup
    self.data_train = ABC_pc_hdf5(
  File "/home/fubao/dev/my-ndc/src/datamodules/components/pc_dataset3.py", line 71, in __init__
    idx = idx_dict_dict[cate][shape_id]
KeyError: 'oven'
[2023-01-19 18:41:12,920][src.utils.utils][INFO] - Closing loggers...
[2023-01-20 04:31:51,708][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-20 04:31:51,715][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-20 04:31:51,716][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-20 04:31:51,778][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-20 04:31:52,275][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2023-01-20 04:31:54,523][__main__][INFO] - Instantiating callbacks...
[2023-01-20 04:31:54,524][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-20 04:31:54,529][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-20 04:31:54,530][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-20 04:31:54,531][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-20 04:31:54,532][__main__][INFO] - Instantiating loggers...
[2023-01-20 04:31:54,532][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-20 04:31:54,533][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-20 04:31:54,929][__main__][INFO] - Starting training!
[2023-01-20 04:31:54,934][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-20 04:31:55,032][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 2096 had been created.
[2023-01-20 04:31:55,032][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-20 04:31:55,097][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 263 had been created.
[2023-01-20 04:31:55,098][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-20 04:31:55,161][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 263 had been created.
[2023-01-20 04:52:28,911][__main__][INFO] - Starting testing!
[2023-01-20 04:52:29,332][__main__][INFO] - Best ckpt path: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-20_04-31-51/checkpoints/epoch_000.ckpt
[2023-01-20 04:52:29,335][src.utils.utils][INFO] - Closing loggers...
[2023-01-20 04:52:29,337][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-20_04-31-51
[2023-01-20 04:52:29,338][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-01-20 15:20:25,852][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-20 15:20:25,860][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-20 15:20:25,860][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-20 15:20:25,925][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-20 15:20:26,378][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2023-01-20 15:20:26,435][__main__][INFO] - Instantiating callbacks...
[2023-01-20 15:20:26,435][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-20 15:20:26,440][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-20 15:20:26,442][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-20 15:20:26,443][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-20 15:20:26,444][__main__][INFO] - Instantiating loggers...
[2023-01-20 15:20:26,444][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-20 15:20:26,444][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-20 15:20:27,790][__main__][INFO] - Starting training!
[2023-01-20 15:20:28,049][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-20 15:20:28,121][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 2096 had been created.
[2023-01-20 15:20:28,122][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-20 15:20:28,185][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 263 had been created.
[2023-01-20 15:20:28,185][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-20 15:20:28,248][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 263 had been created.
[2023-01-20 17:25:15,958][__main__][INFO] - Starting testing!
[2023-01-20 17:34:12,676][__main__][INFO] - Best ckpt path: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-20_15-20-25/checkpoints/epoch_000.ckpt
[2023-01-20 17:34:12,679][src.utils.utils][INFO] - Closing loggers...
[2023-01-20 17:34:12,680][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-20_15-20-25
[2023-01-20 17:34:12,681][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-01-21 06:07:12,719][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-21 06:07:12,726][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-21 06:07:12,726][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-21 06:07:12,786][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-21 06:07:13,209][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2023-01-21 06:07:13,253][__main__][INFO] - Instantiating callbacks...
[2023-01-21 06:07:13,253][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-21 06:07:13,257][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-21 06:07:13,259][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-21 06:07:13,259][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-21 06:07:13,260][__main__][INFO] - Instantiating loggers...
[2023-01-21 06:07:13,260][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-21 06:07:13,261][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-21 06:07:14,714][__main__][INFO] - Starting training!
[2023-01-21 06:07:14,963][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-21 06:07:15,034][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 2096 had been created.
[2023-01-21 06:07:15,034][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-21 06:07:15,098][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 263 had been created.
[2023-01-21 06:07:15,098][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-21 06:07:15,161][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 263 had been created.
[2023-01-21 11:21:04,836][__main__][INFO] - Starting testing!
[2023-01-21 11:30:06,717][__main__][INFO] - Best ckpt path: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-21_06-07-12/checkpoints/epoch_000.ckpt
[2023-01-21 11:30:06,721][src.utils.utils][INFO] - Closing loggers...
[2023-01-21 11:30:06,722][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-21_06-07-12
[2023-01-21 11:30:06,723][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-01-21 22:04:01,750][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-21 22:04:01,756][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-21 22:04:01,757][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-21 22:04:01,822][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-21 22:04:02,265][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2023-01-21 22:04:04,244][__main__][INFO] - Instantiating callbacks...
[2023-01-21 22:04:04,245][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-21 22:04:04,249][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-21 22:04:04,251][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-21 22:04:04,252][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-21 22:04:04,252][__main__][INFO] - Instantiating loggers...
[2023-01-21 22:04:04,253][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-21 22:04:04,253][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-21 22:04:04,595][__main__][INFO] - Starting training!
[2023-01-21 22:04:04,600][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-21 22:04:04,672][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 2096 had been created.
[2023-01-21 22:04:04,672][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-21 22:04:04,736][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 263 had been created.
[2023-01-21 22:04:04,736][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-21 22:04:04,791][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 263 had been created.
[2023-01-22 11:44:10,430][__main__][INFO] - Starting testing!
[2023-01-22 11:57:48,258][__main__][INFO] - Best ckpt path: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-21_22-04-01/checkpoints/epoch_000.ckpt
[2023-01-22 11:57:48,261][src.utils.utils][INFO] - Closing loggers...
[2023-01-22 11:57:48,263][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-21_22-04-01
[2023-01-22 11:57:48,263][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-01-22 12:25:00,278][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-22 12:25:00,285][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-22 12:25:00,285][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-22 12:25:00,349][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-22 12:25:00,845][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2023-01-22 12:25:02,924][__main__][INFO] - Instantiating callbacks...
[2023-01-22 12:25:02,925][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-22 12:25:02,930][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-22 12:25:02,932][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-22 12:25:02,933][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-22 12:25:02,933][__main__][INFO] - Instantiating loggers...
[2023-01-22 12:25:02,934][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-22 12:25:02,934][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-22 12:25:03,371][__main__][INFO] - Starting training!
[2023-01-22 12:25:03,376][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-22 12:25:03,468][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 2096 had been created.
[2023-01-22 12:25:03,469][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-22 12:25:03,533][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 263 had been created.
[2023-01-22 12:25:03,533][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-22 12:25:03,596][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 263 had been created.
[2023-01-22 14:33:42,924][__main__][INFO] - Starting testing!
[2023-01-22 14:53:31,166][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-22 14:53:31,172][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-22 14:53:31,173][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-22 14:53:31,233][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-22 14:53:31,657][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2023-01-22 14:53:31,788][__main__][INFO] - Instantiating callbacks...
[2023-01-22 14:53:31,788][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-22 14:53:31,792][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-22 14:53:31,793][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-22 14:53:31,794][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-22 14:53:31,795][__main__][INFO] - Instantiating loggers...
[2023-01-22 14:53:31,795][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-22 14:53:31,795][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-22 14:53:33,141][__main__][INFO] - Starting training!
[2023-01-22 14:53:33,391][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-22 14:53:33,463][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 2096 had been created.
[2023-01-22 14:53:33,463][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-22 14:53:33,528][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 263 had been created.
[2023-01-22 14:53:33,528][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-22 14:53:33,593][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 263 had been created.
[2023-01-22 14:56:14,122][__main__][INFO] - Starting testing!
[2023-01-22 14:56:14,126][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-01-22 14:56:14,388][__main__][INFO] - Best ckpt path: None
[2023-01-22 14:56:14,392][src.utils.utils][INFO] - Closing loggers...
[2023-01-22 14:56:14,394][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-22_14-53-31
[2023-01-22 14:56:14,395][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-01-22 14:56:28,518][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-22 14:56:28,525][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-22 14:56:28,525][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-22 14:56:28,584][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-22 14:56:29,002][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2023-01-22 14:56:29,130][__main__][INFO] - Instantiating callbacks...
[2023-01-22 14:56:29,131][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-22 14:56:29,134][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-22 14:56:29,136][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-22 14:56:29,137][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-22 14:56:29,137][__main__][INFO] - Instantiating loggers...
[2023-01-22 14:56:29,138][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-22 14:56:29,138][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-22 14:56:30,657][__main__][INFO] - Starting training!
[2023-01-22 14:56:30,907][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-22 14:56:30,980][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 2096 had been created.
[2023-01-22 14:56:30,980][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-22 14:56:31,045][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 263 had been created.
[2023-01-22 14:56:31,046][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-22 14:56:31,111][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 263 had been created.
[2023-01-22 14:57:45,307][__main__][INFO] - Starting testing!
[2023-01-22 14:57:45,352][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-01-22 14:57:48,431][__main__][INFO] - Best ckpt path: None
[2023-01-22 14:57:48,440][src.utils.utils][INFO] - Closing loggers...
[2023-01-22 14:57:48,444][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-22_14-56-28
[2023-01-22 14:57:48,445][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-01-22 15:03:25,215][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-22 15:03:25,221][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-22 15:03:25,222][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-22 15:03:25,282][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-22 15:03:25,714][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2023-01-22 15:03:25,839][__main__][INFO] - Instantiating callbacks...
[2023-01-22 15:03:25,840][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-22 15:03:25,850][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-22 15:03:25,853][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-22 15:03:25,854][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-22 15:03:25,855][__main__][INFO] - Instantiating loggers...
[2023-01-22 15:03:25,856][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-22 15:03:25,857][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-22 15:03:27,212][__main__][INFO] - Starting training!
[2023-01-22 15:03:27,465][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-22 15:03:27,535][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 2096 had been created.
[2023-01-22 15:03:27,536][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-22 15:03:27,599][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 263 had been created.
[2023-01-22 15:03:27,599][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-22 15:03:27,662][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 263 had been created.
[2023-01-22 15:28:54,727][__main__][INFO] - Starting testing!
[2023-01-22 15:28:55,025][__main__][INFO] - Best ckpt path: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-22_15-03-25/checkpoints/epoch_000.ckpt
[2023-01-22 15:28:55,027][src.utils.utils][INFO] - Closing loggers...
[2023-01-22 15:28:55,028][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-22_15-03-25
[2023-01-22 15:28:55,029][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-01-22 15:29:28,837][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-22 15:29:28,844][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-22 15:29:28,844][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-22 15:29:28,928][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule_fight.UNDC_PC_DataModule>
[2023-01-22 15:29:29,548][__main__][INFO] - Instantiating model <src.models.undc_module_fight.UNDCLitModule>
[2023-01-22 15:29:29,684][__main__][INFO] - Instantiating callbacks...
[2023-01-22 15:29:29,684][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-22 15:29:29,688][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-22 15:29:29,689][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-22 15:29:29,690][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-22 15:29:29,691][__main__][INFO] - Instantiating loggers...
[2023-01-22 15:29:29,691][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-22 15:29:29,691][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-22 15:29:31,078][__main__][INFO] - Starting training!
[2023-01-22 15:29:31,307][src.datamodules.undc_pc_datamodule_fight][INFO] - Loading Train dataset...
[2023-01-22 15:29:31,356][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 72, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1107, in _run
    self._call_setup_hook()  # allow user to setup lightning_module in accelerator environment
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1449, in _call_setup_hook
    self._call_lightning_datamodule_hook("setup", stage=fn)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1571, in _call_lightning_datamodule_hook
    return fn(*args, **kwargs)
  File "/home/fubao/dev/my-ndc/src/datamodules/undc_pc_datamodule_fight.py", line 48, in setup
    self.data_train = ABC_pc_hdf5(
  File "/home/fubao/dev/my-ndc/src/datamodules/components/pc_dataset_fight.py", line 62, in __init__
    self.data_list.append(line.strip())
AttributeError: 'ABC_pc_hdf5' object has no attribute 'data_list'
[2023-01-22 15:29:31,359][src.utils.utils][INFO] - Closing loggers...
[2023-01-22 15:30:48,768][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-22 15:30:48,776][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-22 15:30:48,776][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-22 15:30:48,852][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule_fight.UNDC_PC_DataModule>
[2023-01-22 15:30:49,325][__main__][INFO] - Instantiating model <src.models.undc_module_fight.UNDCLitModule>
[2023-01-22 15:30:49,458][__main__][INFO] - Instantiating callbacks...
[2023-01-22 15:30:49,458][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-22 15:30:49,463][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-22 15:30:49,465][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-22 15:30:49,465][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-22 15:30:49,466][__main__][INFO] - Instantiating loggers...
[2023-01-22 15:30:49,467][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-22 15:30:49,467][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-22 15:30:50,826][__main__][INFO] - Starting training!
[2023-01-22 15:30:51,088][src.datamodules.undc_pc_datamodule_fight][INFO] - Loading Train dataset...
[2023-01-22 15:30:51,531][src.datamodules.undc_pc_datamodule_fight][INFO] - Train dataset [ABC_pc_hdf5] of size 0 had been created.
[2023-01-22 15:30:51,531][src.datamodules.undc_pc_datamodule_fight][INFO] - Loading Val dataset...
[2023-01-22 15:30:51,619][src.datamodules.undc_pc_datamodule_fight][INFO] - Val dataset [ABC_pc_hdf5] of size 0 had been created.
[2023-01-22 15:30:51,620][src.datamodules.undc_pc_datamodule_fight][INFO] - Loading Test dataset...
[2023-01-22 15:30:51,697][src.datamodules.undc_pc_datamodule_fight][INFO] - Test dataset [ABC_pc_hdf5] of size 0 had been created.
[2023-01-22 15:30:53,985][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 72, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_train
    self._run_sanity_check()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1347, in _run_sanity_check
    self._call_callback_hooks("on_sanity_check_end")
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1599, in _call_callback_hooks
    fn(self, self.lightning_module, *args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/callbacks/progress/rich_progress.py", line 323, in on_sanity_check_end
    self.progress.update(self.val_sanity_progress_bar_id, advance=0, visible=False)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/rich/progress.py", line 1431, in update
    task = self._tasks[task_id]
KeyError: None
[2023-01-22 15:30:53,990][src.utils.utils][INFO] - Closing loggers...
[2023-01-22 15:31:51,453][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-22 15:31:51,479][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-22 15:31:51,480][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-22 15:31:51,724][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule_fight.UNDC_PC_DataModule>
[2023-01-22 15:31:52,515][__main__][INFO] - Instantiating model <src.models.undc_module_fight.UNDCLitModule>
[2023-01-22 15:31:52,670][__main__][INFO] - Instantiating callbacks...
[2023-01-22 15:31:52,671][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-22 15:31:52,684][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-22 15:31:52,689][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-22 15:31:52,691][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-22 15:31:52,693][__main__][INFO] - Instantiating loggers...
[2023-01-22 15:31:52,693][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-22 15:31:52,694][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-22 15:31:54,875][__main__][INFO] - Starting training!
[2023-01-22 15:31:54,888][src.datamodules.undc_pc_datamodule_fight][INFO] - Loading Train dataset...
[2023-01-22 15:31:55,017][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/fubao/dev/my-ndc/src/train.py", line 72, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1107, in _run
    self._call_setup_hook()  # allow user to setup lightning_module in accelerator environment
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1449, in _call_setup_hook
    self._call_lightning_datamodule_hook("setup", stage=fn)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1571, in _call_lightning_datamodule_hook
    return fn(*args, **kwargs)
  File "/home/fubao/dev/my-ndc/src/datamodules/undc_pc_datamodule_fight.py", line 48, in setup
    self.data_train = ABC_pc_hdf5(
  File "/home/fubao/dev/my-ndc/src/datamodules/components/pc_dataset_fight.py", line 63, in __init__
    self.data_list.append(line.strip())
AttributeError: 'ABC_pc_hdf5' object has no attribute 'data_list'
[2023-01-22 15:31:55,024][src.utils.utils][INFO] - Closing loggers...
[2023-01-22 15:37:56,992][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-22 15:37:57,020][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-22 15:37:57,021][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-22 15:37:57,335][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule_fight.UNDC_PC_DataModule>
[2023-01-22 15:37:58,263][__main__][INFO] - Instantiating model <src.models.undc_module_fight.UNDCLitModule>
[2023-01-22 15:37:58,423][__main__][INFO] - Instantiating callbacks...
[2023-01-22 15:37:58,424][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-22 15:37:58,438][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-22 15:37:58,443][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-22 15:37:58,445][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-22 15:37:58,447][__main__][INFO] - Instantiating loggers...
[2023-01-22 15:37:58,448][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-22 15:37:58,448][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-22 15:38:00,721][__main__][INFO] - Starting training!
[2023-01-22 15:38:00,734][src.datamodules.undc_pc_datamodule_fight][INFO] - Loading Train dataset...
[2023-01-22 15:39:53,078][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-22 15:39:53,085][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-22 15:39:53,086][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-22 15:39:53,147][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule_fight.UNDC_PC_DataModule>
[2023-01-22 15:39:53,585][__main__][INFO] - Instantiating model <src.models.undc_module_fight.UNDCLitModule>
[2023-01-22 15:39:53,719][__main__][INFO] - Instantiating callbacks...
[2023-01-22 15:39:53,719][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-22 15:39:53,724][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-22 15:39:53,726][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-22 15:39:53,726][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-22 15:39:53,727][__main__][INFO] - Instantiating loggers...
[2023-01-22 15:39:53,728][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-22 15:39:53,728][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-22 15:39:55,113][__main__][INFO] - Starting training!
[2023-01-22 15:39:55,371][src.datamodules.undc_pc_datamodule_fight][INFO] - Loading Train dataset...
[2023-01-22 15:39:55,452][src.datamodules.undc_pc_datamodule_fight][INFO] - Train dataset [ABC_pc_hdf5] of size 2352 had been created.
[2023-01-22 15:39:55,453][src.datamodules.undc_pc_datamodule_fight][INFO] - Loading Val dataset...
[2023-01-22 15:39:55,506][src.datamodules.undc_pc_datamodule_fight][INFO] - Val dataset [ABC_pc_hdf5] of size 135 had been created.
[2023-01-22 15:39:55,506][src.datamodules.undc_pc_datamodule_fight][INFO] - Loading Test dataset...
[2023-01-22 15:39:55,560][src.datamodules.undc_pc_datamodule_fight][INFO] - Test dataset [ABC_pc_hdf5] of size 135 had been created.
[2023-01-22 15:39:59,372][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 72, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_train
    self._run_sanity_check()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1345, in _run_sanity_check
    val_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 155, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 127, in advance
    batch = next(data_fetcher)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 185, in __next__
    return self.fetching_function()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 264, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 278, in _fetch_next_batch
    batch = next(iterator)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 681, in __next__
    data = self._next_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1376, in _next_data
    return self._process_data(data)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1402, in _process_data
    data.reraise()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/_utils.py", line 461, in reraise
    raise exception
AttributeError: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/fubao/dev/my-ndc/src/datamodules/components/pc_dataset_fight.py", line 124, in __getitem__
    if self.train:
AttributeError: 'ABC_pc_hdf5' object has no attribute 'train'

[2023-01-22 15:39:59,379][src.utils.utils][INFO] - Closing loggers...
[2023-01-22 15:40:55,349][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-22 15:40:55,355][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-22 15:40:55,356][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-22 15:40:55,417][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule_fight.UNDC_PC_DataModule>
[2023-01-22 15:40:55,856][__main__][INFO] - Instantiating model <src.models.undc_module_fight.UNDCLitModule>
[2023-01-22 15:40:55,984][__main__][INFO] - Instantiating callbacks...
[2023-01-22 15:40:55,984][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-22 15:40:55,989][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-22 15:40:55,990][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-22 15:40:55,991][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-22 15:40:55,992][__main__][INFO] - Instantiating loggers...
[2023-01-22 15:40:55,992][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-22 15:40:55,993][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-22 15:40:57,340][__main__][INFO] - Starting training!
[2023-01-22 15:40:57,603][src.datamodules.undc_pc_datamodule_fight][INFO] - Loading Train dataset...
[2023-01-22 15:40:57,688][src.datamodules.undc_pc_datamodule_fight][INFO] - Train dataset [ABC_pc_hdf5] of size 2352 had been created.
[2023-01-22 15:40:57,688][src.datamodules.undc_pc_datamodule_fight][INFO] - Loading Val dataset...
[2023-01-22 15:40:57,741][src.datamodules.undc_pc_datamodule_fight][INFO] - Val dataset [ABC_pc_hdf5] of size 135 had been created.
[2023-01-22 15:40:57,742][src.datamodules.undc_pc_datamodule_fight][INFO] - Loading Test dataset...
[2023-01-22 15:40:57,795][src.datamodules.undc_pc_datamodule_fight][INFO] - Test dataset [ABC_pc_hdf5] of size 135 had been created.
[2023-01-22 15:41:01,627][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 72, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_train
    self._run_sanity_check()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1345, in _run_sanity_check
    val_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 155, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 127, in advance
    batch = next(data_fetcher)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 185, in __next__
    return self.fetching_function()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 264, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 278, in _fetch_next_batch
    batch = next(iterator)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 681, in __next__
    data = self._next_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1376, in _next_data
    return self._process_data(data)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1402, in _process_data
    data.reraise()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/_utils.py", line 461, in reraise
    raise exception
AttributeError: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/fubao/dev/my-ndc/src/datamodules/components/pc_dataset_fight.py", line 139, in __getitem__
    if self.train:
AttributeError: 'ABC_pc_hdf5' object has no attribute 'train'

[2023-01-22 15:41:01,644][src.utils.utils][INFO] - Closing loggers...
[2023-01-22 15:41:59,186][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-22 15:41:59,192][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-22 15:41:59,193][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-22 15:41:59,254][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule_fight.UNDC_PC_DataModule>
[2023-01-22 15:41:59,688][__main__][INFO] - Instantiating model <src.models.undc_module_fight.UNDCLitModule>
[2023-01-22 15:41:59,814][__main__][INFO] - Instantiating callbacks...
[2023-01-22 15:41:59,814][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-22 15:41:59,819][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-22 15:41:59,820][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-22 15:41:59,821][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-22 15:41:59,822][__main__][INFO] - Instantiating loggers...
[2023-01-22 15:41:59,822][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-22 15:41:59,822][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-22 15:42:01,207][__main__][INFO] - Starting training!
[2023-01-22 15:42:01,459][src.datamodules.undc_pc_datamodule_fight][INFO] - Loading Train dataset...
[2023-01-22 15:42:01,540][src.datamodules.undc_pc_datamodule_fight][INFO] - Train dataset [ABC_pc_hdf5] of size 2352 had been created.
[2023-01-22 15:42:01,541][src.datamodules.undc_pc_datamodule_fight][INFO] - Loading Val dataset...
[2023-01-22 15:42:01,609][src.datamodules.undc_pc_datamodule_fight][INFO] - Val dataset [ABC_pc_hdf5] of size 135 had been created.
[2023-01-22 15:42:01,610][src.datamodules.undc_pc_datamodule_fight][INFO] - Loading Test dataset...
[2023-01-22 15:42:01,676][src.datamodules.undc_pc_datamodule_fight][INFO] - Test dataset [ABC_pc_hdf5] of size 135 had been created.
[2023-01-22 15:42:05,329][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 72, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_train
    self._run_sanity_check()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1345, in _run_sanity_check
    val_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 155, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 127, in advance
    batch = next(data_fetcher)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 185, in __next__
    return self.fetching_function()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 264, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 278, in _fetch_next_batch
    batch = next(iterator)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 681, in __next__
    data = self._next_data()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1376, in _next_data
    return self._process_data(data)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1402, in _process_data
    data.reraise()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/_utils.py", line 461, in reraise
    raise exception
AttributeError: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/fubao/dev/my-ndc/src/datamodules/components/pc_dataset_fight.py", line 139, in __getitem__
    if self.train:
AttributeError: 'ABC_pc_hdf5' object has no attribute 'train'

[2023-01-22 15:42:05,346][src.utils.utils][INFO] - Closing loggers...
[2023-01-22 15:42:48,106][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-22 15:42:48,114][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-22 15:42:48,114][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-22 15:42:48,176][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule_fight.UNDC_PC_DataModule>
[2023-01-22 15:42:48,671][__main__][INFO] - Instantiating model <src.models.undc_module_fight.UNDCLitModule>
[2023-01-22 15:42:48,803][__main__][INFO] - Instantiating callbacks...
[2023-01-22 15:42:48,804][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-22 15:42:48,809][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-22 15:42:48,810][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-22 15:42:48,811][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-22 15:42:48,812][__main__][INFO] - Instantiating loggers...
[2023-01-22 15:42:48,812][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-22 15:42:48,812][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-22 15:42:50,169][__main__][INFO] - Starting training!
[2023-01-22 15:42:50,404][src.datamodules.undc_pc_datamodule_fight][INFO] - Loading Train dataset...
[2023-01-22 15:42:50,474][src.datamodules.undc_pc_datamodule_fight][INFO] - Train dataset [ABC_pc_hdf5] of size 2352 had been created.
[2023-01-22 15:42:50,475][src.datamodules.undc_pc_datamodule_fight][INFO] - Loading Val dataset...
[2023-01-22 15:42:50,519][src.datamodules.undc_pc_datamodule_fight][INFO] - Val dataset [ABC_pc_hdf5] of size 135 had been created.
[2023-01-22 15:42:50,519][src.datamodules.undc_pc_datamodule_fight][INFO] - Loading Test dataset...
[2023-01-22 15:42:50,561][src.datamodules.undc_pc_datamodule_fight][INFO] - Test dataset [ABC_pc_hdf5] of size 135 had been created.
[2023-01-22 15:43:48,192][__main__][INFO] - Starting testing!
[2023-01-22 15:43:48,197][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-01-22 15:43:48,568][__main__][INFO] - Best ckpt path: None
[2023-01-22 15:43:48,572][src.utils.utils][INFO] - Closing loggers...
[2023-01-22 15:43:48,574][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-22_15-42-48
[2023-01-22 15:43:48,575][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-01-22 15:44:01,665][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-22 15:44:01,671][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-22 15:44:01,671][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-22 15:44:01,736][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule.UNDC_PC_DataModule>
[2023-01-22 15:44:02,180][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2023-01-22 15:44:02,316][__main__][INFO] - Instantiating callbacks...
[2023-01-22 15:44:02,316][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-22 15:44:02,321][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-22 15:44:02,323][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-22 15:44:02,323][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-22 15:44:02,324][__main__][INFO] - Instantiating loggers...
[2023-01-22 15:44:02,324][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-22 15:44:02,325][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-22 15:44:03,675][__main__][INFO] - Starting training!
[2023-01-22 15:44:03,927][src.datamodules.undc_pc_datamodule][INFO] - Loading Train dataset...
[2023-01-22 15:44:03,932][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 72, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1107, in _run
    self._call_setup_hook()  # allow user to setup lightning_module in accelerator environment
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1449, in _call_setup_hook
    self._call_lightning_datamodule_hook("setup", stage=fn)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1571, in _call_lightning_datamodule_hook
    return fn(*args, **kwargs)
  File "/home/fubao/dev/my-ndc/src/datamodules/undc_pc_datamodule.py", line 48, in setup
    self.data_train = ABC_pc_hdf5(
  File "/home/fubao/dev/my-ndc/src/datamodules/components/pc_dataset.py", line 25, in __init__
    with open(f"{data_dir}/abc_obj_list.txt", "r") as fp:
FileNotFoundError: [Errno 2] No such file or directory: '/home/fubao/dev/InterRecon/gt_UNDC_onlys00/abc_obj_list.txt'
[2023-01-22 15:44:03,935][src.utils.utils][INFO] - Closing loggers...
[2023-01-22 15:44:23,929][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-22 15:44:23,936][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-22 15:44:23,936][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-22 15:44:23,995][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule2.UNDC_PC_DataModule>
[2023-01-22 15:44:24,428][__main__][INFO] - Instantiating model <src.models.undc_module2.UNDCLitModule>
[2023-01-22 15:44:24,557][__main__][INFO] - Instantiating callbacks...
[2023-01-22 15:44:24,557][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-22 15:44:24,562][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-22 15:44:24,563][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-22 15:44:24,564][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-22 15:44:24,565][__main__][INFO] - Instantiating loggers...
[2023-01-22 15:44:24,565][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-22 15:44:24,565][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-22 15:44:25,923][__main__][INFO] - Starting training!
[2023-01-22 15:44:26,171][src.datamodules.undc_pc_datamodule2][INFO] - Loading Train dataset...
[2023-01-22 15:44:26,242][src.datamodules.undc_pc_datamodule2][INFO] - Train dataset [ABC_pc_hdf5] of size 2096 had been created.
[2023-01-22 15:44:26,243][src.datamodules.undc_pc_datamodule2][INFO] - Loading Val dataset...
[2023-01-22 15:44:26,307][src.datamodules.undc_pc_datamodule2][INFO] - Val dataset [ABC_pc_hdf5] of size 263 had been created.
[2023-01-22 15:44:26,307][src.datamodules.undc_pc_datamodule2][INFO] - Loading Test dataset...
[2023-01-22 15:44:26,371][src.datamodules.undc_pc_datamodule2][INFO] - Test dataset [ABC_pc_hdf5] of size 263 had been created.
[2023-01-22 15:44:44,076][__main__][INFO] - Starting testing!
[2023-01-22 15:44:44,077][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-01-22 15:44:48,112][__main__][INFO] - Best ckpt path: None
[2023-01-22 15:44:48,124][src.utils.utils][INFO] - Closing loggers...
[2023-01-22 15:44:48,129][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-22_15-44-23
[2023-01-22 15:44:48,131][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-01-22 15:44:56,442][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-22 15:44:56,449][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-22 15:44:56,450][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-22 15:44:56,512][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule_fight.UNDC_PC_DataModule>
[2023-01-22 15:44:56,972][__main__][INFO] - Instantiating model <src.models.undc_module_fight.UNDCLitModule>
[2023-01-22 15:44:57,105][__main__][INFO] - Instantiating callbacks...
[2023-01-22 15:44:57,106][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-22 15:44:57,111][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-22 15:44:57,113][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-22 15:44:57,113][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-22 15:44:57,114][__main__][INFO] - Instantiating loggers...
[2023-01-22 15:44:57,114][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-22 15:44:57,115][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-22 15:44:58,471][__main__][INFO] - Starting training!
[2023-01-22 15:44:58,751][src.datamodules.undc_pc_datamodule_fight][INFO] - Loading Train dataset...
[2023-01-22 15:44:58,847][src.datamodules.undc_pc_datamodule_fight][INFO] - Train dataset [ABC_pc_hdf5] of size 2352 had been created.
[2023-01-22 15:44:58,847][src.datamodules.undc_pc_datamodule_fight][INFO] - Loading Val dataset...
[2023-01-22 15:44:58,902][src.datamodules.undc_pc_datamodule_fight][INFO] - Val dataset [ABC_pc_hdf5] of size 135 had been created.
[2023-01-22 15:44:58,902][src.datamodules.undc_pc_datamodule_fight][INFO] - Loading Test dataset...
[2023-01-22 15:44:58,957][src.datamodules.undc_pc_datamodule_fight][INFO] - Test dataset [ABC_pc_hdf5] of size 135 had been created.
[2023-01-22 15:48:05,702][__main__][INFO] - Starting testing!
[2023-01-22 15:48:05,704][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-01-22 15:48:06,207][__main__][INFO] - Best ckpt path: None
[2023-01-22 15:48:06,210][src.utils.utils][INFO] - Closing loggers...
[2023-01-22 15:48:06,212][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-22_15-44-56
[2023-01-22 15:48:06,213][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-01-22 15:48:28,167][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-22 15:48:28,174][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-22 15:48:28,174][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-22 15:48:28,254][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule_fight.UNDC_PC_DataModule>
[2023-01-22 15:48:28,862][__main__][INFO] - Instantiating model <src.models.undc_module_fight.UNDCLitModule>
[2023-01-22 15:48:28,989][__main__][INFO] - Instantiating callbacks...
[2023-01-22 15:48:28,990][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-22 15:48:28,995][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-22 15:48:28,996][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-22 15:48:28,997][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-22 15:48:28,997][__main__][INFO] - Instantiating loggers...
[2023-01-22 15:48:28,998][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-22 15:48:28,998][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-22 15:48:30,354][__main__][INFO] - Starting training!
[2023-01-22 15:48:30,601][src.datamodules.undc_pc_datamodule_fight][INFO] - Loading Train dataset...
[2023-01-22 15:48:30,683][src.datamodules.undc_pc_datamodule_fight][INFO] - Train dataset [ABC_pc_hdf5] of size 2352 had been created.
[2023-01-22 15:48:30,683][src.datamodules.undc_pc_datamodule_fight][INFO] - Loading Val dataset...
[2023-01-22 15:48:30,737][src.datamodules.undc_pc_datamodule_fight][INFO] - Val dataset [ABC_pc_hdf5] of size 135 had been created.
[2023-01-22 15:48:30,737][src.datamodules.undc_pc_datamodule_fight][INFO] - Loading Test dataset...
[2023-01-22 15:48:30,790][src.datamodules.undc_pc_datamodule_fight][INFO] - Test dataset [ABC_pc_hdf5] of size 135 had been created.
[2023-01-22 15:48:32,680][__main__][INFO] - Starting testing!
[2023-01-22 15:48:32,681][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-01-22 15:48:35,714][__main__][INFO] - Best ckpt path: None
[2023-01-22 15:48:35,717][src.utils.utils][INFO] - Closing loggers...
[2023-01-22 15:48:35,718][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-22_15-48-28
[2023-01-22 15:48:35,719][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-01-22 15:49:09,233][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-22 15:49:09,241][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-22 15:49:09,241][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-22 15:49:09,304][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule_fight.UNDC_PC_DataModule>
[2023-01-22 15:49:09,747][__main__][INFO] - Instantiating model <src.models.undc_module_fight.UNDCLitModule>
[2023-01-22 15:49:09,875][__main__][INFO] - Instantiating callbacks...
[2023-01-22 15:49:09,875][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-22 15:49:09,880][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-22 15:49:09,882][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-22 15:49:09,882][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-22 15:49:09,883][__main__][INFO] - Instantiating loggers...
[2023-01-22 15:49:09,883][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-22 15:49:09,884][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-22 15:49:11,208][__main__][INFO] - Starting training!
[2023-01-22 15:49:11,460][src.datamodules.undc_pc_datamodule_fight][INFO] - Loading Train dataset...
[2023-01-22 15:49:11,542][src.datamodules.undc_pc_datamodule_fight][INFO] - Train dataset [ABC_pc_hdf5] of size 2352 had been created.
[2023-01-22 15:49:11,542][src.datamodules.undc_pc_datamodule_fight][INFO] - Loading Val dataset...
[2023-01-22 15:49:11,595][src.datamodules.undc_pc_datamodule_fight][INFO] - Val dataset [ABC_pc_hdf5] of size 135 had been created.
[2023-01-22 15:49:11,596][src.datamodules.undc_pc_datamodule_fight][INFO] - Loading Test dataset...
[2023-01-22 15:49:11,649][src.datamodules.undc_pc_datamodule_fight][INFO] - Test dataset [ABC_pc_hdf5] of size 135 had been created.
[2023-01-22 16:51:36,458][src.utils.utils][INFO] - Closing loggers...
[2023-01-22 16:51:36,462][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-22_15-49-09
[2023-01-22 16:51:36,464][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-01-22 19:48:06,149][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-22 19:48:06,155][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-22 19:48:06,156][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-22 19:48:06,220][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule_fight.UNDC_PC_DataModule>
[2023-01-22 19:48:06,688][__main__][INFO] - Instantiating model <src.models.undc_module_pre.UNDCLitModule>
[2023-01-22 19:48:09,185][__main__][INFO] - Instantiating callbacks...
[2023-01-22 19:48:09,188][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-22 19:48:09,198][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-22 19:48:09,201][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-22 19:48:09,202][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-22 19:48:09,203][__main__][INFO] - Instantiating loggers...
[2023-01-22 19:48:09,204][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-22 19:48:09,204][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-22 19:48:09,663][__main__][INFO] - Starting training!
[2023-01-22 19:48:09,668][src.datamodules.undc_pc_datamodule_fight][INFO] - Loading Train dataset...
[2023-01-22 19:48:09,771][src.datamodules.undc_pc_datamodule_fight][INFO] - Train dataset [ABC_pc_hdf5] of size 2352 had been created.
[2023-01-22 19:48:09,771][src.datamodules.undc_pc_datamodule_fight][INFO] - Loading Val dataset...
[2023-01-22 19:48:09,824][src.datamodules.undc_pc_datamodule_fight][INFO] - Val dataset [ABC_pc_hdf5] of size 135 had been created.
[2023-01-22 19:48:09,824][src.datamodules.undc_pc_datamodule_fight][INFO] - Loading Test dataset...
[2023-01-22 19:48:09,878][src.datamodules.undc_pc_datamodule_fight][INFO] - Test dataset [ABC_pc_hdf5] of size 135 had been created.
[2023-01-22 20:25:04,562][src.utils.utils][INFO] - Closing loggers...
[2023-01-22 20:25:04,563][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-22_19-48-06
[2023-01-22 20:25:04,564][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-01-23 00:35:33,523][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-23 00:35:33,530][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-23 00:35:33,531][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-23 00:35:33,597][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule_fight.UNDC_PC_DataModule>
[2023-01-23 00:35:34,048][__main__][INFO] - Instantiating model <src.models.undc_module_pre.UNDCLitModule>
[2023-01-23 00:35:34,115][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
TypeError: __init__() got an unexpected keyword argument 'net_flaot'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 46, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 339, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.models.undc_module_pre.UNDCLitModule':
TypeError("__init__() got an unexpected keyword argument 'net_flaot'")
full_key: model
[2023-01-23 00:35:34,117][src.utils.utils][INFO] - Closing loggers...
[2023-01-23 00:36:28,043][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-23 00:36:28,050][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-23 00:36:28,050][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-23 00:36:28,136][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule_fight.UNDC_PC_DataModule>
[2023-01-23 00:36:28,683][__main__][INFO] - Instantiating model <src.models.undc_module_pre.UNDCLitModule>
[2023-01-23 00:36:28,759][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
TypeError: __init__() got an unexpected keyword argument 'net_flaot'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 46, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 339, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.models.undc_module_pre.UNDCLitModule':
TypeError("__init__() got an unexpected keyword argument 'net_flaot'")
full_key: model
[2023-01-23 00:36:28,762][src.utils.utils][INFO] - Closing loggers...
[2023-01-23 00:36:57,928][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-23 00:36:57,935][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-23 00:36:57,935][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-23 00:36:58,000][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule_fight.UNDC_PC_DataModule>
[2023-01-23 00:36:58,478][__main__][INFO] - Instantiating model <src.models.undc_module_pre.UNDCLitModule>
[2023-01-23 00:37:00,882][__main__][INFO] - Instantiating callbacks...
[2023-01-23 00:37:00,883][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-23 00:37:00,888][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-23 00:37:00,889][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-23 00:37:00,890][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-23 00:37:00,891][__main__][INFO] - Instantiating loggers...
[2023-01-23 00:37:00,891][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-23 00:37:00,891][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-23 00:37:01,309][__main__][INFO] - Starting training!
[2023-01-23 00:37:01,355][src.datamodules.undc_pc_datamodule_fight][INFO] - Loading Train dataset...
[2023-01-23 00:37:01,448][src.datamodules.undc_pc_datamodule_fight][INFO] - Train dataset [ABC_pc_hdf5] of size 2352 had been created.
[2023-01-23 00:37:01,448][src.datamodules.undc_pc_datamodule_fight][INFO] - Loading Val dataset...
[2023-01-23 00:37:01,503][src.datamodules.undc_pc_datamodule_fight][INFO] - Val dataset [ABC_pc_hdf5] of size 135 had been created.
[2023-01-23 00:37:01,503][src.datamodules.undc_pc_datamodule_fight][INFO] - Loading Test dataset...
[2023-01-23 00:37:01,558][src.datamodules.undc_pc_datamodule_fight][INFO] - Test dataset [ABC_pc_hdf5] of size 135 had been created.
[2023-01-23 00:37:04,200][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/fubao/dev/my-ndc/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 72, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 696, in fit
    self._call_and_handle_interrupt(
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 737, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1168, in _run
    results = self._run_stage()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1254, in _run_stage
    return self._run_train()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1276, in _run_train
    self._run_sanity_check()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1345, in _run_sanity_check
    val_loop.run()
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 155, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.advance(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 143, in advance
    output = self._evaluation_step(**kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 240, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1706, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/fubao/anaconda3/envs/ndc/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 370, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/home/fubao/dev/my-ndc/src/models/undc_module_pre.py", line 150, in validation_step
    bool_loss, bool_acc, pred_bool, float_loss, pred_float = self.step(batch,val=True)
  File "/home/fubao/dev/my-ndc/src/models/undc_module_pre.py", line 113, in step
    pred_output_bool, _ = self.net_bool(pc_KNN_idx,pc_KNN_xyz, voxel_xyz_int,voxel_KNN_idx,voxel_KNN_xyz)
ValueError: too many values to unpack (expected 2)
[2023-01-23 00:37:04,204][src.utils.utils][INFO] - Closing loggers...
[2023-01-23 00:38:36,627][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-23 00:38:36,634][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-23 00:38:36,635][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-23 00:38:36,700][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule_fight.UNDC_PC_DataModule>
[2023-01-23 00:38:37,132][__main__][INFO] - Instantiating model <src.models.undc_module_pre.UNDCLitModule>
[2023-01-23 00:38:39,438][__main__][INFO] - Instantiating callbacks...
[2023-01-23 00:38:39,439][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-23 00:38:39,444][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-23 00:38:39,446][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-23 00:38:39,446][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-23 00:38:39,447][__main__][INFO] - Instantiating loggers...
[2023-01-23 00:38:39,448][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-23 00:38:39,448][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-23 00:38:39,854][__main__][INFO] - Starting training!
[2023-01-23 00:38:39,902][src.datamodules.undc_pc_datamodule_fight][INFO] - Loading Train dataset...
[2023-01-23 00:38:40,000][src.datamodules.undc_pc_datamodule_fight][INFO] - Train dataset [ABC_pc_hdf5] of size 2352 had been created.
[2023-01-23 00:38:40,001][src.datamodules.undc_pc_datamodule_fight][INFO] - Loading Val dataset...
[2023-01-23 00:38:40,055][src.datamodules.undc_pc_datamodule_fight][INFO] - Val dataset [ABC_pc_hdf5] of size 135 had been created.
[2023-01-23 00:38:40,055][src.datamodules.undc_pc_datamodule_fight][INFO] - Loading Test dataset...
[2023-01-23 00:38:40,108][src.datamodules.undc_pc_datamodule_fight][INFO] - Test dataset [ABC_pc_hdf5] of size 135 had been created.
[2023-01-23 00:53:56,099][src.utils.utils][INFO] - Closing loggers...
[2023-01-23 00:53:56,102][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-23_00-38-36
[2023-01-23 00:53:56,103][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-01-23 01:03:01,258][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-01-23 01:03:01,265][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-01-23 01:03:01,265][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-01-23 01:03:01,329][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule_fight.UNDC_PC_DataModule>
[2023-01-23 01:03:01,765][__main__][INFO] - Instantiating model <src.models.undc_module_pre.UNDCLitModule>
[2023-01-23 01:03:04,039][__main__][INFO] - Instantiating callbacks...
[2023-01-23 01:03:04,040][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-01-23 01:03:04,045][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-01-23 01:03:04,046][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-01-23 01:03:04,047][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-01-23 01:03:04,048][__main__][INFO] - Instantiating loggers...
[2023-01-23 01:03:04,048][src.utils.utils][WARNING] - Logger config is empty.
[2023-01-23 01:03:04,048][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-01-23 01:03:04,367][__main__][INFO] - Starting training!
[2023-01-23 01:03:04,394][src.datamodules.undc_pc_datamodule_fight][INFO] - Loading Train dataset...
[2023-01-23 01:03:04,479][src.datamodules.undc_pc_datamodule_fight][INFO] - Train dataset [ABC_pc_hdf5] of size 2352 had been created.
[2023-01-23 01:03:04,479][src.datamodules.undc_pc_datamodule_fight][INFO] - Loading Val dataset...
[2023-01-23 01:03:04,533][src.datamodules.undc_pc_datamodule_fight][INFO] - Val dataset [ABC_pc_hdf5] of size 135 had been created.
[2023-01-23 01:03:04,533][src.datamodules.undc_pc_datamodule_fight][INFO] - Loading Test dataset...
[2023-01-23 01:03:04,586][src.datamodules.undc_pc_datamodule_fight][INFO] - Test dataset [ABC_pc_hdf5] of size 135 had been created.
[2023-01-23 01:03:18,919][src.utils.utils][INFO] - Closing loggers...
[2023-01-23 01:03:18,922][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2023-01-23_01-03-01
[2023-01-23 01:03:18,923][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-02-06 04:53:51,777][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-02-06 04:53:51,784][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-02-06 04:53:51,784][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-02-06 04:53:51,874][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule_fight.UNDC_PC_DataModule>
[2023-02-06 04:53:52,506][__main__][INFO] - Instantiating model <src.models.undc_module_pre.UNDCLitModule>
[2023-02-06 04:53:59,976][__main__][INFO] - Instantiating callbacks...
[2023-02-06 04:53:59,978][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-02-06 04:53:59,990][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-02-06 04:53:59,992][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-02-06 04:53:59,993][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-02-06 04:53:59,994][__main__][INFO] - Instantiating loggers...
[2023-02-06 04:53:59,994][src.utils.utils][WARNING] - Logger config is empty.
[2023-02-06 04:53:59,994][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-02-06 04:54:00,437][__main__][INFO] - Starting training!
[2023-02-06 04:54:00,483][src.datamodules.undc_pc_datamodule_fight][INFO] - Loading Train dataset...
[2023-02-06 04:54:00,574][src.datamodules.undc_pc_datamodule_fight][INFO] - Train dataset [ABC_pc_hdf5] of size 2352 had been created.
[2023-02-06 04:54:00,574][src.datamodules.undc_pc_datamodule_fight][INFO] - Loading Val dataset...
[2023-02-06 04:54:00,628][src.datamodules.undc_pc_datamodule_fight][INFO] - Val dataset [ABC_pc_hdf5] of size 135 had been created.
[2023-02-06 04:54:00,628][src.datamodules.undc_pc_datamodule_fight][INFO] - Loading Test dataset...
[2023-02-06 04:54:00,682][src.datamodules.undc_pc_datamodule_fight][INFO] - Test dataset [ABC_pc_hdf5] of size 135 had been created.
[2023-02-06 04:58:01,926][src.utils.utils][INFO] - Closing loggers...
[2023-02-06 04:58:01,928][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2023-02-06_04-53-51
[2023-02-06 04:58:01,929][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-02-06 04:58:27,408][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-02-06 04:58:27,414][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-02-06 04:58:27,415][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-02-06 04:58:27,475][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule_fight.UNDC_PC_DataModule>
[2023-02-06 04:58:27,885][__main__][INFO] - Instantiating model <src.models.undc_module_pre.UNDCLitModule>
[2023-02-06 04:58:35,402][__main__][INFO] - Instantiating callbacks...
[2023-02-06 04:58:35,404][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-02-06 04:58:35,409][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-02-06 04:58:35,410][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-02-06 04:58:35,411][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-02-06 04:58:35,412][__main__][INFO] - Instantiating loggers...
[2023-02-06 04:58:35,412][src.utils.utils][WARNING] - Logger config is empty.
[2023-02-06 04:58:35,412][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-02-06 04:58:35,846][__main__][INFO] - Starting training!
[2023-02-06 04:58:35,886][src.datamodules.undc_pc_datamodule_fight][INFO] - Loading Train dataset...
[2023-02-06 04:58:35,964][src.datamodules.undc_pc_datamodule_fight][INFO] - Train dataset [ABC_pc_hdf5] of size 2352 had been created.
[2023-02-06 04:58:35,964][src.datamodules.undc_pc_datamodule_fight][INFO] - Loading Val dataset...
[2023-02-06 04:58:36,007][src.datamodules.undc_pc_datamodule_fight][INFO] - Val dataset [ABC_pc_hdf5] of size 135 had been created.
[2023-02-06 04:58:36,007][src.datamodules.undc_pc_datamodule_fight][INFO] - Loading Test dataset...
[2023-02-06 04:58:36,049][src.datamodules.undc_pc_datamodule_fight][INFO] - Test dataset [ABC_pc_hdf5] of size 135 had been created.
[2023-02-06 04:59:37,147][src.utils.utils][INFO] - Closing loggers...
[2023-02-06 04:59:37,151][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2023-02-06_04-58-27
[2023-02-06 04:59:37,152][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-02-06 05:01:42,980][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-02-06 05:01:42,987][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-02-06 05:01:42,988][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-02-06 05:01:43,052][__main__][INFO] - Instantiating datamodule <src.datamodules.undc_pc_datamodule_fight.UNDC_PC_DataModule>
[2023-02-06 05:01:43,496][__main__][INFO] - Instantiating model <src.models.undc_module_pre.UNDCLitModule>
[2023-02-06 05:01:51,113][__main__][INFO] - Instantiating callbacks...
[2023-02-06 05:01:51,115][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-02-06 05:01:51,121][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-02-06 05:01:51,122][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-02-06 05:01:51,123][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-02-06 05:01:51,124][__main__][INFO] - Instantiating loggers...
[2023-02-06 05:01:51,124][src.utils.utils][WARNING] - Logger config is empty.
[2023-02-06 05:01:51,124][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-02-06 05:01:51,558][__main__][INFO] - Starting training!
[2023-02-06 05:01:51,596][src.datamodules.undc_pc_datamodule_fight][INFO] - Loading Train dataset...
[2023-02-06 05:01:51,680][src.datamodules.undc_pc_datamodule_fight][INFO] - Train dataset [ABC_pc_hdf5] of size 2352 had been created.
[2023-02-06 05:01:51,680][src.datamodules.undc_pc_datamodule_fight][INFO] - Loading Val dataset...
[2023-02-06 05:01:51,735][src.datamodules.undc_pc_datamodule_fight][INFO] - Val dataset [ABC_pc_hdf5] of size 135 had been created.
[2023-02-06 05:01:51,735][src.datamodules.undc_pc_datamodule_fight][INFO] - Loading Test dataset...
[2023-02-06 05:01:51,790][src.datamodules.undc_pc_datamodule_fight][INFO] - Test dataset [ABC_pc_hdf5] of size 135 had been created.
[2023-02-06 05:08:44,676][src.utils.utils][INFO] - Closing loggers...
[2023-02-06 05:08:44,678][src.utils.utils][INFO] - Output dir: /home/fubao/dev/my-ndc/logs/train/runs/2023-02-06_05-01-42
[2023-02-06 05:08:44,678][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
